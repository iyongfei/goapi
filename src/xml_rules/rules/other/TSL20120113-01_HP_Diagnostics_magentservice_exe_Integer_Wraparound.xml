<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Apache Struts 2 ConversionErrorInterceptor OGNL Script Injection"/>
    <EngDesc display="true" value="A script injection vulnerability has been found in Apache Struts 2. The vulnerability is due to a design error: HTTP request parameters are interpreted as OGNL expressions when conversion errors occur.            A remote, unauthenticated attacker can exploit this vulnerability by sending a crafted HTTP request to a vulnerable Struts 2 web application. A successful attack will result in the execution of arbitrary OGNL expressions (possibly OS commands) in the security context of the web application server.&#13;&#10;"/>
    <Intent display="true">
      <item value="Script_Injection"/>
    </Intent>
    <Protocol display="true" value="HTTP,HTTPS"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Apache_Software_Foundation"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Struts_2"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="prior_to_2.2.3.1"/>
    </Known_Versions_Affected>
    <Credit display="true" value="TSL20111209-05"/>
    <CVEID display="true" value="CVE-2012-0391"/>
    <bugtraqID display="true" value=""/>
    <OSVDB display="true" value=""/>
    <Author display="true" value=""/>
    <ID display="true" value="a6a5334bf2d01b205fb9b4c00acc67af"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value=""/>
    <ServerSideAttack display="true" value=""/>
    <SoftwareRevision display="true" value=""/>
    <Suite display="true" value=""/>
    <RunOnce display="false" value=""/>
    <Valid_Traffic display="false" value=""/>
    <AccessVector display="false" value="Network"/>
    <AccessComplexity display="false" value="Medium"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="partial"/>
    <IntegImpact display="false" value="partial"/>
    <AvailImpact display="false" value="partial"/>
    <ImpactBias display="false" value=""/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="634656763828555351"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value=""/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value=""/>
    <Regex display="false" value=""/>
    <Created value="1332927044" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="F"/>
    <NamedVar name="destPort" type="ImperfectControls.Port" value="null" index="G"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="F"/>
      <for index="G"/>
    </for>
    <for index="B">
      <for index="F"/>
      <for index="G"/>
    </for>
    <for index="C">
      <for index="F"/>
      <for index="G"/>
    </for>
    <for index="D">
      <for index="F"/>
      <for index="G"/>
    </for>
    <for index="E">
      <for index="F"/>
      <for index="G"/>
    </for>
  </Loops>
  <PostScript/>
  <Output index="A" Count="">
    <Ethernet srcMac="00:0C:29:CB:10:14" destMac="00:0C:29:06:0B:1B" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="008D" Identification="9279" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="3F58" srcIP="172.16.8.17" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="33371" destPort="$destPort" SeqNumber="33B8B336" AckNumber="EEF625A2" HeaderLength="08" WindowSize="00B7" Checksum="D9D1" UrgentPointer="0000" Options="0101080A0033214300000000" Payload="16030000540100005003004F1874A5F14EC992CC3E267DD3D075A36FAB67733B24605D51A9F5C7D57EDA1800002800390038003500160013000A00330032002F000500040015001200090014001100080006000300FF020100" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="C" Count="">
    <Ethernet srcMac="00:0C:29:CB:10:14" destMac="00:0C:29:06:0B:1B" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="00CA" Identification="927C" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="3F18" srcIP="172.16.8.17" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="33371" destPort="$destPort" SeqNumber="33B8B38F" AckNumber="EEF62CE3" HeaderLength="08" WindowSize="016C" Checksum="C1BD" UrgentPointer="0000" Options="0101080A00332148004FC16C" Payload="160300004610000042004040C170B7471543FC736744AEC234902A33706C0FBB91B5896EE7E9FA7C8C5B041C8B843D2CE0A22B4B6B80B8B7C0148F9EBED57665FC237F86EFA0C9AAD30AC61403000001011603000040AB90BBE45B8D86E936BE204D91E3B8B915F7294979D6EC0E1FBD4243B3E38C78148742CED3D1E17B67E4CDD6E4F3A41FDA1F2B3DFF99E8328E8BA889960D8E37" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="E" Count="">
    <Ethernet srcMac="00:0C:29:CB:10:14" destMac="00:0C:29:06:0B:1B" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0441" Identification="927D" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="3BA0" srcIP="172.16.8.17" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="33371" destPort="$destPort" SeqNumber="33B8B425" AckNumber="EEF62D2E" HeaderLength="08" WindowSize="016C" Checksum="7BBD" UrgentPointer="0000" Options="0101080A00332148004FC16C" Payload="170300040861382825A740E3A741E85CDA3FBE9E0CB262F5693F4755A328F40440BF4AB801B3C16FEA7B15620DDF1457E969BDE5C1913DBEFDB638CBCE3C5EA255F74AA13CDDD5F64E2521724E339EDDF44AEF31A562F4819D3460BADF7D2F5BABB3F428140CC525DED69205ABCA26DBD165636C55529D8B2AA9298E9EEEDFCDD7F26F23493B12604E3444F84E0F6FD93E2AC608E485611AE212929D82174270AB7DE9008A002024C36D6C7B58E0E6DFC8F17A08D301BD90E652AA73E45AB84876249B694F5E937FC08EAC0333BC61E6711A96908AF56D5AB72B0CF93197E51AD1B6D308BB1F8B0D5D329F5103030D2B7B5961284C3DAF5A36142EA6BDD29A7B5D36C354C03C0E011A86605052EB3A1BD56FB364D6661B049BD9266B33C47348128F72711D1CA507CC3AF91BBE2D0028B0FDC6EDE651C22E1D24641372C5B76E24C1E49403A4202A58D48F0F91E126357E18757DEF4C4F287183D2AC5E8FF6D187505FC88685196C21AD54F045286B09D71C841840746E52E3EBDE1A1DC802C17F6803A583F5D69C44FB26BF91DED091C2FC18C35CC0BF4D6895D2DA2B3924171B6F1E93375331DD976769F25AA5B5B14B112F29260A9438103F6326FEF6A27291C0F76F202525E0041BD7BC35DD4DA5AFBD4DA8CF94551FF6D9147ED98B9F407CE6EBD25A307449F6F76DBE5E2E91E62204C6DFDF61EC6E200E90DD0CC9EFCD7E46BA421FE1ABE3AAEB379448CFEF3C89D2AF0433A1AEBFCC748924686FCEC736CF22717F9F33BB13B5246BE901DCDAF1706429F07597B920D5A22DE97BB03B3A567AF77212C44F74AACBE8AF42ECFB2439F8E0C5E6FB4ABB1BB099763DAF2A3977D6CE11280794F9C90C8378A1A4384DC96FB7DFA94F450E799D62D71D992F62B35AB29712AD8CBDFA06A180949FB9992525CA6BA753276F02D3B8C2B21F43DC7176DECBD6A000840F120A6D9DE3CD91C0E95DC04690D5C70D9D6EA8401BBAD3EAB095C3CAC109E9B765CC4B0D7B5F177424BE691D6080BA0409B79DF0345AF8F69D42D17D0265D09DA2FB5E31994D112B534108CF287E0EB7CB0A07249D2E1785AA4BAEAF7B81FE71CE5E695D0C7B907ABC54DDA4143DAAC9B76F9A4AE8E16B5EB6D566018EE4A396867E7BC78FAF6AF656A37053C675ACBB0043972C915AC93277455FCF73656D41CE7E51422C5616CA7EE08E8AD03C5F855A5E7B487FA733E574375B879159FEB233122DA0316B237798C372174B6428B47B54FCBDE1FD763FC676253F0534C44D6C16082CD02903DDE6B6CE423BF70019051D21F7800D8CA0EE24FEA32CBFE0C90593373CA54EC2E1FDDEA55B5B73A3DEA11BF8B3817E88BE149FF4E257EA34CF52679433CA2DC33630519A27A8101102AEB4B7F781818156CC98CA8DEC0CA7D2A9EBAF8272D53F397E85988A7F17D4C31910C0E561490BDFA3A0F1CD50F707C0FFBC92" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1,3">
    <Output index="B" Count="">
      <Ethernet srcMac="00:0C:29:06:0B:1B" destMac="00:0C:29:CB:10:14" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0775" Identification="5FA9" FragmentOffset="0000" TTL="80" Protocol="06" HeaderChecksum="2B40" srcIP="$destIP" destIP="172.16.8.17" options="" CE="false" DF="true" MF="false">
          <TCP srcPort="$destPort" destPort="33371" SeqNumber="EEF625A2" AckNumber="33B8B38F" HeaderLength="08" WindowSize="FA97" Checksum="5EEA" UrgentPointer="0000" Options="0101080A004FC16C00332142" Payload="160300004A0200004603004F18731DC753D31D502F18FEE02C5EB74E54D4D0D87C48E967798F971591286E20C753D31D502F18FEE02C5EB74E54D4D0D87C48E967798F971591286EEC301C5F00160016030005D20B0005CE0005CB0002A23082029E30820186A003020102020164300D06092A864886F70D01010505003053310B300906035504061302494C311C301A060355040A13134D65726375727920496E746572616374697665312630240603550403131D4D65726375727920496E74657261637469766520652D43657274204341301E170D3035303632323233303030305A170D3135303632333030303030305A3056310B300906035504061302494C311C301A060355040A13134D65726375727920496E74657261637469766531093007060355040B1300310F300D06092A864886F70D0109011300310D300B060355040313047465737430819F300D06092A864886F70D010101050003818D0030818902818100D761786AAB09D9C83F6DF419F0E641215BAC7FAA4C937CE972EE5A4F6052A300EB4B08BED10E5308C3E095E2399B831E5919538D6A815D88B3E046AF02C593BA8BBFB22706245EEDB3F1E5B65EE2AB77215EE54706890E7153D6878F6314F8497FFC0EE11A9192F957415E827244ABDB5794B8667DAA41428FD9F17D0B6B8E990203010001300D06092A864886F70D01010505000382010100050C58E9BF2A99656B216BB5A04D503C83C3C3893CCD56A186E819E254322E2D295CF627B1057D223BE818D05362E5E56B1E08C41B28B552640E86C70B326A6D7EBE06D82DA266EF6C2A55C21BBA6F93DE00A36018EC688ED17D439288454E461F47CA05ABDD0257822D93223C3691888AE31B742E4F5EDDB5E5D8BCF9613B7749ADE26C3A1FFEA9ACBDC4B027EABD67E1A1B31D74A99A291A94B2C38D591042A6B28EF29F58AD527614331E50C685BE1DB22DE057884F4B9273229A5C2B5778452DA14908BECBFC3D89849E5F82D4AE94AC3842B15698D2F4F059FB7E7BC2A1623058A69014737DC459889C7A76ADAE70B74828FD7E899AC63A814F24970CE60003233082031F30820207A003020102020105300D06092A864886F70D01010505003053310B300906035504061302494C311C301A060355040A13134D65726375727920496E746572616374697665312630240603550403131D4D65726375727920496E74657261637469766520652D43657274204341301E170D3035303632333030303030305A170D3135303632333030303030305A3053310B300906035504061302494C311C301A060355040A13134D65726375727920496E746572616374697665312630240603550403131D4D65726375727920496E74657261637469766520652D4365727420434130820122300D06092A864886F70D01010105000382010F003082010A0282010100B4859CFB59E767AF1BA71D4B94FCCCED151EDF01A4D23614609312562F80159E57742E86A7103BF1B801A86025415CA304CCD9030120A8EE7D467D359F3167F0FC3C5A3EA7002B7965C0B8CDB6C84E03F96982B83E55F6B7621171A1808E3CD4481BBEF5043BF68553FC4337634081AB0C81985478FEA652F14739CFC43E770704F67AE96EC66C74AA62728A44493E2CCCA0D96889D6D078D35609D535862526337EFC7A14A5696BAD01BB8CD963A0CF896B69462063E5C045C477EDA889B048B448E181E400C9A73D7ACCF24039C3FA19AA14CBC2AE1868C052D800A0EBF1EA250225D5F1512613BC8164ECBA8E0F8865743DD1FFC796FFBC34E0221EB42AE30203010001300D06092A864886F70D01010505000382010100570C62CD1E1DA06FE55DCB0B2F6EFC2577F0A7EADE4C0D59C6D10D9E32270332D03AD069B94E7902CA3E886A81DAB07961CDCF135B02DFF9CC93B5D99C93A87FED0C777E8E54A41B794A7C14ACCF08F2C705DEB25DE8B3AF2B7AE46AF6909A8BCFC01E42C9036AA8B5AB1EA100A1C9F789893257E24B06F0C9802BD63D2DDF7FC8AC1B4C44D4DC6741E04FDB39EAFB165F4A9C2802633CFD22B30E4B4D979E004FD916AFC113DA908A627B80CA1C17386FE099DBB1ECA9E92904BA865583130C80985EEF999C064042049E7F0B2BF0993C68FEC06FC063B089109FF66CC2E9007B73B56CD11249B4247B88EAF77907363C493EC999F145B43079473FE18B6B97160300010D0C0001090040F52AFF3CE1B1294018118D7C84A70A72D686C40319C807297ACA950CD9969FABD00A509B0246D3083D66A45D419F9C7CBD894B221926BAABA25EC355E92A055F0001020040AB775C3D69605F47CD44868FC127134040C11AF294D97967C25A3CBC1B7AA9B935660E9A0167868ABD55F357D7AE2EBCC6E1777F2157002479F82C8AD1C4D99E0080357B13A970ACA8D1920D86FE78FAD0996DE543F80B20788ADB51D45E26F792600B42F62B218F50F9D023EFBB48FE04640CDA238007DD5DED84CE26216ACAE7944E5AE8049868C8549532C78AFE8E068AAEBA8BC5B4A3F2CCE277233E489EDA033E8CBDDE37615B2AEBA789AA4460818623C48057034653CE512585E6499BCFA816030000040E000000" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IP>
      </Ethernet>
    </Output>
    <Output index="D" Count="">
      <Ethernet srcMac="00:0C:29:06:0B:1B" destMac="00:0C:29:CB:10:14" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="007F" Identification="5FAB" FragmentOffset="0000" TTL="80" Protocol="06" HeaderChecksum="3234" srcIP="$destIP" destIP="172.16.8.17" options="" CE="false" DF="true" MF="false">
          <TCP srcPort="$destPort" destPort="33371" SeqNumber="EEF62CE3" AckNumber="33B8B425" HeaderLength="08" WindowSize="FA01" Checksum="AF44" UrgentPointer="0000" Options="0101080A004FC16C00332148" Payload="14030000010116030000401591F8D60EF5868010AC88A9F23AB032A78CCBD414B474F2B6EFE6E0ACD1C819A3BCD0FD6FF5858C3833432066E6F515D723E443545DAF35EE1E839E4D14D976" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
