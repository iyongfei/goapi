<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="KAME racoon X509 Certificate Verification"/>
    <EngDesc display="true" value="The IKE daemon of KAME racoon has a vulnerability where an invalid X.509 certificate will be accepted as valid. This would allow an invalid certificate to be used to establish a security association with a KAME based VPN end-point."/>
    <Intent display="true"/>
    <Protocol display="true" value="ISAKMP"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="KAME"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="KAME_KAME_racoon"/>
      <item value="KAME_KAME_/OS"/>
      <item value="KAME_KAME_FreeBSD"/>
      <item value="KAME_KAME_NetBSD"/>
      <item value="KAME_KAME_OpenBSD"/>
      <item value="KAME_KAME_Fedora_Core"/>
      <item value="KAME_KAME_Enterprise"/>
      <item value="KAME_KAME_OS"/>
      <item value="KAME_KAME_Linux"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="KAME_racoon_20040503"/>
      <item value="KAME_racoon_20040407b"/>
      <item value="KAME_racoon_20040405"/>
      <item value="KAME_racoon_20030711"/>
      <item value="KAME_/OS_4.2_and_newer"/>
      <item value="KAME_FreeBSD_4.0_and_newer"/>
      <item value="KAME_NetBSD_1.5_and_newer"/>
      <item value="KAME_OpenBSD_2.7_and_newer"/>
      <item value="KAME_Fedora_Core_2_(ipsec-tools-0.2.5)"/>
      <item value="KAME_Enterprise_3_(ipsec-tools-0.2.2)"/>
      <item value="KAME_OS_X"/>
      <item value="KAME_Linux_10.0_(ipsec-tools-0.2.3)"/>
    </Known_Versions_Affected>
    <Credit display="true" value="FSC20040617-01"/>
    <CVEID display="true" value="CVE-2004-0607"/>
    <bugtraqID display="true" value="10546"/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="ThreatEx Team"/>
    <ID display="true" value="23de885ff5c017b15414968249ee47a7"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="true"/>
    <ServerSideAttack display="true" value=""/>
    <SoftwareRevision display="true" value="2.0"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="True"/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value=""/>
    <Authentication display="false" value=""/>
    <ConfImpact display="false" value=""/>
    <IntegImpact display="false" value=""/>
    <AvailImpact display="false" value=""/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value="normal"/>
    <LastModified display="false" value="633602652691250000"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value="B"/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value="1"/>
    <Regex display="false" value=""/>
    <Created value="1213725119" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="L"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="M"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="N"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="O"/>
    <NamedVar name="ISAKMPdestPort" type="ImperfectControls.Port" value="null" index="P"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="L"/>
      <for index="M"/>
      <for index="N"/>
      <for index="O"/>
      <for index="P"/>
    </for>
    <for index="B"/>
    <for index="C">
      <for index="L"/>
      <for index="M"/>
      <for index="N"/>
      <for index="O"/>
      <for index="P"/>
    </for>
    <for index="D"/>
    <for index="E">
      <for index="L"/>
      <for index="M"/>
      <for index="N"/>
      <for index="O"/>
      <for index="P"/>
    </for>
    <for index="F"/>
    <for index="H">
      <for index="L"/>
      <for index="M"/>
      <for index="N"/>
      <for index="O"/>
      <for index="P"/>
    </for>
    <for index="J"/>
    <for index="K">
      <for index="L"/>
      <for index="M"/>
      <for index="N"/>
      <for index="O"/>
      <for index="P"/>
    </for>
  </Loops>
  <PostScript/>
  <Output index="A" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0070" Identification="B8AF" FragmentOffset="0000" TTL="40" Protocol="11" HeaderChecksum="AB26" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="false" MF="false">
        <UDP srcPort="@random(1026,65535)" destPort="$ISAKMPdestPort" checksum="0" length="" Payload="AAFF466B098901B900000000000000000110020000000000000000540000003800000001000000010000002C010100010000002401010000800B0001000C00040001518080010005800300038002000280040002"/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="C" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="00E4" Identification="A2DD" FragmentOffset="0000" TTL="40" Protocol="11" HeaderChecksum="C084" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="false" MF="false">
        <UDP srcPort="@random(1026,65535)" destPort="$ISAKMPdestPort" checksum="0" length="" Payload="AAFF466B098901B9B2F4E25E506478170410020000000000000000C80A000084CF7368885DFDD35C18BA4A3A4E759577D0B05CD163AD5659C16F6A69366F0050726A191C8D48B313EF10E1C4E07FFCF23B9E13F7936A53934457C3EB92155CC69E020315913E81B8409D722B00985AB5248E39C19AA398A9D4CFFDAD001D9B47E4650F457846939401980CEAF934A1A610A5FCA415476735B3E513EF109ECDBE0D000014BF58D7E2E4EA3A219BAF5E55B4DA7B6B000000147003CBC1097DBE9C2600BA6983BC8B35"/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="E" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0400" Identification="6D85" FragmentOffset="0000" TTL="40" Protocol="11" HeaderChecksum="F2C0" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="false" MF="false">
        <UDP srcPort="@random(1026,65535)" destPort="$ISAKMPdestPort" checksum="0" length="" Payload="AAFF466B098901B9B2F4E25E506478170510020100000000000003E48BE831FFA0A66C8137282610E56399B80A68B6ED7242903C7F61F69984B9C241094476B18080C7CCCAFECE74FF740313C815504625000DE78B4CF61F89E773C12016194BFE066A75DD33FFA656F27E208087664FA68ECC791F57CB72E353F6E467D478A9C1CB0F09406D0ED95FB42DC662FABD0070C8AC2AFD7E182F5C47C7B743453E630C851D241782FBE65B46C54F20CE348871CBDAC7C86708B235586B2C68ACFAF6D5B0A22C94A6166379C9E3C35C36CD4321A73664B4CFDD90D0A0A69CC217C0D7DC6C7DE03565548143CC6FC2FA40241D9CCE626332C4CD3012D3951024C754D71F1268392A985403AB39A6F62FB2852002E26A960AD9F54EB831887CA570A4DE2495BED508653E267A4A4F52899E6477D3CACD54621186E3A01A53F31FBC0141B3770A393BC49B6B6C150B5CA2000405BBF6E2669EF483F8C852935346918C3CA653BCDD0E009CEC2F9C1FAD5348F2BAB6EF10EE514D62319C3BA7CF8E4AC53A05A5D32AE2FB12AF5BC021638A319EBE3DEC2A0B37C82741F00519B6972A6DF5CB782085B54F41439FEA2ED1025129DE5CBD66DFE5FCEB413B8CC404B3A2FAEC6CF17E9180BDD94D152B1E9A8152CEF21EF06C3D9AD072EFE21B5934AAF1BDA98D6DB5C2BCD168DDF9F3049FD0C91F22CF1E4D31BF4AE449DD0D86B12BB9855E07EDD96BEB612DFCE73C82E98A912817A38936609E270D0723ED644FCB8FA619A52F0F50E0545ABAAF780418A91C3C939E15229E4B293DE55EF29D8720266D9D5F85086747B5E23274319F0BBF861789A3BF929E3A905F7823ADA48896BFC72407B0B0F3D23251D2A9C627BB7E0CCF3011AB0397325BE34B15817478E47A0DF0626051655902ACE49414D5EBF71BD54F0F5F675D78D297D1212D052488F5299EBEAA96693B66BFB9FFE058E982EB92D9BF04BA4A75FE0239760CE47F495A64DF23A44D160B65C9A990E58253CFF21CB554839CE6AAC94F9F0B4B2702DB1D23B3E62D537EC22007264C6B42242B863B0817C6EE391FDFEC60C9668815E347674E1BDBA2329881C98E5DAA783AA5CD0D67DA73A0FD39B24F173D18A03D18F633F98F56C3D6512932043E60AD5490BA9F31ECE5BCD81421292C1EC29C42D586C9EC0E279F7047B661189D23CCD77D42A655F928CFFFAEDE9299F5C7790E7ECBF3627F868DE575DD4FE2B3181E0D50855FC9E6E9312FAD286D49A9BBFC75406FD1F1ADB1A2B82D2FAAB13494ED06D1FB1680E863D5B0AD79B5AEFE71A8310D20D09A97341B1AE3CB4D73B2B87DB5788024DB2C2E52BE016D12946929EFD6F28CC0F1A238746F04E620A2149FE477AA7379A133B8CEF2FFF5C15040780BCB5A61D5DD2C08D328"/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="H" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0070" Identification="97A1" FragmentOffset="0000" TTL="40" Protocol="11" HeaderChecksum="CC34" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="false" MF="false">
        <UDP srcPort="@random(1026,65535)" destPort="$ISAKMPdestPort" checksum="0" length="" Payload="AAFF466B098901B9B2F4E25E5064781708100501212BC781000000542D74DB7787D1E9168D87DCC8AF1C7A4C1CAA66CAF3EA93BB444E2E76BEBE7C273EC7BFAF2BC0DA658E65BF2ABD8A506CD3D11E451138F487AAFF466B098901B9B2F4E25E5064781708102001897DA2080000021C424E92541EF1FF69307F30FAF0D7809AA4AB43C365009E30095EE7A97E69F8D7366C55CB31DCB429DF63B6404C32E92FBFFDA7B22C2C823EDC9627388B11C5C31C82DB96E4C0CE4B97CA6F4560D50ACC2BF979254F2831BAF55011ADC457984F0F5649CD56671C98052D19C91647193C5011261CAC55D576B6428D9EF1267DFD71D7346427A9B5B00C921EEE4BFAD7DFD4D533D98BD25A86CB210F8C1E6F8975E0685294D8DF5293FEC6909F1175D31D968251F7060A68CED49687691A8F7190BCE028CC215C2463D88D5897916C83882CA0B63CA3AB66C481BED01D6FC63F6A0FEA53C7B386933D691D4F58438099BBD6DD9529DA719E597BA73234C0FB2EA5B04D64DC23B5B807CB6A0A423A3C984A3B2D80A9B60925210D258F74F35CB29F5BD3594E4D6EB2B775F121E652A119F84D8CEB72A32F3F61ED65CA47AADDA305E24F19F82CF2FA18A4BC16C4D0B1D8935C3B7E0B7A9287B8C023DB389180D2B82678CEA42FB0EBD252BFCDB7BB7123B6C0B90B03C15960B4B313B022CBDE3C55AD420D790CE740C837440DE99603A89E2B5133D0096C4C10C9F1DDA5FEFCFE3075051B2C60C24163AEDA0EB6895FCB267FAE647707100F4693EB5E996A3D0A316EE3381DF8BD8FA3368E31CB484F887E39B82EAD3D7026CF1676A699FF4B32628C0063F846601677F98FDDAC1C0E508F787DAB4DF17A30FF576D73E5C08FAD09"/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="K" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0058" Identification="478A" FragmentOffset="0000" TTL="40" Protocol="11" HeaderChecksum="1C64" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="false" MF="false">
        <UDP srcPort="@random(1026,65535)" destPort="$ISAKMPdestPort" checksum="0" length="" Payload="AAFF466B098901B9B2F4E25E5064781708102001897DA2080000003C31E063F1AF7BE116120E50D85C8D75950533D37603C81E48D3907508B5A6DA4B"/>
      </IP>
    </Ethernet>
  </Output>
  <ServerSide display="1,3,5,7">
    <Output index="B" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0084" Identification="8D48" FragmentOffset="0000" TTL="40" Protocol="11" HeaderChecksum="D679" srcIP="" destIP="" options="" CE="false" DF="false" MF="false">
          <UDP srcPort="" destPort="" checksum="0" length="" Payload="AAFF466B098901B9B2F4E25E506478170110020000000000000000680D00003800000001000000010000002C010100010000002401010000800B0001000C00040001518080010005800300038002000280040002000000147003CBC1097DBE9C2600BA6983BC8B35"/>
        </IP>
      </Ethernet>
    </Output>
    <Output index="D" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="00E9" Identification="2A65" FragmentOffset="0000" TTL="40" Protocol="11" HeaderChecksum="38F8" srcIP="" destIP="" options="" CE="false" DF="false" MF="false">
          <UDP srcPort="" destPort="" checksum="0" length="" Payload="AAFF466B098901B9B2F4E25E506478170410020000000000000000CD0A0000842955D74C0642078EB6E19900B39E16001F5ABFA9E7FA4809FFD8AF45DD3C9A311A09297776D55CBB97085F521AAC671AAF0C3CB68C46AF26B7FE037627B000F40E9A65A7CB58C0808D961A341492E6F38FD4116F9BFEEAFCA74F225480E329C0CF412E142EC9A6D277A5946EA845560A448C7095A8DCCF5D1883F701F9AD5B350D000014C175B823B9C409193B040E74B970DF02070000147003CBC1097DBE9C2600BA6983BC8B350000000504"/>
        </IP>
      </Ethernet>
    </Output>
    <Output index="F" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="03A0" Identification="D539" FragmentOffset="0000" TTL="40" Protocol="11" HeaderChecksum="8B6C" srcIP="" destIP="" options="" CE="false" DF="false" MF="false">
          <UDP srcPort="" destPort="" checksum="0" length="" Payload="AAFF466B098901B9B2F4E25E50647817051002010000000000000384D51CF52C0817B2EFB2ACDDBDF63E043A4C3942AB465672DC58F475C993CB2B59307A8953A95967061D5D37E89D3543199182B326EB6733C48A04159C70F3A5BE6C8ED4A7E2DC613014BFD0E637CAE503BAB084E101B757F609AFC0B8897F9BF929CC9B3E950801E249AE4F0D16E3B35D9C61283A81B0DC27BA41D544198286F821CF74E5F94F677944B04C735B294D19F15B70D87205DBAA7C05422A8C3B4B7E641A6D0FC9E9E6DD8C59CBCAC31E08624CB6B844075DD8EA8DD315630CAA4AEC48C86571690E0E2680A29910C30959036ED23E062C73D187682296E3BFEE3B2D8DC4B4180C145E4153C74C5A174D784C708302D096D481897A001B821B25F2251D68B47E6EE5E91405AB904249339258CA565333B95C0CC5469B62BFEDDD950852CACB665350FFF70831C1A394C4AE316E6689655B9DF4CE5113BF7539B614498EC69394264D3B2C170062988C2A7C267BC5296D7EE006D0CB4DC441EE1C2C42E14C41DFCB51329D1FE4D1BC527B40293864CA931BD981B5EBA8DA2AEB7AB0C2FA74B40B23928C18A88ADCDF144F2DF45F4524438D4171F8A4D15A8BDB275AC238023196CCDAA8C38ECEE2FFFAFA67747F6ABE17C1D250168553146FA28B62F94164CE848FD065ACC9456DA12483D6C976C3508BD4F0C080F6050E6E6DE9F2964D5312D87F66DCECF1A38AAFC357A7E157F4432EF8D72B64312CE06917080CC69B4E3BBB409F49C1E0BB1B19E97A3D81E78433FD8F2FFEB6BB8CBE194AB07FE9A4EE7D6C74C5C21C1964DCEFBB07E06C00BC3F6087DB920B7478FF2DC1A84B0C73859B42BFE529017239E0814AB0CE8A049430936A149829EAD6097F8006D4A7B73C410A580E4416DE9FC3788BA352CE2CC7833D23D94753E3B0D1ABA5D3836E31744E9990515EA15E4F1005693FD3FB479B8EB1D6051C75262BD374E2582076F40EE76C25C102E225F1ABEA57DB05D5FE0761642A36254012452E6894E3B834362DC66318BA42DA292BA23640FFA8EE167B094B7390900FF91D52954F65D75B52ACC5E421EB0DB2D58CD72BB8B0FBAE8D4F4FA8E01912775882678C2DE2E10932117658AC660E0FFA38CAF338D064B04744E03DEA29BE9A382D424C821FD09B699B0B4D66E28107098DEDF6CF3BB25A05DE9666844CA977EA9E2732191326A1BA674F40CCDD4DD2BEEB9400FB6C628C04AACDF73B559AAED222E8473E7F009EAFFCAEF76A52AF67AAFF466B098901B9B2F4E25E506478170810050149162E3500000054A50A632EC6012E2404701C74DAA43FE7922C3F9E8844E7FDF6789615249443D5D249AAC7A3DF72477D0D36234DE3C803D1A5C9E459228737"/>
        </IP>
      </Ethernet>
    </Output>
    <Output index="J" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0120" Identification="4718" FragmentOffset="0000" TTL="40" Protocol="11" HeaderChecksum="1C0E" srcIP="" destIP="" options="" CE="false" DF="false" MF="false">
          <UDP srcPort="" destPort="" checksum="0" length="" Payload="AAFF466B098901B9B2F4E25E5064781708102001897DA20800000104E3854E0530D29221C33A675F21B6837CB6B51031859855F3088139195F62D1381D82910B000304F2105E3EED8FF08F7E4D10C3C7C1F29A7EA647A27F1EC7465F8EED8E892F8A72A8026005B595E5190330776D7EF465EE0FC87EF1F8DD763414DCBBE401E470D68289D867CCCED4C9167F6F9B8B7006E83461D3AFD27B2476D054DB90F4316EFB1DF12BB05C45230D810F34E423B7AD6CB41C02DD688EE334DB0A84B44EF87A1D39A6143D6AE429E5165ED4CE385BACADEA074722CADE580AB21D86A9C9D9AB3A5CEE5F3839EB01B3B79FFAE66B49B77A9E94F7D53CB841FC345769D3CE531A53F5"/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
