<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Microsoft Messenger Advertisement"/>
    <EngDesc display="true" value="This threat attempts to cause a pop-up to occur on an end user's machine, advertising software available for download.  Since this protocol is UDP based, it is effectively used as a mass marketing device.  The messenger service is tied to MS-RPC, so any RPC port will work (typically port 1026)."/>
    <Intent display="true">
      <item value="Unauthorized_Use"/>
    </Intent>
    <Protocol display="true" value="DCOM"/>
    <Type_Of_Equipment display="true">
      <item value="Host"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Microsoft"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Windows"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true"/>
    <Credit display="true" value="http://support.microsoft.com/default.aspx?scid=KB;EN-US;Q330904"/>
    <CVEID display="true" value=""/>
    <bugtraqID display="true" value=""/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="Chuck McAuley"/>
    <ID display="true" value="000001008f7c9f7600c000a80001003c6e772c27"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value=""/>
    <SoftwareRevision display="true" value="1.4"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value=""/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="none"/>
    <IntegImpact display="false" value="none"/>
    <AvailImpact display="false" value="none"/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="632742200036718750"/>
    <SigStyle display="false" value="Matching"/>
    <targetNode display="false" value="A"/>
    <SigProtocol display="false" value="UDP"/>
    <Rate display="false" value="1"/>
    <Regex display="false" value="\X04\X00\X28\X00\X10\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\XF8\X91\X7B\X5A\X00\XFF\XD0\X11\XA9\XB2\X00\XC0\X4F\XB6\XE6\XFC\XC3\X39\XA8\X06\XD7\X1F\X71\X67\X18\XF4\X95\X38\X97\X4B\X18\X85\X00\X00\X00\X00\X01\X00\X00\X00\X00\X00\X00\X00\X00\X00\XFF\XFF\XFF\XFF\XE4\X03\X00\X00\X00\X00\X11\X00\X00\X00\X00\X00\X00\X00\X11\X00\X00\X00\X53\X50\X59\X57\X41\X52\X45\X20\X41\X44\X56\X49\X53\X4F\X52\X59\X00\X00\X00\X00\X11\X00\X00\X00\X00\X00\X00\X00\X11\X00\X00\X00\X55\X53\X45\X52\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X00\X98\X03\X00\X00\X00\X00\X00\X00\X98\X03\X00\X00\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X0D\X0A\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X49\X6D\X70\X6F\X72\X74\X61\X6E\X74\X20\X41\X6C\X65\X72\X74\X20\X4D\X65\X73\X73\X61\X67\X65\X3A\X20\X54\X75\X65\X73\X64\X61\X79\X2C\X20\X4E\X6F\X76\X65\X6D\X62\X65\X72\X20\X39\X0D\X0A\X0D\X0A\X20\X20\X20\X20\X20\X20\X20\X20\X59\X4F\X55\X52\X20\X43\X4F\X4D\X50\X55\X54\X45\X52\X20\X4D\X41\X59\X20\X42\X45\X20\X49\X4E\X46\X45\X43\X54\X45\X44\X20\X57\X49\X54\X48\X20\X55\X4E\X41\X55\X54\X48\X4F\X52\X49\X5A\X45\X44\X0D\X0A\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X20\X53\X50\X59\X57\X41\X52\X45\X20\X50\X52\X4F\X47\X52\X41\X4D\X53\X0D\X0A\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X2E\X0D\X0A"/>
    <Created value="1139462240" display="false"/>
    <ServerSideAttack display="false" value="false"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="B"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="C"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="D"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="E"/>
    <NamedVar name="destPort" type="ImperfectControls.Port" value="null" index="F"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
      <for index="E"/>
      <for index="F"/>
    </for>
  </Loops>
  <Output index="A" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="@random(0,FFFF)" FragmentOffset="0" TTL="40" Protocol="11" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <UDP srcPort="@random(1026,65535)" destPort="$destPort" checksum="" length="" Payload="040028001000000000000000000000000000000000000000F8917B5A00FFD011A9B200C04FB6E6FCC339A806D71F716718F49538974B18850000000001000000000000000000FFFFFFFFE40300000000110000000000000011000000535059574152452041445649534F52590000000011000000000000001100000055534552000000000000000000000000000000009803000000000000980300002E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E0D0A2020202020202020202020202020496D706F7274616E7420416C657274204D6573736167653A20547565736461792C204E6F76656D62657220390D0A0D0A2020202020202020594F555220434F4D5055544552204D415920424520494E464543544544205749544820554E415554484F52495A45440D0A20202020202020202020202020202020202020202020202020202020202020202020535059574152452050524F4752414D530D0A2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E2E0D0A0D0A4541535920494E535452554354494F4E5320546F204C6561726E20486F7720546F2046697820596F757220436F6D70757465723A0D0A0D0A2020202020312E204772616220612070656E20616E6420777269746520646F776E207468652077656220736974652061646472657373207777772E73707732662E636F6D0D0A202020202020202020206F6E2061207069656365206F662070617065722E204B65657020697420696E2061207361666520706C6163652E0D0A0D0A2020202020322E204F70656E20796F757220496E7465726E6574204578706C6F7265722C204E657473636170652C206F7220414F4C207765622062726F777365722E0D0A0D0A2020202020332E2054797065207468652077656220736974652061646472657373207777772E73707732662E636F6D20696E746F207468652022416464726573732220626F780D0A2020202020202020202061742074686520746F70206F6620796F7572207765622062726F7773657220616E64207072657373207468652022476F2220627574746F6E2E0D0A0D0A2020202020202020202020202020205449503A20444F204E4F5420505245535320544845204F4B20425554544F4E2042454C4F5720554E54494C0D0A2020202020202020202020202020202020202020202020594F5520575249544520444F574E205757572E53505732462E434F4D0D0A20202020202020202020202020202020202020202020204F5220594F552057494C4C204C4F534520544849532057494E444F5700"/>
      </IP>
    </Ethernet>
  </Output>
</threatSignature>
