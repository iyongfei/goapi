<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="SIPPING: Piggybacked SIP Message"/>
    <EngDesc display="true" value="This threat sends out a SIP REGISTER message with a content length of 0, immediately followed by a SIP INVITE message. This is legal, and the INVITE message should be ignored. Implementations may get confused by an additional legal message where data should be ignored, and may behave unpredictably."/>
    <Intent display="true">
      <item value="Fuzzing"/>
    </Intent>
    <Protocol display="true" value="SIP"/>
    <Type_Of_Equipment display="true">
      <item value="VoIP Equipment"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true"/>
    <Known_Products_Affected display="true"/>
    <Known_Versions_Affected display="true"/>
    <Credit display="true" value="IETF Draft: draft-ietf-sipping-torture-tests-07.txt"/>
    <CVEID display="true" value=""/>
    <bugtraqID display="true" value=""/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="Seth Hardy"/>
    <ID value="00000109c3a94a4100c000a80001003c2f39d1a1" display="true"/>
    <Revision value="1" display="true"/>
    <Safe display="true" value="true"/>
    <SoftwareRevision display="true" value="1.4"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="false"/>
    <Suite display="true" value="VoIP"/>
    <Created value="1141448985" display="false"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="B"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="C"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="D"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="E"/>
    <NamedVar name="SIPdestPort" type="ImperfectControls.Port" value="null" index="F"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
      <for index="E"/>
      <for index="F"/>
    </for>
  </Loops>
  <Output index="A" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="5" TypeofService="0" TotalLength="" Identification="@random(0000,FFFF)" FragmentOffset="" TTL="40" Protocol="11" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="false" MF="false">
        <UDP srcPort="$SIPdestPort" destPort="$SIPdestPort" checksum="" length="" Payload="5245474953544552207369703A6578616D706C652E636F6D205349502F322E300D0A546F3A207369703A6A2E75736572406578616D706C652E636F6D0D0A46726F6D3A207369703A6A2E75736572406578616D706C652E636F6D3B7461673D34333235316A336A3332340D0A4D61782D466F7277617264733A20380D0A493A2064626C7265712E3068613069736E64616B73646A393973646661666E6C336C6B3233333431320D0A436F6E746163743A207369703A6A2E7573657240686F73742E6578616D706C652E636F6D0D0A435365713A20382052454749535445520D0A5669613A205349502F322E302F554450203139322E302E322E3132353B6272616E63683D7A39684734624B6B646A757732333439320D0A436F6E74656E742D4C656E6774683A20300D0A0D0A0D0A494E56495445207369703A6A6F65406578616D706C652E636F6D205349502F322E300D0A743A207369703A6A6F65406578616D706C652E636F6D0D0A46726F6D3A207369703A63616C6C6572406578616D706C652E6E65743B7461673D3134313333340D0A4D61782D466F7277617264733A20380D0A43616C6C2D49443A2064626C7265712E3068613069736E6461393737363434393030373635403139322E302E322E31350D0A435365713A203820494E564954450D0A5669613A205349502F322E302F554450203139322E302E322E31353B6272616E63683D7A39684734624B6B646A75773338303233340D0A436F6E74656E742D547970653A206170706C69636174696F6E2F7364700D0A436F6E74656E742D4C656E6774683A203135300D0A0D0A763D300D0A6F3D6D68616E646C6579203239373339203732373239333920494E20495034203139322E302E322E31350D0A733D2D0D0A633D494E20495034203139322E302E322E31350D0A743D3020300D0A6D3D617564696F203439323137205254502F41565020302031320D0A6D203D766964656F2033323237205254502F4156502033310D0A613D7274706D61703A3331204C50430D0A0D0A"/>
      </IP>
    </Ethernet>
  </Output>
</threatSignature>
