<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="SIPPING: Bad Version (Version Too High)"/>
    <EngDesc display="true" value="This threat sends out a SIP OPTIONS message with the version set to 7.0. This is invalid according to RFC 3261 (current version is 2.0), so should be rejected. Because it is unexpected, this may confuse or crash a SIP implementation."/>
    <Intent display="true">
      <item value="Fuzzing"/>
    </Intent>
    <Protocol display="true" value="SIP"/>
    <Type_Of_Equipment display="true">
      <item value="VoIP Equipment"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true"/>
    <Known_Products_Affected display="true"/>
    <Known_Versions_Affected display="true"/>
    <Credit display="true" value="IETF Draft: draft-ietf-sipping-torture-tests-07.txt"/>
    <CVEID display="true" value=""/>
    <bugtraqID display="true" value=""/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="Seth Hardy"/>
    <ID value="00000109c3a87fad00c000a80001003c1b8a11de" display="true"/>
    <Revision value="1" display="true"/>
    <Safe display="true" value="true"/>
    <SoftwareRevision display="true" value="1.4"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="false"/>
    <Suite display="true" value="VoIP"/>
    <Created value="1141448933" display="false"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="B"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="C"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="D"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="E"/>
    <NamedVar name="SIPdestPort" type="ImperfectControls.Port" value="null" index="F"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
      <for index="E"/>
      <for index="F"/>
    </for>
  </Loops>
  <Output index="A" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="5" TypeofService="0" TotalLength="" Identification="@random(0000,FFFF)" FragmentOffset="" TTL="40" Protocol="11" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="false" MF="false">
        <UDP srcPort="$SIPdestPort" destPort="$SIPdestPort" checksum="" length="" Payload="4F5054494F4E53207369703A742E776174736F6E406578616D706C652E6F7267205349502F372E300D0A5669613A20202020205349502F372E302F55445020632E6578616D706C652E636F6D3B6272616E63683D7A39684734624B6B646A75770D0A4D61782D466F7277617264733A202020202037300D0A46726F6D3A20202020412E2042656C6C203C7369703A612E672E62656C6C406578616D706C652E636F6D3E3B7461673D7177656F697170650D0A546F3A202020202020542E20576174736F6E203C7369703A742E776174736F6E406578616D706C652E6F72673E0D0A43616C6C2D49443A20626164766572732E333134313740632E6578616D706C652E636F6D0D0A435365713A2020202031204F5054494F4E530D0A6C3A20300D0A0D0A"/>
      </IP>
    </Ethernet>
  </Output>
</threatSignature>
